<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<meta property="og:title" content="8.3 Anotación de los resultados | Analisis de datos ómicos" />
<meta property="og:type" content="book" />





<meta name="author" content="Alex Sánchez-Pla^{1,2} y Ricardo Gonzalo Sanz^2" />
<meta name="author" content="^1 Departament de Genètica, Microbiologia i Estadística. Universitat de Barcelona (UB)." />
<meta name="author" content="^2 Unitat d’Estadística i Bioinformàtica. Vall d’Hebron Institut de Recerca (VHIR)." />


<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  TeX: { equationNumbers: { autoNumber: "AMS" } }
});
</script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<meta name="description" content="8.3 Anotación de los resultados | Analisis de datos ómicos">

<title>8.3 Anotación de los resultados | Analisis de datos ómicos</title>

<script src="libs/header-attrs-2.11/header-attrs.js"></script>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="libs/bootstrap-3.3.5/css/bootstrap.min.css" rel="stylesheet" />
<script src="libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="libs/navigation-1.1/tabsets.js"></script>


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>


<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />

<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
  height: auto;
}
/* show arrow before summary tag as in bootstrap
TODO: remove if boostrap in updated in html_document (rmarkdown#1485) */
details > summary {
  display: list-item;
  cursor: pointer;
}
</style>
</head>

<body>

<div class="container-fluid main-container">


<div class="row">
<div class="col-sm-12">
<div id="TOC">
<ul>
<li><a href="index.html#presentación"><span class="toc-section-number">1</span> Presentación</a>
<ul>
<li><a href="1.1-instalación-de-paquetes-de-r-y-código-de-los-capítulos.html#instalación-de-paquetes-de-r-y-código-de-los-capítulos"><span class="toc-section-number">1.1</span> Instalación de paquetes de R y código de los capítulos</a></li>
</ul></li>
<li><a href="2-introduccion-a-los-microarrays-y-otras-tecnologías-omicas.html#introduccion-a-los-microarrays-y-otras-tecnologías-omicas"><span class="toc-section-number">2</span> Introduccion a los microarrays y otras tecnologías omicas</a>
<ul>
<li><a href="2.1-antecedentes-históricos.html#antecedentes-históricos"><span class="toc-section-number">2.1</span> Antecedentes históricos</a></li>
<li><a href="2.2-los-microarrays.html#los-microarrays"><span class="toc-section-number">2.2</span> Los microarrays</a>
<ul>
<li><a href="2.2-los-microarrays.html#aplicaciones-de-los-microarrays"><span class="toc-section-number">2.2.1</span> Aplicaciones de los microarrays</a></li>
</ul></li>
<li><a href="2.3-cómo-funcionan-los-microarrays.html#cómo-funcionan-los-microarrays"><span class="toc-section-number">2.3</span> Cómo funcionan los microarrays</a>
<ul>
<li><a href="2.3-cómo-funcionan-los-microarrays.html#microarrays-de-dos-colores"><span class="toc-section-number">2.3.1</span> Microarrays de dos colores</a></li>
<li><a href="2.3-cómo-funcionan-los-microarrays.html#microarrays-de-un-color"><span class="toc-section-number">2.3.2</span> Microarrays de un color</a></li>
<li><a href="2.3-cómo-funcionan-los-microarrays.html#realización-de-un-experimento-de-microarrays"><span class="toc-section-number">2.3.3</span> Realización de un experimento de microarrays</a></li>
<li><a href="2.3-cómo-funcionan-los-microarrays.html#como-se-mide-la-expresión"><span class="toc-section-number">2.3.4</span> Como se mide la expresión</a></li>
</ul></li>
<li><a href="2.4-bioinformática-de-microarrays.html#bioinformática-de-microarrays"><span class="toc-section-number">2.4</span> Bioinformática de Microarrays<a name="Bioinformática"></a></a>
<ul>
<li><a href="2.4-bioinformática-de-microarrays.html#software-para-el-análisis-de-datos-de-microarrays"><span class="toc-section-number">2.4.1</span> Software para el análisis de datos de microarrays</a></li>
<li><a href="2.4-bioinformática-de-microarrays.html#bases-de-datos-de-microarrays"><span class="toc-section-number">2.4.2</span> Bases de datos de Microarrays</a></li>
</ul></li>
<li><a href="2.5-extensiones-1-otros-tipos-de-microarrays.html#extensiones-1-otros-tipos-de-microarrays"><span class="toc-section-number">2.5</span> Extensiones (1): Otros tipos de microarrays<a name="extensions"></a></a>
<ul>
<li><a href="2.5-extensiones-1-otros-tipos-de-microarrays.html#otros-microarrays-de-adn"><span class="toc-section-number">2.5.1</span> Otros microarrays de ADN</a></li>
<li><a href="2.5-extensiones-1-otros-tipos-de-microarrays.html#otros-tipos-de-microarrays-proteínas-o-carbohidratos"><span class="toc-section-number">2.5.2</span> Otros tipos de microarrays: Proteínas o carbohidratos</a></li>
</ul></li>
<li><a href="2.6-extensiones-2-ngs-nextnow-generation-sequencing.html#extensiones-2-ngs-nextnow-generation-sequencing"><span class="toc-section-number">2.6</span> Extensiones (2): <em>NGS: Next(Now) Generation Sequencing</em></a>
<ul>
<li><a href="2.6-extensiones-2-ngs-nextnow-generation-sequencing.html#visión-global-de-las-tecnologías-de-secuenciación"><span class="toc-section-number">2.6.1</span> Visión global de las tecnologías de secuenciación</a></li>
<li><a href="2.6-extensiones-2-ngs-nextnow-generation-sequencing.html#de-la-secuenciación-sanger-a-la-ultrasecuenciación"><span class="toc-section-number">2.6.2</span> De la secuenciación Sanger a la ultrasecuenciación</a></li>
<li><a href="2.6-extensiones-2-ngs-nextnow-generation-sequencing.html#tecnologías-de-ultrasecuenciación"><span class="toc-section-number">2.6.3</span> Tecnologías de ultrasecuenciación</a></li>
</ul></li>
</ul></li>
<li><a href="3-MDAProcess.html#MDAProcess"><span class="toc-section-number">3</span> El proceso de análisis de microarrays</a>
<ul>
<li><a href="3.1-tipos-de-estudios.html#tipos-de-estudios"><span class="toc-section-number">3.1</span> Tipos de estudios</a>
<ul>
<li><a href="3.1-tipos-de-estudios.html#comparación-de-grupos-o-class-comparison"><span class="toc-section-number">3.1.1</span> Comparación de grupos o “Class comparison”</a></li>
<li><a href="3.1-tipos-de-estudios.html#predicción-de-clase-o-class-prediction"><span class="toc-section-number">3.1.2</span> Predicción de clase o “Class prediction”</a></li>
<li><a href="3.1-tipos-de-estudios.html#descubrimiento-de-clases-o-class-discovery"><span class="toc-section-number">3.1.3</span> Descubrimiento de clases o “Class discovery”</a></li>
<li><a href="3.1-tipos-de-estudios.html#otros-tipos-de-estudios"><span class="toc-section-number">3.1.4</span> Otros tipos de estudios</a></li>
</ul></li>
<li><a href="3.2-c4examples.html#c4examples"><span class="toc-section-number">3.2</span> Algunos ejemplos concretos</a>
<ul>
<li><a href="3.2-c4examples.html#celltypes"><span class="toc-section-number">3.2.1</span> Estudio de procesos regulados por citoquinas</a></li>
<li><a href="3.2-c4examples.html#golub"><span class="toc-section-number">3.2.2</span> Clasificación molecular de la leucemia</a></li>
<li><a href="3.2-c4examples.html#estrogen"><span class="toc-section-number">3.2.3</span> Efecto del estrogeno y el tiempo de administración</a></li>
<li><a href="3.2-c4examples.html#CCL4"><span class="toc-section-number">3.2.4</span> Efecto del CCL4 en la expresión génica</a></li>
<li><a href="3.2-c4examples.html#swirl"><span class="toc-section-number">3.2.5</span> Estudio de la mutación “swirl” en el desarrollo del pez cebra</a></li>
<li><a href="3.2-c4examples.html#yeast"><span class="toc-section-number">3.2.6</span> Análisis de patrones en el ciclo celular</a></li>
<li><a href="3.2-c4examples.html#recapitulación"><span class="toc-section-number">3.2.7</span> Recapitulación</a></li>
</ul></li>
<li><a href="3.3-el-proceso-de-análisis-de-microarrays.html#el-proceso-de-análisis-de-microarrays"><span class="toc-section-number">3.3</span> El proceso de análisis de microarrays</a></li>
</ul></li>
<li><a href="4-MDAExpDesign.html#MDAExpDesign"><span class="toc-section-number">4</span> Diseño de experimentos de microarrays</a>
<ul>
<li><a href="4.1-fuentes-de-variabilidad.html#fuentes-de-variabilidad"><span class="toc-section-number">4.1</span> Fuentes de variabilidad</a></li>
<li><a href="4.2-tipos-de-variabilidad.html#tipos-de-variabilidad"><span class="toc-section-number">4.2</span> Tipos de variabilidad</a></li>
<li><a href="4.3-conceptos-básicos-de-diseño-de-experimentos.html#conceptos-básicos-de-diseño-de-experimentos"><span class="toc-section-number">4.3</span> Conceptos básicos de diseño de Experimentos</a></li>
<li><a href="4.4-principios-de-diseño-de-experimentos.html#principios-de-diseño-de-experimentos"><span class="toc-section-number">4.4</span> Principios de diseño de experimentos</a>
<ul>
<li><a href="4.4-principios-de-diseño-de-experimentos.html#replicación"><span class="toc-section-number">4.4.1</span> Replicación</a></li>
<li><a href="4.4-principios-de-diseño-de-experimentos.html#aleatorización"><span class="toc-section-number">4.4.2</span> Aleatorización</a></li>
<li><a href="4.4-principios-de-diseño-de-experimentos.html#bloqueo-o-control-local"><span class="toc-section-number">4.4.3</span> Bloqueo o control local</a></li>
</ul></li>
<li><a href="4.5-diseños-experimentales-para-microarrays-de-dos-colores.html#diseños-experimentales-para-microarrays-de-dos-colores"><span class="toc-section-number">4.5</span> Diseños experimentales para microarrays de dos colores</a></li>
</ul></li>
<li><a href="5-exploración-de-los-datos-control-de-calidad-y-preprocesado.html#exploración-de-los-datos-control-de-calidad-y-preprocesado"><span class="toc-section-number">5</span> Exploración de los datos, control de calidad y preprocesado</a>
<ul>
<li><a href="5.1-introducción.html#introducción"><span class="toc-section-number">5.1</span> Introducción</a>
<ul>
<li><a href="5.1-introducción.html#nivel-de-análisis-y-tipo-de-microarray"><span class="toc-section-number">5.1.1</span> Nivel de análisis y tipo de microarray</a></li>
<li><a href="5.1-introducción.html#datos-de-partida"><span class="toc-section-number">5.1.2</span> Datos de partida</a></li>
</ul></li>
<li><a href="5.2-exploración-y-control-de-calidad.html#exploración-y-control-de-calidad"><span class="toc-section-number">5.2</span> Exploración y control de calidad</a>
<ul>
<li><a href="5.2-exploración-y-control-de-calidad.html#control-de-calidad-con-gráficos-estadísticos-generales"><span class="toc-section-number">5.2.1</span> Control de calidad con gráficos estadísticos generales</a></li>
<li><a href="5.2-exploración-y-control-de-calidad.html#gráficos-de-diagnóstico-para-microarrays-de-dos-colores"><span class="toc-section-number">5.2.2</span> Gráficos de diagnóstico para microarrays de dos colores</a></li>
<li><a href="5.2-exploración-y-control-de-calidad.html#gráficos-de-diagnóstico-para-microarrays-de-un-color"><span class="toc-section-number">5.2.3</span> Gráficos de diagnóstico para microarrays de un color</a></li>
</ul></li>
<li><a href="5.3-normalización-de-arrays-de-dos-colores.html#normalización-de-arrays-de-dos-colores"><span class="toc-section-number">5.3</span> Normalización de arrays de dos colores</a>
<ul>
<li><a href="5.3-normalización-de-arrays-de-dos-colores.html#normalización-global"><span class="toc-section-number">5.3.1</span> Normalización global</a></li>
<li><a href="5.3-normalización-de-arrays-de-dos-colores.html#normalización-dependiente-de-la-intensidad"><span class="toc-section-number">5.3.2</span> Normalización dependiente de la intensidad</a></li>
</ul></li>
<li><a href="5.4-resumen-y-normalización-de-microarrays-de-affymetrix.html#resumen-y-normalización-de-microarrays-de-affymetrix"><span class="toc-section-number">5.4</span> Resumen y normalización de microarrays de Affymetrix</a>
<ul>
<li><a href="5.4-resumen-y-normalización-de-microarrays-de-affymetrix.html#el-método-rma-robust-multi-array-average"><span class="toc-section-number">5.4.1</span> El método RMA (Robust Multi-Array Average)</a></li>
</ul></li>
<li><a href="5.5-filtraje-no-específico.html#filtraje-no-específico"><span class="toc-section-number">5.5</span> Filtraje no específico</a></li>
</ul></li>
<li><a href="6-chapDEG.html#chapDEG"><span class="toc-section-number">6</span> Selección de genes diferencialmente expresados</a>
<ul>
<li><a href="6.1-introducción-1.html#introducción-1"><span class="toc-section-number">6.1</span> Introducción</a></li>
<li><a href="6.2-selección-de-genes-diferencialmente-expresados.html#selección-de-genes-diferencialmente-expresados"><span class="toc-section-number">6.2</span> Selección de genes diferencialmente expresados</a>
<ul>
<li><a href="6.2-selección-de-genes-diferencialmente-expresados.html#medidas-naturales-para-comparar-dos-muestras"><span class="toc-section-number">6.2.1</span> Medidas <em>naturales</em> para comparar dos muestras</a></li>
<li><a href="6.2-selección-de-genes-diferencialmente-expresados.html#un-primer-ejemplo"><span class="toc-section-number">6.2.2</span> Un primer ejemplo</a></li>
<li><a href="6.2-selección-de-genes-diferencialmente-expresados.html#selección-de-genes-usando-tests-estadísticos"><span class="toc-section-number">6.2.3</span> Selección de genes usando tests estadísticos</a></li>
</ul></li>
<li><a href="6.3-significación-estadística-y-expresión-diferencial.html#significación-estadística-y-expresión-diferencial"><span class="toc-section-number">6.3</span> Significación estadística y expresión diferencial</a>
<ul>
<li><a href="6.3-significación-estadística-y-expresión-diferencial.html#volcano-plots"><span class="toc-section-number">6.3.1</span> “Volcano plots”</a></li>
<li><a href="6.3-significación-estadística-y-expresión-diferencial.html#potencia-y-tamaño-muestral"><span class="toc-section-number">6.3.2</span> Potencia y tamaño muestral</a></li>
</ul></li>
<li><a href="6.4-el-problema-de-la-múltiplicidad-de-tests-multiple-testing.html#el-problema-de-la-múltiplicidad-de-tests-multiple-testing"><span class="toc-section-number">6.4</span> El problema de la múltiplicidad de tests (“multiple testing”)</a></li>
<li><a href="6.5-modelos-lineales-para-la-selección-de-genes-limma.html#modelos-lineales-para-la-selección-de-genes-limma"><span class="toc-section-number">6.5</span> Modelos lineales para la selección de genes: <tt>limma </tt></a>
<ul>
<li><a href="6.5-modelos-lineales-para-la-selección-de-genes-limma.html#el-modelo-lineal-general"><span class="toc-section-number">6.5.1</span> El modelo lineal general</a></li>
<li><a href="6.5-modelos-lineales-para-la-selección-de-genes-limma.html#ejemplos-de-situaciones-modelizables-linealmente"><span class="toc-section-number">6.5.2</span> Ejemplos de situaciones <em>modelizables linealmente</em></a></li>
<li><a href="6.5-modelos-lineales-para-la-selección-de-genes-limma.html#ejemplo-2-comparación-de-tres-grupos"><span class="toc-section-number">6.5.3</span> Ejemplo 2: Comparación de tres grupos</a></li>
<li><a href="6.5-modelos-lineales-para-la-selección-de-genes-limma.html#estimación-e-inferencia-con-el-modelo-lineal"><span class="toc-section-number">6.5.4</span> Estimación e inferencia con el modelo lineal</a></li>
<li><a href="6.5-modelos-lineales-para-la-selección-de-genes-limma.html#modelos-lineales-para-microarrays"><span class="toc-section-number">6.5.5</span> Modelos lineales para Microarrays</a></li>
<li><a href="6.5-modelos-lineales-para-la-selección-de-genes-limma.html#implementación-y-ejemplos"><span class="toc-section-number">6.5.6</span> Implementación y ejemplos</a></li>
</ul></li>
</ul></li>
<li><a href="7-caso-estrógeno-selección-de-genes-diferencialmente-expresados-asociados-con-la-resistencia-a-estrógenos..html#caso-estrógeno-selección-de-genes-diferencialmente-expresados-asociados-con-la-resistencia-a-estrógenos."><span class="toc-section-number">7</span> Caso “Estrógeno”: Selección de genes diferencialmente expresados asociados con la resistencia a estrógenos.</a>
<ul>
<li><a href="7.1-introducción-2.html#introducción-2"><span class="toc-section-number">7.1</span> Introducción</a></li>
<li><a href="7.2-el-estudio-estrógeno.html#el-estudio-estrógeno"><span class="toc-section-number">7.2</span> El estudio “Estrógeno”</a>
<ul>
<li><a href="7.2-el-estudio-estrógeno.html#directorios-y-opciones-de-trabajo"><span class="toc-section-number">7.2.1</span> Directorios y opciones de trabajo</a></li>
</ul></li>
<li><a href="7.3-obtención-y-lectura-de-los-datos.html#obtención-y-lectura-de-los-datos"><span class="toc-section-number">7.3</span> Obtención y lectura de los datos</a>
<ul>
<li><a href="7.3-obtención-y-lectura-de-los-datos.html#los-datos"><span class="toc-section-number">7.3.1</span> Los datos</a></li>
<li><a href="7.3-obtención-y-lectura-de-los-datos.html#lectura-de-los-datos"><span class="toc-section-number">7.3.2</span> Lectura de los datos</a></li>
</ul></li>
<li><a href="7.4-exploración-control-de-calidad-y-normalización.html#exploración-control-de-calidad-y-normalización"><span class="toc-section-number">7.4</span> Exploración, Control de Calidad y Normalización</a>
<ul>
<li><a href="7.4-exploración-control-de-calidad-y-normalización.html#exploración-y-visualización"><span class="toc-section-number">7.4.1</span> Exploración y visualización</a></li>
<li><a href="7.4-exploración-control-de-calidad-y-normalización.html#control-de-calidad"><span class="toc-section-number">7.4.2</span> Control de calidad</a></li>
<li><a href="7.4-exploración-control-de-calidad-y-normalización.html#normalizacion-y-filtraje"><span class="toc-section-number">7.4.3</span> Normalizacion y Filtraje</a></li>
</ul></li>
<li><a href="7.5-selección-de-genes-diferencialmente-expresados-1.html#selección-de-genes-diferencialmente-expresados-1"><span class="toc-section-number">7.5</span> Selección de genes diferencialmente expresados</a>
<ul>
<li><a href="7.5-selección-de-genes-diferencialmente-expresados-1.html#análisis-basado-en-modelos-lineales"><span class="toc-section-number">7.5.1</span> Análisis basado en modelos lineales</a></li>
<li><a href="7.5-selección-de-genes-diferencialmente-expresados-1.html#comparaciones-múltiples"><span class="toc-section-number">7.5.2</span> Comparaciones múltiples</a></li>
</ul></li>
</ul></li>
<li><a href="8-después-de-la-selección-análisis-de-listas-de-genes.html#después-de-la-selección-análisis-de-listas-de-genes"><span class="toc-section-number">8</span> Después de la selección: Análisis de listas de genes</a>
<ul>
<li><a href="8.1-introducción-3.html#introducción-3"><span class="toc-section-number">8.1</span> Introducción</a></li>
<li><a href="8.2-análisis-comparativo-de-listas-de-genes.html#análisis-comparativo-de-listas-de-genes"><span class="toc-section-number">8.2</span> Análisis comparativo de listas de genes</a>
<ul>
<li><a href="8.2-análisis-comparativo-de-listas-de-genes.html#ejemplo-comparación-de-listas-en-el-caso-celltypes"><span class="toc-section-number">8.2.1</span> Ejemplo: comparación de listas en el caso <tt>celltypes</tt></a></li>
</ul></li>
<li><a href="8.3-anotación-de-los-resultados.html#anotación-de-los-resultados"><span class="toc-section-number">8.3</span> Anotación de los resultados</a></li>
<li><a href="8.4-visualización-de-los-perfiles-de-expresión.html#visualización-de-los-perfiles-de-expresión"><span class="toc-section-number">8.4</span> Visualización de los perfiles de expresión</a></li>
<li><a href="8.5-análisis-de-significación-biológica.html#análisis-de-significación-biológica"><span class="toc-section-number">8.5</span> Análisis de significación biológica</a>
<ul>
<li><a href="8.5-análisis-de-significación-biológica.html#análisis-de-enriquecimiento"><span class="toc-section-number">8.5.1</span> Análisis de enriquecimiento <a name="GEA"></a></a></li>
<li><a href="8.5-análisis-de-significación-biológica.html#análisis-de-enriquecimiento-con-bioconductor"><span class="toc-section-number">8.5.2</span> Análisis de enriquecimiento con Bioconductor</a></li>
</ul></li>
</ul></li>
<li><a href="9-referencias.html#referencias"><span class="toc-section-number">9</span> Referencias</a></li>
</ul>
</div>
</div>
</div>
<div class="row">
<div class="col-sm-12">
<div id="anotación-de-los-resultados" class="section level2" number="8.3">
<h2><span class="header-section-number">8.3</span> Anotación de los resultados</h2>
<p>La identificación de los genes seleccionados puede resultar más
sencilla para el especialista en un campo si se utilizan nombres
estándar como el simbolo del gen o “gene symbol.” Ahora bien hemos de recordar que los microarrays suele ser un producto comercial en los que la empresa que los crea decide que sondas de cada gen o exón coloca en cada posición del array. Esto significa que para poder indicar el nombre de cada gen seleccionado es preciso disponer de algún tipo de <em>tabla de anotaciones</em> que relacione cada sonda con los genes a los que apunta.
Esta tabla debería ser proporcionada por las companñias que producen los arrays pero es algo que queda a su criterio y, en el mejor de los casos, cada empresa puede seguir unos criterios distintos.</p>
<p>Afortunadamente si se trabaja con Bioconductor existe una solución homogenea a este problema. Se trata de los <em>paquetes de anotaciones</em> creados y mantenidos por el equipo de Bioconductor a partir de la información publicada por cada compañia pero con una forma común de acceso. Es decir aunque las distintas empresas utilicen fotmatos distintos desde el punto de vista del usuario de Bioconductor esto no importará: si existe el paquete se utiliza como todos los demás.</p>
<p>De hecho Bioconductor incorpora varios tipos de paquetes de anotaciones:</p>
<ul>
<li><strong>Paquetes de anotaciones de microarrays</strong>: Asocian a vada sonda la información disponible para ella en distintas bases de datos. Consisten en una serie de tablas SQL (de hecho cada paquete es una base de datos SQL) que asocian las sondas de cada gen con sus correspondencias en distintas bases de datos.</li>
<li><strong>Paquetes de anotaciones de organismos</strong>: Contienen asociaciones similares a las anteriores pero las claves principales de cada tabla no son las sondas de un microarray determinado sino los genes de un organismo dado. Es decir en estos paquetes cada tabla asocia el identificador <em>entrez</em> del gen con sus correspondientes identificadores en otras bases de datos.</li>
<li><strong>Paquetes de anotaciones de bases de datos</strong> Estos paquetes difieren de los anteriores porque lo que hacen es almacenar en el mismo formato que los anteriores –bases de datos SQL consultables en R– una copia de ciertas bases de datos como la <em>Gene Ontology (GO)</em> o la <em>Kyoto Encyclopedia of Genes and Genomes (KEGG)</em>.</li>
</ul>
<p>Para saber que anotaciones estan disponibles debe cargarse el paquete y llamar la función del mismo nombre. Por ejempl para los microarrays del caso <tt>celltypes</tt>:</p>
<p>Para saber que anotaciones estan disponibles debe cargarse el paquete y llamar la función del mismo nombre sin el sufijo “.db.”</p>
<div class="sourceCode" id="cb88"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb88-1"><a href="8.3-anotación-de-los-resultados.html#cb88-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(mouse4302.db)</span>
<span id="cb88-2"><a href="8.3-anotación-de-los-resultados.html#cb88-2" aria-hidden="true" tabindex="-1"></a>anotData <span class="ot">&lt;-</span> <span class="fu">capture.output</span>(<span class="fu">mouse4302</span>())</span>
<span id="cb88-3"><a href="8.3-anotación-de-los-resultados.html#cb88-3" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(anotData)</span></code></pre></div>
<pre><code>##  [1] &quot;Quality control information for mouse4302:&quot;                  
##  [2] &quot;&quot;                                                            
##  [3] &quot;&quot;                                                            
##  [4] &quot;This package has the following mappings:&quot;                    
##  [5] &quot;&quot;                                                            
##  [6] &quot;mouse4302ACCNUM has 45101 mapped keys (of 45101 keys)&quot;       
##  [7] &quot;mouse4302ALIAS2PROBE has 81336 mapped keys (of 156785 keys)&quot; 
##  [8] &quot;mouse4302CHR has 37432 mapped keys (of 45101 keys)&quot;          
##  [9] &quot;mouse4302CHRLENGTHS has 66 mapped keys (of 66 keys)&quot;         
## [10] &quot;mouse4302CHRLOC has 34742 mapped keys (of 45101 keys)&quot;       
## [11] &quot;mouse4302CHRLOCEND has 34742 mapped keys (of 45101 keys)&quot;    
## [12] &quot;mouse4302ENSEMBL has 34432 mapped keys (of 45101 keys)&quot;      
## [13] &quot;mouse4302ENSEMBL2PROBE has 18067 mapped keys (of 33358 keys)&quot;
## [14] &quot;mouse4302ENTREZID has 37466 mapped keys (of 45101 keys)&quot;     
## [15] &quot;mouse4302ENZYME has 4480 mapped keys (of 45101 keys)&quot;        
## [16] &quot;mouse4302ENZYME2PROBE has 954 mapped keys (of 971 keys)&quot;     
## [17] &quot;mouse4302GENENAME has 37466 mapped keys (of 45101 keys)&quot;     
## [18] &quot;mouse4302GO has 34021 mapped keys (of 45101 keys)&quot;           
## [19] &quot;mouse4302GO2ALLPROBES has 22446 mapped keys (of 22649 keys)&quot; 
## [20] &quot;mouse4302GO2PROBE has 18283 mapped keys (of 18511 keys)&quot;     
## [21] &quot;mouse4302MGI has 37455 mapped keys (of 45101 keys)&quot;          
## [22] &quot;mouse4302MGI2PROBE has 20485 mapped keys (of 70076 keys)&quot;    
## [23] &quot;mouse4302PATH has 10731 mapped keys (of 45101 keys)&quot;         
## [24] &quot;mouse4302PATH2PROBE has 225 mapped keys (of 225 keys)&quot;       
## [25] &quot;mouse4302PMID has 37302 mapped keys (of 45101 keys)&quot;         
## [26] &quot;mouse4302PMID2PROBE has 327939 mapped keys (of 340004 keys)&quot; 
## [27] &quot;mouse4302REFSEQ has 35206 mapped keys (of 45101 keys)&quot;       
## [28] &quot;mouse4302SYMBOL has 37466 mapped keys (of 45101 keys)&quot;       
## [29] &quot;mouse4302UNIPROT has 33001 mapped keys (of 45101 keys)&quot;      
## [30] &quot;&quot;                                                            
## [31] &quot;&quot;                                                            
## [32] &quot;Additional Information about this package:&quot;                  
## [33] &quot;&quot;                                                            
## [34] &quot;DB schema: MOUSECHIP_DB&quot;                                     
## [35] &quot;DB schema version: 2.1&quot;                                      
## [36] &quot;Organism: Mus musculus&quot;                                      
## [37] &quot;Date for NCBI data: 2021-Apr14&quot;                              
## [38] &quot;Date for GO data: 2021-02-01&quot;                                
## [39] &quot;Date for KEGG data: 2011-Mar15&quot;                              
## [40] &quot;Date for Golden Path data: 2021-Feb16&quot;                       
## [41] &quot;Date for Ensembl data: 2021-Feb16&quot;</code></pre>
<div class="sourceCode" id="cb90"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb90-1"><a href="8.3-anotación-de-los-resultados.html#cb90-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span> (<span class="st">&quot;... output continues until &quot;</span>, <span class="fu">length</span>(anotData), <span class="st">&quot; lines.</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## ... output continues until  41  lines.</code></pre>
<p>Si en vez del paquetes del microarray usáramos el paquete de organismo, en este caso del ratón.</p>
<div class="sourceCode" id="cb92"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb92-1"><a href="8.3-anotación-de-los-resultados.html#cb92-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span>(<span class="fu">require</span>(org.Mm.eg.db))){</span>
<span id="cb92-2"><a href="8.3-anotación-de-los-resultados.html#cb92-2" aria-hidden="true" tabindex="-1"></a>        <span class="fu">biocLite</span>(<span class="st">&quot;org.Mm.eg.db&quot;</span>)</span>
<span id="cb92-3"><a href="8.3-anotación-de-los-resultados.html#cb92-3" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb92-4"><a href="8.3-anotación-de-los-resultados.html#cb92-4" aria-hidden="true" tabindex="-1"></a><span class="fu">require</span>(org.Mm.eg.db)</span>
<span id="cb92-5"><a href="8.3-anotación-de-los-resultados.html#cb92-5" aria-hidden="true" tabindex="-1"></a>anotData <span class="ot">&lt;-</span> <span class="fu">capture.output</span>(<span class="fu">org.Mm.eg</span>())</span>
<span id="cb92-6"><a href="8.3-anotación-de-los-resultados.html#cb92-6" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(anotData[<span class="dv">1</span><span class="sc">:</span><span class="dv">15</span>])</span></code></pre></div>
<pre><code>##  [1] &quot;Quality control information for org.Mm.eg:&quot;                
##  [2] &quot;&quot;                                                          
##  [3] &quot;&quot;                                                          
##  [4] &quot;This package has the following mappings:&quot;                  
##  [5] &quot;&quot;                                                          
##  [6] &quot;org.Mm.egACCNUM has 46208 mapped keys (of 73083 keys)&quot;     
##  [7] &quot;org.Mm.egACCNUM2EG has 606678 mapped keys (of 606678 keys)&quot;
##  [8] &quot;org.Mm.egALIAS2EG has 156785 mapped keys (of 156785 keys)&quot; 
##  [9] &quot;org.Mm.egCHR has 72225 mapped keys (of 73083 keys)&quot;        
## [10] &quot;org.Mm.egCHRLENGTHS has 66 mapped keys (of 66 keys)&quot;       
## [11] &quot;org.Mm.egCHRLOC has 26193 mapped keys (of 73083 keys)&quot;     
## [12] &quot;org.Mm.egCHRLOCEND has 26193 mapped keys (of 73083 keys)&quot;  
## [13] &quot;org.Mm.egENSEMBL has 33468 mapped keys (of 73083 keys)&quot;    
## [14] &quot;org.Mm.egENSEMBL2EG has 33358 mapped keys (of 33358 keys)&quot; 
## [15] &quot;org.Mm.egENSEMBLPROT has 9437 mapped keys (of 73083 keys)&quot;</code></pre>
<div class="sourceCode" id="cb94"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb94-1"><a href="8.3-anotación-de-los-resultados.html#cb94-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span> (<span class="st">&quot;... output continues until &quot;</span>, <span class="fu">length</span>(anotData), <span class="st">&quot; lines.</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## ... output continues until  48  lines.</code></pre>
<p>Cada tabla de asociación puede consultarse de diversas formas,</p>
<ul>
<li>Con las funciones <tt>get</tt> o <tt>mget</tt>.</li>
<li>Convirtiéndola en una tabla y extrayendo valores</li>
<li>En algunos casos utilizando funciones específicas como <tt>getSYMBOL</tt> o <tt>getEG</tt> (por “Entrez Gene”) cuando exitan.</li>
</ul>
<p>Por ejemplo si tomamos los cinco primeros genes seleccionados en la comparación “LPS.in.AGED”</p>
<div class="sourceCode" id="cb96"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb96-1"><a href="8.3-anotación-de-los-resultados.html#cb96-1" aria-hidden="true" tabindex="-1"></a>top5 <span class="ot">&lt;-</span><span class="fu">rownames</span>(topTab_LPS.in.AGED)[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>]</span>
<span id="cb96-2"><a href="8.3-anotación-de-los-resultados.html#cb96-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Usando mget</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## Usando mget</code></pre>
<div class="sourceCode" id="cb98"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb98-1"><a href="8.3-anotación-de-los-resultados.html#cb98-1" aria-hidden="true" tabindex="-1"></a>geneSymbol5<span class="fl">.1</span> <span class="ot">&lt;-</span> <span class="fu">unlist</span>(<span class="fu">mget</span>(top5, mouse4302SYMBOL))</span>
<span id="cb98-2"><a href="8.3-anotación-de-los-resultados.html#cb98-2" aria-hidden="true" tabindex="-1"></a>geneSymbol5<span class="fl">.1</span></span></code></pre></div>
<pre><code>## 1450826_a_at   1449450_at   1419607_at 1419681_a_at   1419209_at 
##       &quot;Saa3&quot;      &quot;Ptges&quot;        &quot;Tnf&quot;      &quot;Prok2&quot;      &quot;Cxcl1&quot;</code></pre>
<div class="sourceCode" id="cb100"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb100-1"><a href="8.3-anotación-de-los-resultados.html#cb100-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Usando toTable</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## Usando toTable</code></pre>
<div class="sourceCode" id="cb102"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb102-1"><a href="8.3-anotación-de-los-resultados.html#cb102-1" aria-hidden="true" tabindex="-1"></a>genesTable<span class="ot">&lt;-</span> <span class="fu">toTable</span>(mouse4302SYMBOL)</span>
<span id="cb102-2"><a href="8.3-anotación-de-los-resultados.html#cb102-2" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(genesTable) <span class="ot">&lt;-</span>  genesTable<span class="sc">$</span>probe_id</span>
<span id="cb102-3"><a href="8.3-anotación-de-los-resultados.html#cb102-3" aria-hidden="true" tabindex="-1"></a>genesTable[top5, <span class="dv">2</span>]</span></code></pre></div>
<pre><code>## [1] &quot;Saa3&quot;  &quot;Ptges&quot; &quot;Tnf&quot;   &quot;Prok2&quot; &quot;Cxcl1&quot;</code></pre>
<div class="sourceCode" id="cb104"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb104-1"><a href="8.3-anotación-de-los-resultados.html#cb104-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Usando getSYMBOL</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## Usando getSYMBOL</code></pre>
<div class="sourceCode" id="cb106"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb106-1"><a href="8.3-anotación-de-los-resultados.html#cb106-1" aria-hidden="true" tabindex="-1"></a><span class="fu">require</span>(annotate)</span>
<span id="cb106-2"><a href="8.3-anotación-de-los-resultados.html#cb106-2" aria-hidden="true" tabindex="-1"></a>geneSymbol5<span class="fl">.3</span> <span class="ot">&lt;-</span> <span class="fu">getSYMBOL</span>(top5, <span class="st">&quot;mouse4302.db&quot;</span>)</span>
<span id="cb106-3"><a href="8.3-anotación-de-los-resultados.html#cb106-3" aria-hidden="true" tabindex="-1"></a>geneSymbol5<span class="fl">.3</span></span></code></pre></div>
<pre><code>## 1450826_a_at   1449450_at   1419607_at 1419681_a_at   1419209_at 
##       &quot;Saa3&quot;      &quot;Ptges&quot;        &quot;Tnf&quot;      &quot;Prok2&quot;      &quot;Cxcl1&quot;</code></pre>
<p>Bioconductor dispone de algunos paquetes que permiten aprovechar esta funcionalidad anterior para obtener las anotaciones de cada gen y generar una tabla HTML con enlaces a algunas bases de datos.</p>
<p>De forma sencilla es posible obtener tablas con las anotaciones correspondientes a los genes seleccionados. Si se desea ser más ambicioso es posible generar tablas en las que se combinen hiperenlaces a las anotaciones con los resultados de la selección de genes.</p>
<p>El paquete <tt>annafy</tt> permite de forma muy simple generar una tabla de anotaciones con hiperenlaces a las bases de datos para cada anotación seleccionada.</p>
<p>La instrucción siguiente crearia una tabla con las anotaciones disponibles para los genes seleccionados en la sección de comparaciones múltiples.</p>
<div class="sourceCode" id="cb108"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb108-1"><a href="8.3-anotación-de-los-resultados.html#cb108-1" aria-hidden="true" tabindex="-1"></a><span class="fu">require</span>(annaffy)</span>
<span id="cb108-2"><a href="8.3-anotación-de-los-resultados.html#cb108-2" aria-hidden="true" tabindex="-1"></a>genesSelected <span class="ot">&lt;-</span> <span class="fu">rownames</span>(res.selected)</span>
<span id="cb108-3"><a href="8.3-anotación-de-los-resultados.html#cb108-3" aria-hidden="true" tabindex="-1"></a>at <span class="ot">&lt;-</span> <span class="fu">aafTableAnn</span>(genesSelected, <span class="st">&quot;mouse4302.db&quot;</span>)</span>
<span id="cb108-4"><a href="8.3-anotación-de-los-resultados.html#cb108-4" aria-hidden="true" tabindex="-1"></a><span class="fu">saveHTML</span> (at, <span class="at">file=</span><span class="st">&quot;results/anotations.html&quot;</span>,</span>
<span id="cb108-5"><a href="8.3-anotación-de-los-resultados.html#cb108-5" aria-hidden="true" tabindex="-1"></a>          <span class="st">&quot;Annotations for selected genes&quot;</span>)</span></code></pre></div>
</div>
<p style="text-align: center;">
<a href="8.2-análisis-comparativo-de-listas-de-genes.html"><button class="btn btn-default">Previous</button></a>
<a href="8.4-visualización-de-los-perfiles-de-expresión.html"><button class="btn btn-default">Next</button></a>
</p>
</div>
</div>


</div>

<script>

// add bootstrap table styles to pandoc tables
$(document).ready(function () {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
});

</script>

</body>
</html>
