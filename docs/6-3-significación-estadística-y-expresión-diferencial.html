<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<meta property="og:title" content="6.3 Significación estadística y expresión diferencial | Analisis de datos omicos" />
<meta property="og:type" content="book" />





<meta name="author" content="Alex Sánchez-Pla^{1,2} y Ricardo Gonzalo Sanz^2" />
<meta name="author" content="^1 Departament de Genètica, Microbiologia i Estadística. Universitat de Barcelona (UB)." />
<meta name="author" content="^2 Unitat d’Estadística i Bioinformàtica. Vall d’Hebron Institut de Recerca (VHIR)." />


<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  TeX: { equationNumbers: { autoNumber: "AMS" } }
});
</script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<meta name="description" content="6.3 Significación estadística y expresión diferencial | Analisis de datos omicos">

<title>6.3 Significación estadística y expresión diferencial | Analisis de datos omicos</title>

<script src="libs/header-attrs-2.7/header-attrs.js"></script>
<script src="libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="libs/bootstrap-3.3.5/css/bootstrap.min.css" rel="stylesheet" />
<script src="libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="libs/navigation-1.1/tabsets.js"></script>


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>


<link rel="stylesheet" href="style.css" type="text/css" />

<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
  height: auto;
}
</style>
</head>

<body>

<div class="container-fluid main-container">


<div class="row">
<div class="col-sm-12">
<div id="TOC">
<ul>
<li><a href="index.html#presentación"><span class="toc-section-number">1</span> Presentación</a>
<ul>
<li><a href="1-1-instalación-de-paquetes-de-r-y-código-de-los-capítulos.html#instalación-de-paquetes-de-r-y-código-de-los-capítulos"><span class="toc-section-number">1.1</span> Instalación de paquetes de R y código de los capítulos</a></li>
</ul></li>
<li><a href="2-introduccion-a-los-microarrays-y-otras-tecnologías-omicas.html#introduccion-a-los-microarrays-y-otras-tecnologías-omicas"><span class="toc-section-number">2</span> Introduccion a los microarrays y otras tecnologías omicas</a>
<ul>
<li><a href="2-1-antecedentes-históricos.html#antecedentes-históricos"><span class="toc-section-number">2.1</span> Antecedentes históricos</a></li>
<li><a href="2-2-los-microarrays.html#los-microarrays"><span class="toc-section-number">2.2</span> Los microarrays</a>
<ul>
<li><a href="2-2-los-microarrays.html#aplicaciones-de-los-microarrays"><span class="toc-section-number">2.2.1</span> Aplicaciones de los microarrays</a></li>
</ul></li>
<li><a href="2-3-cómo-funcionan-los-microarrays.html#cómo-funcionan-los-microarrays"><span class="toc-section-number">2.3</span> Cómo funcionan los microarrays</a>
<ul>
<li><a href="2-3-cómo-funcionan-los-microarrays.html#microarrays-de-dos-colores"><span class="toc-section-number">2.3.1</span> Microarrays de dos colores</a></li>
<li><a href="2-3-cómo-funcionan-los-microarrays.html#microarrays-de-un-color"><span class="toc-section-number">2.3.2</span> Microarrays de un color</a></li>
<li><a href="2-3-cómo-funcionan-los-microarrays.html#realización-de-un-experimento-de-microarrays"><span class="toc-section-number">2.3.3</span> Realización de un experimento de microarrays</a></li>
<li><a href="2-3-cómo-funcionan-los-microarrays.html#como-se-mide-la-expresión"><span class="toc-section-number">2.3.4</span> Como se mide la expresión</a></li>
</ul></li>
<li><a href="2-4-bioinformática-de-microarrays.html#bioinformática-de-microarrays"><span class="toc-section-number">2.4</span> Bioinformática de Microarrays<a name="Bioinformática"></a></a>
<ul>
<li><a href="2-4-bioinformática-de-microarrays.html#software-para-el-análisis-de-datos-de-microarrays"><span class="toc-section-number">2.4.1</span> Software para el análisis de datos de microarrays</a></li>
<li><a href="2-4-bioinformática-de-microarrays.html#bases-de-datos-de-microarrays"><span class="toc-section-number">2.4.2</span> Bases de datos de Microarrays</a></li>
</ul></li>
<li><a href="2-5-extensiones-1-otros-tipos-de-microarrays.html#extensiones-1-otros-tipos-de-microarrays"><span class="toc-section-number">2.5</span> Extensiones (1): Otros tipos de microarrays<a name="extensions"></a></a>
<ul>
<li><a href="2-5-extensiones-1-otros-tipos-de-microarrays.html#otros-microarrays-de-adn"><span class="toc-section-number">2.5.1</span> Otros microarrays de ADN</a></li>
<li><a href="2-5-extensiones-1-otros-tipos-de-microarrays.html#otros-tipos-de-microarrays-proteínas-o-carbohidratos"><span class="toc-section-number">2.5.2</span> Otros tipos de microarrays: Proteínas o carbohidratos</a></li>
</ul></li>
<li><a href="2-6-extensiones-2-ngs-nextnow-generation-sequencing.html#extensiones-2-ngs-nextnow-generation-sequencing"><span class="toc-section-number">2.6</span> Extensiones (2): <em>NGS: Next(Now) Generation Sequencing</em></a>
<ul>
<li><a href="2-6-extensiones-2-ngs-nextnow-generation-sequencing.html#visión-global-de-las-tecnologías-de-secuenciación"><span class="toc-section-number">2.6.1</span> Visión global de las tecnologías de secuenciación</a></li>
<li><a href="2-6-extensiones-2-ngs-nextnow-generation-sequencing.html#de-la-secuenciación-sanger-a-la-ultrasecuenciación"><span class="toc-section-number">2.6.2</span> De la secuenciación Sanger a la ultrasecuenciación</a></li>
<li><a href="2-6-extensiones-2-ngs-nextnow-generation-sequencing.html#tecnologías-de-ultrasecuenciación"><span class="toc-section-number">2.6.3</span> Tecnologías de ultrasecuenciación</a></li>
</ul></li>
</ul></li>
<li><a href="3-MDAProcess.html#MDAProcess"><span class="toc-section-number">3</span> El proceso de análisis de microarrays</a>
<ul>
<li><a href="3-1-tipos-de-estudios.html#tipos-de-estudios"><span class="toc-section-number">3.1</span> Tipos de estudios</a>
<ul>
<li><a href="3-1-tipos-de-estudios.html#comparación-de-grupos-o-class-comparison"><span class="toc-section-number">3.1.1</span> Comparación de grupos o “Class comparison”</a></li>
<li><a href="3-1-tipos-de-estudios.html#predicción-de-clase-o-class-prediction"><span class="toc-section-number">3.1.2</span> Predicción de clase o “Class prediction”</a></li>
<li><a href="3-1-tipos-de-estudios.html#descubrimiento-de-clases-o-class-discovery"><span class="toc-section-number">3.1.3</span> Descubrimiento de clases o “Class discovery”</a></li>
<li><a href="3-1-tipos-de-estudios.html#otros-tipos-de-estudios"><span class="toc-section-number">3.1.4</span> Otros tipos de estudios</a></li>
</ul></li>
<li><a href="3-2-c4examples.html#c4examples"><span class="toc-section-number">3.2</span> Algunos ejemplos concretos</a>
<ul>
<li><a href="3-2-c4examples.html#celltypes"><span class="toc-section-number">3.2.1</span> Estudio de procesos regulados por citoquinas</a></li>
<li><a href="3-2-c4examples.html#golub"><span class="toc-section-number">3.2.2</span> Clasificación molecular de la leucemia</a></li>
<li><a href="3-2-c4examples.html#efecto-del-estrogeno-y-el-tiempo-de-administración-estrogen"><span class="toc-section-number">3.2.3</span> Efecto del estrogeno y el tiempo de administración {#estrogen]</a></li>
<li><a href="3-2-c4examples.html#CCL4"><span class="toc-section-number">3.2.4</span> Efecto del CCL4 en la expresión génica</a></li>
<li><a href="3-2-c4examples.html#yeast"><span class="toc-section-number">3.2.5</span> Análisis de patrones en el ciclo celular</a></li>
<li><a href="3-2-c4examples.html#recapitulación"><span class="toc-section-number">3.2.6</span> Recapitulación</a></li>
</ul></li>
<li><a href="3-3-el-proceso-de-análisis-de-microarrays.html#el-proceso-de-análisis-de-microarrays"><span class="toc-section-number">3.3</span> El proceso de análisis de microarrays</a></li>
</ul></li>
<li><a href="4-MDAExpDesign.html#MDAExpDesign"><span class="toc-section-number">4</span> Diseño de experimentos de microarrays</a>
<ul>
<li><a href="4-1-fuentes-de-variabilidad.html#fuentes-de-variabilidad"><span class="toc-section-number">4.1</span> Fuentes de variabilidad</a></li>
<li><a href="4-2-tipos-de-variabilidad.html#tipos-de-variabilidad"><span class="toc-section-number">4.2</span> Tipos de variabilidad</a></li>
<li><a href="4-3-conceptos-básicos-de-diseño-de-experimentos.html#conceptos-básicos-de-diseño-de-experimentos"><span class="toc-section-number">4.3</span> Conceptos básicos de diseño de Experimentos</a></li>
<li><a href="4-4-principios-de-diseño-de-experimentos.html#principios-de-diseño-de-experimentos"><span class="toc-section-number">4.4</span> Principios de diseño de experimentos</a>
<ul>
<li><a href="4-4-principios-de-diseño-de-experimentos.html#replicación"><span class="toc-section-number">4.4.1</span> Replicación</a></li>
<li><a href="4-4-principios-de-diseño-de-experimentos.html#aleatorización"><span class="toc-section-number">4.4.2</span> Aleatorización</a></li>
<li><a href="4-4-principios-de-diseño-de-experimentos.html#bloqueo-o-control-local"><span class="toc-section-number">4.4.3</span> Bloqueo o control local</a></li>
</ul></li>
<li><a href="4-5-diseños-experimentales-para-microarrays-de-dos-colores.html#diseños-experimentales-para-microarrays-de-dos-colores"><span class="toc-section-number">4.5</span> Diseños experimentales para microarrays de dos colores</a></li>
</ul></li>
<li><a href="5-exploración-de-los-datos-control-de-calidad-y-preprocesado.html#exploración-de-los-datos-control-de-calidad-y-preprocesado"><span class="toc-section-number">5</span> Exploración de los datos, control de calidad y preprocesado</a>
<ul>
<li><a href="5-1-introducción.html#introducción"><span class="toc-section-number">5.1</span> Introducción</a>
<ul>
<li><a href="5-1-introducción.html#nivel-de-análisis-y-tipo-de-microarray"><span class="toc-section-number">5.1.1</span> Nivel de análisis y tipo de microarray</a></li>
<li><a href="5-1-introducción.html#datos-de-partida"><span class="toc-section-number">5.1.2</span> Datos de partida</a></li>
</ul></li>
<li><a href="5-2-exploración-y-control-de-calidad.html#exploración-y-control-de-calidad"><span class="toc-section-number">5.2</span> Exploración y control de calidad</a>
<ul>
<li><a href="5-2-exploración-y-control-de-calidad.html#control-de-calidad-con-gráficos-estadísticos-generales"><span class="toc-section-number">5.2.1</span> Control de calidad con gráficos estadísticos generales</a></li>
<li><a href="5-2-exploración-y-control-de-calidad.html#gráficos-de-diagnóstico-para-microarrays-de-dos-colores"><span class="toc-section-number">5.2.2</span> Gráficos de diagnóstico para microarrays de dos colores</a></li>
<li><a href="5-2-exploración-y-control-de-calidad.html#gráficos-de-diagnóstico-para-microarrays-de-un-color"><span class="toc-section-number">5.2.3</span> Gráficos de diagnóstico para microarrays de un color</a></li>
</ul></li>
<li><a href="5-3-normalización-de-arrays-de-dos-colores.html#normalización-de-arrays-de-dos-colores"><span class="toc-section-number">5.3</span> Normalización de arrays de dos colores</a>
<ul>
<li><a href="5-3-normalización-de-arrays-de-dos-colores.html#normalización-global"><span class="toc-section-number">5.3.1</span> Normalización global</a></li>
<li><a href="5-3-normalización-de-arrays-de-dos-colores.html#normalización-dependiente-de-la-intensidad"><span class="toc-section-number">5.3.2</span> Normalización dependiente de la intensidad</a></li>
</ul></li>
<li><a href="5-4-resumen-y-normalización-de-microarrays-de-affymetrix.html#resumen-y-normalización-de-microarrays-de-affymetrix"><span class="toc-section-number">5.4</span> Resumen y normalización de microarrays de Affymetrix</a>
<ul>
<li><a href="5-4-resumen-y-normalización-de-microarrays-de-affymetrix.html#métodos-originales-de-affymetrix"><span class="toc-section-number">5.4.1</span> Métodos originales de Affymetrix</a></li>
<li><a href="5-4-resumen-y-normalización-de-microarrays-de-affymetrix.html#el-método-rma-robust-multi-array-average"><span class="toc-section-number">5.4.2</span> El método RMA (Robust Multi-Array Average)</a></li>
</ul></li>
<li><a href="5-5-filtraje-no-específico.html#filtraje-no-específico"><span class="toc-section-number">5.5</span> Filtraje no específico</a></li>
</ul></li>
<li><a href="6-selección-de-genes-diferencialmente-expresados-chapdeg.html#selección-de-genes-diferencialmente-expresados-chapdeg"><span class="toc-section-number">6</span> Selección de genes diferencialmente expresados {# chapDEG}</a>
<ul>
<li><a href="6-1-introducción-1.html#introducción-1"><span class="toc-section-number">6.1</span> Introducción</a></li>
<li><a href="6-2-selección-de-genes-diferencialmente-expresados.html#selección-de-genes-diferencialmente-expresados"><span class="toc-section-number">6.2</span> Selección de genes diferencialmente expresados</a>
<ul>
<li><a href="6-2-selección-de-genes-diferencialmente-expresados.html#medidas-naturales-para-comparar-dos-muestras"><span class="toc-section-number">6.2.1</span> Medidas <em>naturales</em> para comparar dos muestras</a></li>
<li><a href="6-2-selección-de-genes-diferencialmente-expresados.html#un-primer-ejemplo"><span class="toc-section-number">6.2.2</span> Un primer ejemplo</a></li>
<li><a href="6-2-selección-de-genes-diferencialmente-expresados.html#selección-de-genes-usando-tests-estadísticos"><span class="toc-section-number">6.2.3</span> Selección de genes usando tests estadísticos</a></li>
</ul></li>
<li><a href="6-3-significación-estadística-y-expresión-diferencial.html#significación-estadística-y-expresión-diferencial"><span class="toc-section-number">6.3</span> Significación estadística y expresión diferencial</a>
<ul>
<li><a href="6-3-significación-estadística-y-expresión-diferencial.html#volcano-plots"><span class="toc-section-number">6.3.1</span> “Volcano plots”</a></li>
<li><a href="6-3-significación-estadística-y-expresión-diferencial.html#potencia-y-tamaño-muestral"><span class="toc-section-number">6.3.2</span> Potencia y tamaño muestral</a></li>
</ul></li>
<li><a href="6-4-el-problema-de-la-múltiplicidad-de-tests-multiple-testing.html#el-problema-de-la-múltiplicidad-de-tests-multiple-testing"><span class="toc-section-number">6.4</span> El problema de la múltiplicidad de tests (“multiple testing”)</a></li>
<li><a href="6-5-modelos-lineales-para-la-selección-de-genes-limma.html#modelos-lineales-para-la-selección-de-genes-limma"><span class="toc-section-number">6.5</span> Modelos lineales para la selección de genes: <tt>limma </tt></a>
<ul>
<li><a href="6-5-modelos-lineales-para-la-selección-de-genes-limma.html#el-modelo-lineal-general"><span class="toc-section-number">6.5.1</span> El modelo lineal general</a></li>
<li><a href="6-5-modelos-lineales-para-la-selección-de-genes-limma.html#ejemplos-de-situaciones-modelizables-linealmente"><span class="toc-section-number">6.5.2</span> Ejemplos de situaciones <em>modelizables linealmente</em></a></li>
<li><a href="6-5-modelos-lineales-para-la-selección-de-genes-limma.html#ejemplo-2-comparación-de-tres-grupos"><span class="toc-section-number">6.5.3</span> Ejemplo 2: Comparación de tres grupos</a></li>
<li><a href="6-5-modelos-lineales-para-la-selección-de-genes-limma.html#estimación-e-inferencia-con-el-modelo-lineal"><span class="toc-section-number">6.5.4</span> Estimación e inferencia con el modelo lineal</a></li>
<li><a href="6-5-modelos-lineales-para-la-selección-de-genes-limma.html#modelos-lineales-para-microarrays"><span class="toc-section-number">6.5.5</span> Modelos lineales para Microarrays</a></li>
<li><a href="6-5-modelos-lineales-para-la-selección-de-genes-limma.html#implementación-y-ejemplos"><span class="toc-section-number">6.5.6</span> Implementación y ejemplos</a></li>
</ul></li>
</ul></li>
<li><a href="7-caso-estrógeno-selección-de-genes-diferencialmente-expresados-asociados-con-la-resistencia-a-estrógenos-.html#caso-estrógeno-selección-de-genes-diferencialmente-expresados-asociados-con-la-resistencia-a-estrógenos."><span class="toc-section-number">7</span> Caso “Estrógeno”: Selección de genes diferencialmente expresados asociados con la resistencia a estrógenos.</a>
<ul>
<li><a href="7-1-introducción-2.html#introducción-2"><span class="toc-section-number">7.1</span> Introducción</a></li>
<li><a href="7-2-el-estudio-estrógeno.html#el-estudio-estrógeno"><span class="toc-section-number">7.2</span> El estudio “Estrógeno”</a>
<ul>
<li><a href="7-2-el-estudio-estrógeno.html#directorios-y-opciones-de-trabajo"><span class="toc-section-number">7.2.1</span> Directorios y opciones de trabajo</a></li>
</ul></li>
<li><a href="7-3-obtención-y-lectura-de-los-datos.html#obtención-y-lectura-de-los-datos"><span class="toc-section-number">7.3</span> Obtención y lectura de los datos</a>
<ul>
<li><a href="7-3-obtención-y-lectura-de-los-datos.html#los-datos"><span class="toc-section-number">7.3.1</span> Los datos</a></li>
<li><a href="7-3-obtención-y-lectura-de-los-datos.html#lectura-de-los-datos"><span class="toc-section-number">7.3.2</span> Lectura de los datos</a></li>
</ul></li>
<li><a href="7-4-exploración-control-de-calidad-y-normalización.html#exploración-control-de-calidad-y-normalización"><span class="toc-section-number">7.4</span> Exploración, Control de Calidad y Normalización</a>
<ul>
<li><a href="7-4-exploración-control-de-calidad-y-normalización.html#exploración-y-visualización"><span class="toc-section-number">7.4.1</span> Exploración y visualización</a></li>
<li><a href="7-4-exploración-control-de-calidad-y-normalización.html#control-de-calidad"><span class="toc-section-number">7.4.2</span> Control de calidad</a></li>
<li><a href="7-4-exploración-control-de-calidad-y-normalización.html#normalizacion-y-filtraje"><span class="toc-section-number">7.4.3</span> Normalizacion y Filtraje</a></li>
</ul></li>
<li><a href="7-5-selección-de-genes-diferencialmente-expresados-1.html#selección-de-genes-diferencialmente-expresados-1"><span class="toc-section-number">7.5</span> Selección de genes diferencialmente expresados</a>
<ul>
<li><a href="7-5-selección-de-genes-diferencialmente-expresados-1.html#análisis-basado-en-modelos-lineales"><span class="toc-section-number">7.5.1</span> Análisis basado en modelos lineales</a></li>
<li><a href="7-5-selección-de-genes-diferencialmente-expresados-1.html#comparaciones-múltiples"><span class="toc-section-number">7.5.2</span> Comparaciones múltiples</a></li>
</ul></li>
</ul></li>
<li><a href="8-después-de-la-selección-análisis-de-listas-de-genes.html#después-de-la-selección-análisis-de-listas-de-genes"><span class="toc-section-number">8</span> Después de la selección: Análisis de listas de genes</a>
<ul>
<li><a href="8-1-introducción-3.html#introducción-3"><span class="toc-section-number">8.1</span> Introducción</a></li>
<li><a href="8-2-análisis-comparativo-de-listas-de-genes.html#análisis-comparativo-de-listas-de-genes"><span class="toc-section-number">8.2</span> Análisis comparativo de listas de genes</a>
<ul>
<li><a href="8-2-análisis-comparativo-de-listas-de-genes.html#ejemplo-comparación-de-listas-en-el-caso-celltypes"><span class="toc-section-number">8.2.1</span> Ejemplo: comparación de listas en el caso <tt>celltypes</tt></a></li>
</ul></li>
<li><a href="8-3-anotación-de-los-resultados.html#anotación-de-los-resultados"><span class="toc-section-number">8.3</span> Anotación de los resultados</a></li>
<li><a href="8-4-visualización-de-los-perfiles-de-expresión.html#visualización-de-los-perfiles-de-expresión"><span class="toc-section-number">8.4</span> Visualización de los perfiles de expresión</a></li>
<li><a href="8-5-análisis-de-significación-biológica.html#análisis-de-significación-biológica"><span class="toc-section-number">8.5</span> Análisis de significación biológica</a>
<ul>
<li><a href="8-5-análisis-de-significación-biológica.html#análisis-de-enriquecimiento"><span class="toc-section-number">8.5.1</span> Análisis de enriquecimiento <a name="GEA"></a></a></li>
<li><a href="8-5-análisis-de-significación-biológica.html#análisis-de-enriquecimiento-con-bioconductor"><span class="toc-section-number">8.5.2</span> Análisis de enriquecimiento con Bioconductor</a></li>
</ul></li>
</ul></li>
<li><a href="9-referencias.html#referencias"><span class="toc-section-number">9</span> Referencias</a></li>
</ul>
</div>
</div>
</div>
<div class="row">
<div class="col-sm-12">
<div id="significación-estadística-y-expresión-diferencial" class="section level2" number="6.3">
<h2><span class="header-section-number">6.3</span> Significación estadística y expresión diferencial</h2>
<p>Como hemos visto en la sección anterior dos medidas naturales para
la selección de genes son el promedio de “log-ratios,” o la
diferencia de promedios en el caso de muestras independientes, o el valor del estadístico de test (<span class="math inline">\(t\)</span>-test) de una o dos muestras según si se trata de
muestras apareadas o independientes respectivamente. Los primeros
estudios de microarrays eran muy costosos y se hacían con pocas o
incluso ninguna réplica por condición experimental. En estas
situaciones la única forma fiable de detectar una diferencia de
expresión era a traves del “log-ratio” o su diferencias.</p>
<p>Rápidamente se puso en evidencia que para poder obtener los genes
que estaban realmente diferencialmente expresados era preciso disponer
de un soporte estadístico que permitiera tener en cuenta la
variación aleatoria existente entre muestras.</p>
<p>En la práctica esto se reduce a afirmar que si, además de la
diferencia de expresión entre las condiciones experimentales, se
lleva a cabo un test estadístico dispondremos de una medida
objetiva, el p–valor que nos servirá para decidir qué genes se
declaran diferencialmente expresados, a saber, aquellos en los que el
p–valor del test sea inferior a un cierto umbral como 0.05 o 0.01.</p>
<p>Como es sabido, un test estadístico procede decidiendo rechazar la hipótesis nula si el
p–valor es más pequeño que el nivel de significación del test.</p>
<p>Siguiendo con el ejemplo anterior podemos ordenar los resultados de los tests en base a los p–valores:</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="6-3-significación-estadística-y-expresión-diferencial.html#cb27-1" aria-hidden="true" tabindex="-1"></a>ranked <span class="ot">&lt;-</span>teststat[<span class="fu">order</span>(teststat<span class="sc">$</span>p.value),]</span>
<span id="cb27-2"><a href="6-3-significación-estadística-y-expresión-diferencial.html#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(ranked[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>,])</span></code></pre></div>
<pre><code>##              statistic        dm      p.value
## 1449383_at   -48.61014 -2.044928 3.276616e-13
## 1451421_a_at -40.72173 -1.445182 1.909283e-12
## 1415929_at   -39.77036 -0.812879 2.415238e-12
## 1450826_a_at  37.62239  5.147992 4.193941e-12
## 1448303_at   -31.92365 -2.283765 2.140612e-11</code></pre>
<p>Ahora podríamos seleccionar, por ejemplo los genes cuyo p–valor fuera inferior a 0.01</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="6-3-significación-estadística-y-expresión-diferencial.html#cb29-1" aria-hidden="true" tabindex="-1"></a>selectedTeststat <span class="ot">&lt;-</span> ranked[ranked<span class="sc">$</span>p.value <span class="sc">&lt;</span> <span class="fl">0.01</span>,]</span></code></pre></div>
<p>Esto deja un total de <code>{r} dim(selectedTeststat)[1]</code> con un p–valor inferior a 0.01</p>
<div id="volcano-plots" class="section level3" number="6.3.1">
<h3><span class="header-section-number">6.3.1</span> “Volcano plots”</h3>
<p>Si se opta por computar los valores de significación (p–valores) de los genes,
resulta interesante comparar el tamaño del cambio del nivel de significación estadístico.
El “volcano plot” es una representación gráfica que permite ordenar los genes a lo largo de dos dimensiones, la biológica, representada por el “fold change” y la estadística representada por el logaritmo negativo del p–valor.</p>
<p>En la escala horizontal se representa el cambio entre los dos grupos (en escala logarítmica,
de manera que la regulación positiva o negativa se representa de forma simétrica). En la escala vertical se representa el p–valor del test en una escala logarítmica negativa,
de forma que los p–valores más pequeños aparecen mayores.</p>
<p>Así pues puede considerarse que el primer eje indica impacto biológico del cambio (a más efecto biológico mayor “fold-change”) y el segundo muestra la evidencia estadística, o la fiabilidad del cambio.</p>
<p>Como veremos más adelante en esta sección, el paquete <code>limma</code> permite realizar volcano-plots de forma sencilla a partir de los resultados de un anàlisis, pero para hacer un volcano plot tan sólo se necesita una lista de p-valores y los efectos (“fold-change”) asociados.</p>
<p>La figura <span class="citation">(<strong>ref?</strong>)</span>(fig:volcano0) muestra un “volcano-plot” para este ejemplo de los “celltypes” para la comparación “LPS” frente a “Medium.”</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="6-3-significación-estadística-y-expresión-diferencial.html#cb30-1" aria-hidden="true" tabindex="-1"></a>FC <span class="ot">&lt;-</span> teststat<span class="sc">$</span>statistic</span>
<span id="cb30-2"><a href="6-3-significación-estadística-y-expresión-diferencial.html#cb30-2" aria-hidden="true" tabindex="-1"></a>pVal<span class="ot">&lt;-</span>teststat<span class="sc">$</span>p.value</span>
<span id="cb30-3"><a href="6-3-significación-estadística-y-expresión-diferencial.html#cb30-3" aria-hidden="true" tabindex="-1"></a>Y <span class="ot">&lt;-</span> <span class="sc">-</span><span class="fu">log</span>(pVal)</span>
<span id="cb30-4"><a href="6-3-significación-estadística-y-expresión-diferencial.html#cb30-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(Y<span class="sc">~</span>FC)</span></code></pre></div>
<p><img src="Analisis_de_Datos_de_Microarrays_y_otras_Omicas_files/figure-html/volcano0-1.png" width="672" /></p>
<p>También podemos adaptar alguna función “ad-hoc” como la siguiente, tomada de :<a href=""></a></p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="6-3-significación-estadística-y-expresión-diferencial.html#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggrepel)</span>
<span id="cb31-2"><a href="6-3-significación-estadística-y-expresión-diferencial.html#cb31-2" aria-hidden="true" tabindex="-1"></a><span class="co"># plot adding up all layers we have seen so far</span></span>
<span id="cb31-3"><a href="6-3-significación-estadística-y-expresión-diferencial.html#cb31-3" aria-hidden="true" tabindex="-1"></a>volcanoP<span class="ot">&lt;-</span> <span class="cf">function</span> (de,log2FoldChange,  pvalue, </span>
<span id="cb31-4"><a href="6-3-significación-estadística-y-expresión-diferencial.html#cb31-4" aria-hidden="true" tabindex="-1"></a>                     <span class="at">diffexpressed=</span><span class="cn">NULL</span>, <span class="at">col=</span><span class="cn">NULL</span>, <span class="at">delabel=</span><span class="cn">NULL</span>){</span>
<span id="cb31-5"><a href="6-3-significación-estadística-y-expresión-diferencial.html#cb31-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="at">data=</span>de, <span class="fu">aes</span>(<span class="at">x=</span>log2FoldChange, <span class="at">y=</span><span class="sc">-</span><span class="fu">log10</span>(pvalue), <span class="at">col=</span>diffexpressed, <span class="at">label=</span>delabel)) <span class="sc">+</span></span>
<span id="cb31-6"><a href="6-3-significación-estadística-y-expresión-diferencial.html#cb31-6" aria-hidden="true" tabindex="-1"></a>        <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb31-7"><a href="6-3-significación-estadística-y-expresión-diferencial.html#cb31-7" aria-hidden="true" tabindex="-1"></a>        <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb31-8"><a href="6-3-significación-estadística-y-expresión-diferencial.html#cb31-8" aria-hidden="true" tabindex="-1"></a>        <span class="fu">geom_text_repel</span>() <span class="sc">+</span></span>
<span id="cb31-9"><a href="6-3-significación-estadística-y-expresión-diferencial.html#cb31-9" aria-hidden="true" tabindex="-1"></a>        <span class="fu">scale_color_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="st">&quot;blue&quot;</span>, <span class="st">&quot;black&quot;</span>, <span class="st">&quot;red&quot;</span>)) <span class="sc">+</span></span>
<span id="cb31-10"><a href="6-3-significación-estadística-y-expresión-diferencial.html#cb31-10" aria-hidden="true" tabindex="-1"></a>        <span class="fu">geom_vline</span>(<span class="at">xintercept=</span><span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.6</span>, <span class="fl">0.6</span>), <span class="at">col=</span><span class="st">&quot;red&quot;</span>) <span class="sc">+</span></span>
<span id="cb31-11"><a href="6-3-significación-estadística-y-expresión-diferencial.html#cb31-11" aria-hidden="true" tabindex="-1"></a>        <span class="fu">geom_hline</span>(<span class="at">yintercept=</span><span class="sc">-</span><span class="fu">log10</span>(<span class="fl">0.05</span>), <span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span>
<span id="cb31-12"><a href="6-3-significación-estadística-y-expresión-diferencial.html#cb31-12" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb31-13"><a href="6-3-significación-estadística-y-expresión-diferencial.html#cb31-13" aria-hidden="true" tabindex="-1"></a>diffexpressed <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(<span class="fu">abs</span>(teststat<span class="sc">$</span>statistic)<span class="sc">&gt;</span><span class="dv">10</span>, <span class="cn">TRUE</span>, <span class="cn">FALSE</span>)</span>
<span id="cb31-14"><a href="6-3-significación-estadística-y-expresión-diferencial.html#cb31-14" aria-hidden="true" tabindex="-1"></a>label <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="cn">NA</span>, <span class="fu">length</span>(diffexpressed))</span>
<span id="cb31-15"><a href="6-3-significación-estadística-y-expresión-diferencial.html#cb31-15" aria-hidden="true" tabindex="-1"></a>label[diffexpressed] <span class="ot">&lt;-</span> <span class="fu">rownames</span>(teststat)[diffexpressed]</span>
<span id="cb31-16"><a href="6-3-significación-estadística-y-expresión-diferencial.html#cb31-16" aria-hidden="true" tabindex="-1"></a><span class="fu">volcanoP</span> (<span class="at">de=</span>teststat, <span class="at">log2FoldChange=</span>teststat<span class="sc">$</span>statistic,  <span class="at">pvalue=</span>teststat<span class="sc">$</span>p.value,</span>
<span id="cb31-17"><a href="6-3-significación-estadística-y-expresión-diferencial.html#cb31-17" aria-hidden="true" tabindex="-1"></a>          <span class="at">diffexpressed =</span> diffexpressed, <span class="at">delabel =</span> label)</span></code></pre></div>
</div>
<div id="potencia-y-tamaño-muestral" class="section level3" number="6.3.2">
<h3><span class="header-section-number">6.3.2</span> Potencia y tamaño muestral</h3>
<p>Tal como se ha indicado más arriba, para realizar un  suele controlarse la probabilidad de error de tipo I (de
falsos positivos) y buscar, de entre los tests candidatos, aquellos
que tengan una menor probabilidad de error de tipo II, o
equivalentemente una mayor potencia. A partir de este planteamiento
existe, en el contexto estadístico estándar, multitud de formas de
determinar cual debe ser el tamaño muestral necesario para obtener
una potencia dada fijados el tamaño de efecto (“fold-change”) y la
probabilidad de error de tipo I.</p>
<p>En el caso de los microarrays se han desarrollado diversas fórmulas
para realizar cálculos de este tipo, pero la compleja estructura de
los datos microarrays hace que sean relativamente <em>discutibles</em>.</p>
<p>Simon (<span class="citation">Simon et al. (2003)</span>) sugiere la fórmula siguiente que es una
generalización de las fórmulas clásicas para problemas de dos
muestras:</p>
<p>El tamaño total requerido para detectar genes diferencialmente expresados en al menos una diferencia <span class="math inline">\(\delta\)</span> con una
probabilidad de error de tipo I (FP), <span class="math inline">\(\alpha\)</span> y una probabilidad de error de tipo II (FN) <span class="math inline">\(1-\beta\)</span> se calcula:
<span class="math display">\[
n=\frac{4(z_{\alpha/2}+z_\beta)^2}{(\delta/\sigma)^2},
\]</span>
donde <span class="math inline">\(z_\alpha\)</span> y <span class="math inline">\(z_\beta\)</span> son los percentiles 100<span class="math inline">\(\alpha/2\)</span> y 100<span class="math inline">\(\beta\)</span> de la distribución Normal <span class="math inline">\(N(0,1)\)</span> y <span class="math inline">\(\sigma\)</span> es la
desviación estandar de un gen dentro de una clase (de un grupo). Obviamente <em><span class="math inline">\(\sigma\)</span> es siempre desconocida</em> por lo que,
sin una muestra piloto con que estimarla el calculo e más imaginativo que realista.</p>
<p>Además de esto, el número de arrays usualmente recomendado queda
lejos de la cantidad asequible para la mayor parte de los experimentos
(<span class="citation">Lee and Whitmore (2002)</span>,<span class="citation">Tibshirani (2006)</span>). Lo que muchos usuarios hacen a la
práctica, es buscar un equilibrio entre los costes y la
reproducibilidad y, de hecho, tienden a usar una cantidad fija de
arrays tal como 3 o 5 sin consideraciones adicionales.</p>
<p>Por ejemplo si ponemos <span class="math inline">\(\alpha=0.001\)</span>, <span class="math inline">\(1-\beta=0.95\)</span>, <span class="math inline">\(\delta=1\)</span> y
estimamos <span class="math inline">\(\sigma\)</span> entre todas las muestras el número de réplicas
biológicas que necesitaremos será de 35.8.</p>
</div>
</div>
<p style="text-align: center;">
<a href="6-2-selección-de-genes-diferencialmente-expresados.html"><button class="btn btn-default">Previous</button></a>
<a href="6-4-el-problema-de-la-múltiplicidad-de-tests-multiple-testing.html"><button class="btn btn-default">Next</button></a>
</p>
</div>
</div>


</div>

<script>

// add bootstrap table styles to pandoc tables
$(document).ready(function () {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
});

</script>

</body>
</html>
