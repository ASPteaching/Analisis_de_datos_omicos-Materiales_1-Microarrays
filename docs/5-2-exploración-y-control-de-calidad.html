<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<meta property="og:title" content="5.2 Exploración y control de calidad | Analisis de datos omicos" />
<meta property="og:type" content="book" />





<meta name="author" content="Alex Sánchez-Pla^{1,2} y Ricardo Gonzalo Sanz^2" />
<meta name="author" content="^1 Departament de Genètica, Microbiologia i Estadística. Universitat de Barcelona (UB)." />
<meta name="author" content="^2 Unitat d’Estadística i Bioinformàtica. Vall d’Hebron Institut de Recerca (VHIR)." />


<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  TeX: { equationNumbers: { autoNumber: "AMS" } }
});
</script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<meta name="description" content="5.2 Exploración y control de calidad | Analisis de datos omicos">

<title>5.2 Exploración y control de calidad | Analisis de datos omicos</title>

<script src="libs/header-attrs-2.7/header-attrs.js"></script>
<script src="libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="libs/bootstrap-3.3.5/css/bootstrap.min.css" rel="stylesheet" />
<script src="libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="libs/navigation-1.1/tabsets.js"></script>


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>


<link rel="stylesheet" href="style.css" type="text/css" />

<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
  height: auto;
}
</style>
</head>

<body>

<div class="container-fluid main-container">


<div class="row">
<div class="col-sm-12">
<div id="TOC">
<ul>
<li><a href="index.html#presentación"><span class="toc-section-number">1</span> Presentación</a>
<ul>
<li><a href="1-1-instalación-de-paquetes-de-r-y-código-de-los-capítulos.html#instalación-de-paquetes-de-r-y-código-de-los-capítulos"><span class="toc-section-number">1.1</span> Instalación de paquetes de R y código de los capítulos</a></li>
</ul></li>
<li><a href="2-introduccion-a-los-microarrays-y-otras-tecnologías-omicas.html#introduccion-a-los-microarrays-y-otras-tecnologías-omicas"><span class="toc-section-number">2</span> Introduccion a los microarrays y otras tecnologías omicas</a>
<ul>
<li><a href="2-1-antecedentes-históricos.html#antecedentes-históricos"><span class="toc-section-number">2.1</span> Antecedentes históricos</a></li>
<li><a href="2-2-los-microarrays.html#los-microarrays"><span class="toc-section-number">2.2</span> Los microarrays</a>
<ul>
<li><a href="2-2-los-microarrays.html#aplicaciones-de-los-microarrays"><span class="toc-section-number">2.2.1</span> Aplicaciones de los microarrays</a></li>
</ul></li>
<li><a href="2-3-cómo-funcionan-los-microarrays.html#cómo-funcionan-los-microarrays"><span class="toc-section-number">2.3</span> Cómo funcionan los microarrays</a>
<ul>
<li><a href="2-3-cómo-funcionan-los-microarrays.html#microarrays-de-dos-colores"><span class="toc-section-number">2.3.1</span> Microarrays de dos colores</a></li>
<li><a href="2-3-cómo-funcionan-los-microarrays.html#microarrays-de-un-color"><span class="toc-section-number">2.3.2</span> Microarrays de un color</a></li>
<li><a href="2-3-cómo-funcionan-los-microarrays.html#realización-de-un-experimento-de-microarrays"><span class="toc-section-number">2.3.3</span> Realización de un experimento de microarrays</a></li>
<li><a href="2-3-cómo-funcionan-los-microarrays.html#como-se-mide-la-expresión"><span class="toc-section-number">2.3.4</span> Como se mide la expresión</a></li>
</ul></li>
<li><a href="2-4-bioinformática-de-microarrays.html#bioinformática-de-microarrays"><span class="toc-section-number">2.4</span> Bioinformática de Microarrays<a name="Bioinformática"></a></a>
<ul>
<li><a href="2-4-bioinformática-de-microarrays.html#software-para-el-análisis-de-datos-de-microarrays"><span class="toc-section-number">2.4.1</span> Software para el análisis de datos de microarrays</a></li>
<li><a href="2-4-bioinformática-de-microarrays.html#bases-de-datos-de-microarrays"><span class="toc-section-number">2.4.2</span> Bases de datos de Microarrays</a></li>
</ul></li>
<li><a href="2-5-extensiones-1-otros-tipos-de-microarrays.html#extensiones-1-otros-tipos-de-microarrays"><span class="toc-section-number">2.5</span> Extensiones (1): Otros tipos de microarrays<a name="extensions"></a></a>
<ul>
<li><a href="2-5-extensiones-1-otros-tipos-de-microarrays.html#otros-microarrays-de-adn"><span class="toc-section-number">2.5.1</span> Otros microarrays de ADN</a></li>
<li><a href="2-5-extensiones-1-otros-tipos-de-microarrays.html#otros-tipos-de-microarrays-proteínas-o-carbohidratos"><span class="toc-section-number">2.5.2</span> Otros tipos de microarrays: Proteínas o carbohidratos</a></li>
</ul></li>
<li><a href="2-6-extensiones-2-ngs-nextnow-generation-sequencing.html#extensiones-2-ngs-nextnow-generation-sequencing"><span class="toc-section-number">2.6</span> Extensiones (2): <em>NGS: Next(Now) Generation Sequencing</em></a>
<ul>
<li><a href="2-6-extensiones-2-ngs-nextnow-generation-sequencing.html#visión-global-de-las-tecnologías-de-secuenciación"><span class="toc-section-number">2.6.1</span> Visión global de las tecnologías de secuenciación</a></li>
<li><a href="2-6-extensiones-2-ngs-nextnow-generation-sequencing.html#de-la-secuenciación-sanger-a-la-ultrasecuenciación"><span class="toc-section-number">2.6.2</span> De la secuenciación Sanger a la ultrasecuenciación</a></li>
<li><a href="2-6-extensiones-2-ngs-nextnow-generation-sequencing.html#tecnologías-de-ultrasecuenciación"><span class="toc-section-number">2.6.3</span> Tecnologías de ultrasecuenciación</a></li>
</ul></li>
</ul></li>
<li><a href="3-MDAProcess.html#MDAProcess"><span class="toc-section-number">3</span> El proceso de análisis de microarrays</a>
<ul>
<li><a href="3-1-tipos-de-estudios.html#tipos-de-estudios"><span class="toc-section-number">3.1</span> Tipos de estudios</a>
<ul>
<li><a href="3-1-tipos-de-estudios.html#comparación-de-grupos-o-class-comparison"><span class="toc-section-number">3.1.1</span> Comparación de grupos o “Class comparison”</a></li>
<li><a href="3-1-tipos-de-estudios.html#predicción-de-clase-o-class-prediction"><span class="toc-section-number">3.1.2</span> Predicción de clase o “Class prediction”</a></li>
<li><a href="3-1-tipos-de-estudios.html#descubrimiento-de-clases-o-class-discovery"><span class="toc-section-number">3.1.3</span> Descubrimiento de clases o “Class discovery”</a></li>
<li><a href="3-1-tipos-de-estudios.html#otros-tipos-de-estudios"><span class="toc-section-number">3.1.4</span> Otros tipos de estudios</a></li>
</ul></li>
<li><a href="3-2-c4examples.html#c4examples"><span class="toc-section-number">3.2</span> Algunos ejemplos concretos</a>
<ul>
<li><a href="3-2-c4examples.html#celltypes"><span class="toc-section-number">3.2.1</span> Estudio de procesos regulados por citoquinas</a></li>
<li><a href="3-2-c4examples.html#golub"><span class="toc-section-number">3.2.2</span> Clasificación molecular de la leucemia</a></li>
<li><a href="3-2-c4examples.html#efecto-del-estrogeno-y-el-tiempo-de-administración-estrogen"><span class="toc-section-number">3.2.3</span> Efecto del estrogeno y el tiempo de administración {#estrogen]</a></li>
<li><a href="3-2-c4examples.html#CCL4"><span class="toc-section-number">3.2.4</span> Efecto del CCL4 en la expresión génica</a></li>
<li><a href="3-2-c4examples.html#yeast"><span class="toc-section-number">3.2.5</span> Análisis de patrones en el ciclo celular</a></li>
<li><a href="3-2-c4examples.html#recapitulación"><span class="toc-section-number">3.2.6</span> Recapitulación</a></li>
</ul></li>
<li><a href="3-3-el-proceso-de-análisis-de-microarrays.html#el-proceso-de-análisis-de-microarrays"><span class="toc-section-number">3.3</span> El proceso de análisis de microarrays</a></li>
</ul></li>
<li><a href="4-MDAExpDesign.html#MDAExpDesign"><span class="toc-section-number">4</span> Diseño de experimentos de microarrays</a>
<ul>
<li><a href="4-1-fuentes-de-variabilidad.html#fuentes-de-variabilidad"><span class="toc-section-number">4.1</span> Fuentes de variabilidad</a></li>
<li><a href="4-2-tipos-de-variabilidad.html#tipos-de-variabilidad"><span class="toc-section-number">4.2</span> Tipos de variabilidad</a></li>
<li><a href="4-3-conceptos-básicos-de-diseño-de-experimentos.html#conceptos-básicos-de-diseño-de-experimentos"><span class="toc-section-number">4.3</span> Conceptos básicos de diseño de Experimentos</a></li>
<li><a href="4-4-principios-de-diseño-de-experimentos.html#principios-de-diseño-de-experimentos"><span class="toc-section-number">4.4</span> Principios de diseño de experimentos</a>
<ul>
<li><a href="4-4-principios-de-diseño-de-experimentos.html#replicación"><span class="toc-section-number">4.4.1</span> Replicación</a></li>
<li><a href="4-4-principios-de-diseño-de-experimentos.html#aleatorización"><span class="toc-section-number">4.4.2</span> Aleatorización</a></li>
<li><a href="4-4-principios-de-diseño-de-experimentos.html#bloqueo-o-control-local"><span class="toc-section-number">4.4.3</span> Bloqueo o control local</a></li>
</ul></li>
<li><a href="4-5-diseños-experimentales-para-microarrays-de-dos-colores.html#diseños-experimentales-para-microarrays-de-dos-colores"><span class="toc-section-number">4.5</span> Diseños experimentales para microarrays de dos colores</a></li>
</ul></li>
<li><a href="5-exploración-de-los-datos-control-de-calidad-y-preprocesado.html#exploración-de-los-datos-control-de-calidad-y-preprocesado"><span class="toc-section-number">5</span> Exploración de los datos, control de calidad y preprocesado</a>
<ul>
<li><a href="5-1-introducción.html#introducción"><span class="toc-section-number">5.1</span> Introducción</a>
<ul>
<li><a href="5-1-introducción.html#nivel-de-análisis-y-tipo-de-microarray"><span class="toc-section-number">5.1.1</span> Nivel de análisis y tipo de microarray</a></li>
<li><a href="5-1-introducción.html#datos-de-partida"><span class="toc-section-number">5.1.2</span> Datos de partida</a></li>
</ul></li>
<li><a href="5-2-exploración-y-control-de-calidad.html#exploración-y-control-de-calidad"><span class="toc-section-number">5.2</span> Exploración y control de calidad</a>
<ul>
<li><a href="5-2-exploración-y-control-de-calidad.html#control-de-calidad-con-gráficos-estadísticos-generales"><span class="toc-section-number">5.2.1</span> Control de calidad con gráficos estadísticos generales</a></li>
<li><a href="5-2-exploración-y-control-de-calidad.html#gráficos-de-diagnóstico-para-microarrays-de-dos-colores"><span class="toc-section-number">5.2.2</span> Gráficos de diagnóstico para microarrays de dos colores</a></li>
<li><a href="5-2-exploración-y-control-de-calidad.html#gráficos-de-diagnóstico-para-microarrays-de-un-color"><span class="toc-section-number">5.2.3</span> Gráficos de diagnóstico para microarrays de un color</a></li>
</ul></li>
<li><a href="5-3-normalización-de-arrays-de-dos-colores.html#normalización-de-arrays-de-dos-colores"><span class="toc-section-number">5.3</span> Normalización de arrays de dos colores</a>
<ul>
<li><a href="5-3-normalización-de-arrays-de-dos-colores.html#normalización-global"><span class="toc-section-number">5.3.1</span> Normalización global</a></li>
<li><a href="5-3-normalización-de-arrays-de-dos-colores.html#normalización-dependiente-de-la-intensidad"><span class="toc-section-number">5.3.2</span> Normalización dependiente de la intensidad</a></li>
</ul></li>
<li><a href="5-4-resumen-y-normalización-de-microarrays-de-affymetrix.html#resumen-y-normalización-de-microarrays-de-affymetrix"><span class="toc-section-number">5.4</span> Resumen y normalización de microarrays de Affymetrix</a>
<ul>
<li><a href="5-4-resumen-y-normalización-de-microarrays-de-affymetrix.html#métodos-originales-de-affymetrix"><span class="toc-section-number">5.4.1</span> Métodos originales de Affymetrix</a></li>
<li><a href="5-4-resumen-y-normalización-de-microarrays-de-affymetrix.html#el-método-rma-robust-multi-array-average"><span class="toc-section-number">5.4.2</span> El método RMA (Robust Multi-Array Average)</a></li>
</ul></li>
<li><a href="5-5-filtraje-no-específico.html#filtraje-no-específico"><span class="toc-section-number">5.5</span> Filtraje no específico</a></li>
</ul></li>
<li><a href="6-selección-de-genes-diferencialmente-expresados-chapdeg.html#selección-de-genes-diferencialmente-expresados-chapdeg"><span class="toc-section-number">6</span> Selección de genes diferencialmente expresados {# chapDEG}</a>
<ul>
<li><a href="6-1-introducción-1.html#introducción-1"><span class="toc-section-number">6.1</span> Introducción</a></li>
<li><a href="6-2-selección-de-genes-diferencialmente-expresados.html#selección-de-genes-diferencialmente-expresados"><span class="toc-section-number">6.2</span> Selección de genes diferencialmente expresados</a>
<ul>
<li><a href="6-2-selección-de-genes-diferencialmente-expresados.html#medidas-naturales-para-comparar-dos-muestras"><span class="toc-section-number">6.2.1</span> Medidas <em>naturales</em> para comparar dos muestras</a></li>
<li><a href="6-2-selección-de-genes-diferencialmente-expresados.html#un-primer-ejemplo"><span class="toc-section-number">6.2.2</span> Un primer ejemplo</a></li>
<li><a href="6-2-selección-de-genes-diferencialmente-expresados.html#selección-de-genes-usando-tests-estadísticos"><span class="toc-section-number">6.2.3</span> Selección de genes usando tests estadísticos</a></li>
</ul></li>
<li><a href="6-3-significación-estadística-y-expresión-diferencial.html#significación-estadística-y-expresión-diferencial"><span class="toc-section-number">6.3</span> Significación estadística y expresión diferencial</a>
<ul>
<li><a href="6-3-significación-estadística-y-expresión-diferencial.html#volcano-plots"><span class="toc-section-number">6.3.1</span> “Volcano plots”</a></li>
<li><a href="6-3-significación-estadística-y-expresión-diferencial.html#potencia-y-tamaño-muestral"><span class="toc-section-number">6.3.2</span> Potencia y tamaño muestral</a></li>
</ul></li>
<li><a href="6-4-el-problema-de-la-múltiplicidad-de-tests-multiple-testing.html#el-problema-de-la-múltiplicidad-de-tests-multiple-testing"><span class="toc-section-number">6.4</span> El problema de la múltiplicidad de tests (“multiple testing”)</a></li>
<li><a href="6-5-modelos-lineales-para-la-selección-de-genes-limma.html#modelos-lineales-para-la-selección-de-genes-limma"><span class="toc-section-number">6.5</span> Modelos lineales para la selección de genes: <tt>limma </tt></a>
<ul>
<li><a href="6-5-modelos-lineales-para-la-selección-de-genes-limma.html#el-modelo-lineal-general"><span class="toc-section-number">6.5.1</span> El modelo lineal general</a></li>
<li><a href="6-5-modelos-lineales-para-la-selección-de-genes-limma.html#ejemplos-de-situaciones-modelizables-linealmente"><span class="toc-section-number">6.5.2</span> Ejemplos de situaciones <em>modelizables linealmente</em></a></li>
<li><a href="6-5-modelos-lineales-para-la-selección-de-genes-limma.html#ejemplo-2-comparación-de-tres-grupos"><span class="toc-section-number">6.5.3</span> Ejemplo 2: Comparación de tres grupos</a></li>
<li><a href="6-5-modelos-lineales-para-la-selección-de-genes-limma.html#estimación-e-inferencia-con-el-modelo-lineal"><span class="toc-section-number">6.5.4</span> Estimación e inferencia con el modelo lineal</a></li>
<li><a href="6-5-modelos-lineales-para-la-selección-de-genes-limma.html#modelos-lineales-para-microarrays"><span class="toc-section-number">6.5.5</span> Modelos lineales para Microarrays</a></li>
<li><a href="6-5-modelos-lineales-para-la-selección-de-genes-limma.html#implementación-y-ejemplos"><span class="toc-section-number">6.5.6</span> Implementación y ejemplos</a></li>
</ul></li>
</ul></li>
<li><a href="7-caso-estrógeno-selección-de-genes-diferencialmente-expresados-asociados-con-la-resistencia-a-estrógenos-.html#caso-estrógeno-selección-de-genes-diferencialmente-expresados-asociados-con-la-resistencia-a-estrógenos."><span class="toc-section-number">7</span> Caso “Estrógeno”: Selección de genes diferencialmente expresados asociados con la resistencia a estrógenos.</a>
<ul>
<li><a href="7-1-introducción-2.html#introducción-2"><span class="toc-section-number">7.1</span> Introducción</a></li>
<li><a href="7-2-el-estudio-estrógeno.html#el-estudio-estrógeno"><span class="toc-section-number">7.2</span> El estudio “Estrógeno”</a>
<ul>
<li><a href="7-2-el-estudio-estrógeno.html#directorios-y-opciones-de-trabajo"><span class="toc-section-number">7.2.1</span> Directorios y opciones de trabajo</a></li>
</ul></li>
<li><a href="7-3-obtención-y-lectura-de-los-datos.html#obtención-y-lectura-de-los-datos"><span class="toc-section-number">7.3</span> Obtención y lectura de los datos</a>
<ul>
<li><a href="7-3-obtención-y-lectura-de-los-datos.html#los-datos"><span class="toc-section-number">7.3.1</span> Los datos</a></li>
<li><a href="7-3-obtención-y-lectura-de-los-datos.html#lectura-de-los-datos"><span class="toc-section-number">7.3.2</span> Lectura de los datos</a></li>
</ul></li>
<li><a href="7-4-exploración-control-de-calidad-y-normalización.html#exploración-control-de-calidad-y-normalización"><span class="toc-section-number">7.4</span> Exploración, Control de Calidad y Normalización</a>
<ul>
<li><a href="7-4-exploración-control-de-calidad-y-normalización.html#exploración-y-visualización"><span class="toc-section-number">7.4.1</span> Exploración y visualización</a></li>
<li><a href="7-4-exploración-control-de-calidad-y-normalización.html#control-de-calidad"><span class="toc-section-number">7.4.2</span> Control de calidad</a></li>
<li><a href="7-4-exploración-control-de-calidad-y-normalización.html#normalizacion-y-filtraje"><span class="toc-section-number">7.4.3</span> Normalizacion y Filtraje</a></li>
</ul></li>
<li><a href="7-5-selección-de-genes-diferencialmente-expresados-1.html#selección-de-genes-diferencialmente-expresados-1"><span class="toc-section-number">7.5</span> Selección de genes diferencialmente expresados</a>
<ul>
<li><a href="7-5-selección-de-genes-diferencialmente-expresados-1.html#análisis-basado-en-modelos-lineales"><span class="toc-section-number">7.5.1</span> Análisis basado en modelos lineales</a></li>
<li><a href="7-5-selección-de-genes-diferencialmente-expresados-1.html#comparaciones-múltiples"><span class="toc-section-number">7.5.2</span> Comparaciones múltiples</a></li>
</ul></li>
</ul></li>
<li><a href="8-después-de-la-selección-análisis-de-listas-de-genes.html#después-de-la-selección-análisis-de-listas-de-genes"><span class="toc-section-number">8</span> Después de la selección: Análisis de listas de genes</a>
<ul>
<li><a href="8-1-introducción-3.html#introducción-3"><span class="toc-section-number">8.1</span> Introducción</a></li>
<li><a href="8-2-análisis-comparativo-de-listas-de-genes.html#análisis-comparativo-de-listas-de-genes"><span class="toc-section-number">8.2</span> Análisis comparativo de listas de genes</a>
<ul>
<li><a href="8-2-análisis-comparativo-de-listas-de-genes.html#ejemplo-comparación-de-listas-en-el-caso-celltypes"><span class="toc-section-number">8.2.1</span> Ejemplo: comparación de listas en el caso <tt>celltypes</tt></a></li>
</ul></li>
<li><a href="8-3-anotación-de-los-resultados.html#anotación-de-los-resultados"><span class="toc-section-number">8.3</span> Anotación de los resultados</a></li>
<li><a href="8-4-visualización-de-los-perfiles-de-expresión.html#visualización-de-los-perfiles-de-expresión"><span class="toc-section-number">8.4</span> Visualización de los perfiles de expresión</a></li>
<li><a href="8-5-análisis-de-significación-biológica.html#análisis-de-significación-biológica"><span class="toc-section-number">8.5</span> Análisis de significación biológica</a>
<ul>
<li><a href="8-5-análisis-de-significación-biológica.html#análisis-de-enriquecimiento"><span class="toc-section-number">8.5.1</span> Análisis de enriquecimiento <a name="GEA"></a></a></li>
<li><a href="8-5-análisis-de-significación-biológica.html#análisis-de-enriquecimiento-con-bioconductor"><span class="toc-section-number">8.5.2</span> Análisis de enriquecimiento con Bioconductor</a></li>
</ul></li>
</ul></li>
<li><a href="9-referencias.html#referencias"><span class="toc-section-number">9</span> Referencias</a></li>
</ul>
</div>
</div>
</div>
<div class="row">
<div class="col-sm-12">
<div id="exploración-y-control-de-calidad" class="section level2" number="5.2">
<h2><span class="header-section-number">5.2</span> Exploración y control de calidad</h2>
<p>Los gráficos son útiles para comprobar la calidad de los datos de microarrays,
obtener información sobre cómo se deben preprocesar los datos y comprobar, finalmente, que el preprocesado se haya realizado correctamente.</p>
<p>Siguiendo el esquema presentado en la tabla @ref{tab:tablaDiagnosticos} se presentan a continuación los distintos gráficos utilizados con una breve descripción de lo que representa cada uno y como interpretarlos adecuadamente. El código para generarlos se presenta al final del capítulo como un apéndice.</p>
<div id="control-de-calidad-con-gráficos-estadísticos-generales" class="section level3" number="5.2.1">
<h3><span class="header-section-number">5.2.1</span> Control de calidad con gráficos estadísticos generales</h3>
<div id="histogramas-y-gráficos-de-densidad" class="section level4" number="5.2.1.1">
<h4><span class="header-section-number">5.2.1.1</span> Histogramas y gráficos de densidad</h4>
<p>Estos gráficos permite hacerse una idea de si las distribuciones de los distintos arrays son similares en forma y posición. La figura <a href="#fig:plotAffyHist"><strong>??</strong></a> muestra los histogramas correspondientes a los 9 arrays del conjunto de datos .</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="5-2-exploración-y-control-de-calidad.html#cb14-1" aria-hidden="true" tabindex="-1"></a>affySampleNames <span class="ot">&lt;-</span> <span class="fu">rownames</span>(<span class="fu">pData</span>(allAffyRaw))</span>
<span id="cb14-2"><a href="5-2-exploración-y-control-de-calidad.html#cb14-2" aria-hidden="true" tabindex="-1"></a>affyColores <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">4</span>,<span class="dv">8</span>,<span class="dv">8</span>)</span>
<span id="cb14-3"><a href="5-2-exploración-y-control-de-calidad.html#cb14-3" aria-hidden="true" tabindex="-1"></a>affyLineas <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">3</span>)</span>
<span id="cb14-4"><a href="5-2-exploración-y-control-de-calidad.html#cb14-4" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(allAffyRaw, <span class="at">main=</span><span class="st">&quot;Signal distribution&quot;</span>, <span class="at">col=</span>affyColores, <span class="at">lty=</span>affyLineas)</span>
<span id="cb14-5"><a href="5-2-exploración-y-control-de-calidad.html#cb14-5" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span> (<span class="at">x=</span><span class="st">&quot;topright&quot;</span>, <span class="at">legend=</span>affySampleNames , <span class="at">col=</span>affyColores, <span class="at">lty=</span>affyLineas, <span class="at">cex=</span><span class="fl">0.7</span>)</span></code></pre></div>
<p><img src="Analisis_de_Datos_de_Microarrays_y_otras_Omicas_files/figure-html/plotAffyHist-1.png" width="672" /></p>
</div>
<div id="diagramas-de-caja-o-boxplots" class="section level4" number="5.2.1.2">
<h4><span class="header-section-number">5.2.1.2</span> Diagramas de caja o “boxplots”</h4>
<p>Como los histogramas los diagramas de caja –basados en los distintos cuantiles de las valores– dan una idea de la distribución de las intensidades. La figura <a href="#fig:plotAffyBoxplot"><strong>??</strong></a> muestra los diagramas de caja correspondientes a los 9 arrays del conjunto de datos .</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="5-2-exploración-y-control-de-calidad.html#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(allAffyRaw, <span class="at">main=</span><span class="st">&quot;Signal distribution&quot;</span>, <span class="at">col=</span>affyColores, <span class="at">las=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="Analisis_de_Datos_de_Microarrays_y_otras_Omicas_files/figure-html/plotAffyBoxplot-1.png" width="672" /></p>
</div>
<div id="gráficos-de-componentes-principales" class="section level4" number="5.2.1.3">
<h4><span class="header-section-number">5.2.1.3</span> Gráficos de componentes principales</h4>
<p>El análisis de componentes principales puede servir para detectar si las muestras se agrupan de forma “natural” es decir con otras muestras provenientes del mismo grupo o si no hay correspondencia clara entre grupos experimentales y proximidad en este gráfico. Cuando esto sucede no significa necesariamente que haya un problema pero puede ser indicativo de efectos técnicos -como el conocido efecto “batch”- que podría ser necesario corregir.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="5-2-exploración-y-control-de-calidad.html#cb16-1" aria-hidden="true" tabindex="-1"></a>plotPCA <span class="ot">&lt;-</span> <span class="cf">function</span> ( X, <span class="at">labels=</span><span class="cn">NULL</span>, <span class="at">colors=</span><span class="cn">NULL</span>, <span class="at">dataDesc=</span><span class="st">&quot;&quot;</span>, <span class="at">scale=</span><span class="cn">FALSE</span>)</span>
<span id="cb16-2"><a href="5-2-exploración-y-control-de-calidad.html#cb16-2" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb16-3"><a href="5-2-exploración-y-control-de-calidad.html#cb16-3" aria-hidden="true" tabindex="-1"></a>  pcX<span class="ot">&lt;-</span><span class="fu">prcomp</span>(<span class="fu">t</span>(X), <span class="at">scale=</span>scale) <span class="co"># o prcomp(t(X))</span></span>
<span id="cb16-4"><a href="5-2-exploración-y-control-de-calidad.html#cb16-4" aria-hidden="true" tabindex="-1"></a>  loads<span class="ot">&lt;-</span> <span class="fu">round</span>(pcX<span class="sc">$</span>sdev<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="fu">sum</span>(pcX<span class="sc">$</span>sdev<span class="sc">^</span><span class="dv">2</span>)<span class="sc">*</span><span class="dv">100</span>,<span class="dv">1</span>)</span>
<span id="cb16-5"><a href="5-2-exploración-y-control-de-calidad.html#cb16-5" aria-hidden="true" tabindex="-1"></a>  xlab<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="fu">paste</span>(<span class="st">&quot;PC1&quot;</span>,loads[<span class="dv">1</span>],<span class="st">&quot;%&quot;</span>))</span>
<span id="cb16-6"><a href="5-2-exploración-y-control-de-calidad.html#cb16-6" aria-hidden="true" tabindex="-1"></a>  ylab<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="fu">paste</span>(<span class="st">&quot;PC2&quot;</span>,loads[<span class="dv">2</span>],<span class="st">&quot;%&quot;</span>))</span>
<span id="cb16-7"><a href="5-2-exploración-y-control-de-calidad.html#cb16-7" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">is.null</span>(colors)) colors<span class="ot">=</span><span class="dv">1</span></span>
<span id="cb16-8"><a href="5-2-exploración-y-control-de-calidad.html#cb16-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(pcX<span class="sc">$</span>x[,<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>],<span class="at">xlab=</span>xlab,<span class="at">ylab=</span>ylab, <span class="at">col=</span>colors, </span>
<span id="cb16-9"><a href="5-2-exploración-y-control-de-calidad.html#cb16-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">xlim=</span><span class="fu">c</span>(<span class="fu">min</span>(pcX<span class="sc">$</span>x[,<span class="dv">1</span>])<span class="sc">-</span><span class="dv">10</span>, <span class="fu">max</span>(pcX<span class="sc">$</span>x[,<span class="dv">1</span>])<span class="sc">+</span><span class="dv">10</span>),</span>
<span id="cb16-10"><a href="5-2-exploración-y-control-de-calidad.html#cb16-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">ylim=</span><span class="fu">c</span>(<span class="fu">min</span>(pcX<span class="sc">$</span>x[,<span class="dv">2</span>])<span class="sc">-</span><span class="dv">10</span>, <span class="fu">max</span>(pcX<span class="sc">$</span>x[,<span class="dv">2</span>])<span class="sc">+</span><span class="dv">10</span>),</span>
<span id="cb16-11"><a href="5-2-exploración-y-control-de-calidad.html#cb16-11" aria-hidden="true" tabindex="-1"></a>       )</span>
<span id="cb16-12"><a href="5-2-exploración-y-control-de-calidad.html#cb16-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">text</span>(pcX<span class="sc">$</span>x[,<span class="dv">1</span>],pcX<span class="sc">$</span>x[,<span class="dv">2</span>], labels, <span class="at">pos=</span><span class="dv">3</span>, <span class="at">cex=</span><span class="fl">0.8</span>)</span>
<span id="cb16-13"><a href="5-2-exploración-y-control-de-calidad.html#cb16-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">title</span>(<span class="fu">paste</span>(<span class="st">&quot;Plot of first 2 PCs for expressions in&quot;</span>, dataDesc, <span class="at">sep=</span><span class="st">&quot; &quot;</span>), <span class="at">cex=</span><span class="fl">0.8</span>)</span>
<span id="cb16-14"><a href="5-2-exploración-y-control-de-calidad.html#cb16-14" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="5-2-exploración-y-control-de-calidad.html#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">file.exists</span>(<span class="st">&quot;datos/affyNorm&quot;</span>)){</span>
<span id="cb17-2"><a href="5-2-exploración-y-control-de-calidad.html#cb17-2" aria-hidden="true" tabindex="-1"></a>  allAffyNorm<span class="ot">&lt;-</span> <span class="fu">rma</span>(allAffyRaw)</span>
<span id="cb17-3"><a href="5-2-exploración-y-control-de-calidad.html#cb17-3" aria-hidden="true" tabindex="-1"></a>  affyNorm <span class="ot">&lt;-</span> <span class="fu">rma</span>(affyRaw)</span>
<span id="cb17-4"><a href="5-2-exploración-y-control-de-calidad.html#cb17-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">save</span>(allAffyNorm, affyNorm, <span class="at">file=</span><span class="st">&quot;datos/affyNorm.Rda&quot;</span>)</span>
<span id="cb17-5"><a href="5-2-exploración-y-control-de-calidad.html#cb17-5" aria-hidden="true" tabindex="-1"></a>}<span class="cf">else</span>{</span>
<span id="cb17-6"><a href="5-2-exploración-y-control-de-calidad.html#cb17-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">load</span>(<span class="at">file=</span><span class="st">&quot;datos/affyNorm.Rda&quot;</span>)</span>
<span id="cb17-7"><a href="5-2-exploración-y-control-de-calidad.html#cb17-7" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>La figura <a href="#fig:plotPCA2D"><strong>??</strong></a> muestra dos diagramas de compnentes principales realizados a partir de los datos normalizados del conjunto de datos . El gráfico de la parte superior que incluye el array defectuoso ilustra que la principal fuente de variabilidad es la diferencia de este array con el resto. Cuando se repite el análisis omitiendo esta muestra puede verse como la principal fuente de variación (eje X) se asocia con el tiempo de exposición (alto a la derecha, bajo (10h) a la izquierda, mientras que la segunda fuente de variación se asocia con la exposición a los estrógenos (alto arriba, bajo abajo).</p>
<p>El gráfico de la parte inferior en el que este array se ha eliminado antes de calcular las componentes principales muestra dos agrupaciones claras de arrays “derecha e izquierda” y “arriba y abajo” de la figura. El hecho de que los grupos no se correspondan con los tratamientos sugiere que puede haber alguna fuente adicional de variación que ha de tenerse en cuenta.</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="5-2-exploración-y-control-de-calidad.html#cb18-1" aria-hidden="true" tabindex="-1"></a>opt <span class="ot">&lt;-</span> <span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">1</span>))</span>
<span id="cb18-2"><a href="5-2-exploración-y-control-de-calidad.html#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plotPCA</span>(<span class="fu">exprs</span>(allAffyNorm), <span class="at">labels=</span>affySampleNames, <span class="at">dataDesc=</span><span class="st">&quot;PCA for all arrays</span><span class="sc">\n</span><span class="st">includes defective sample&quot;</span>)</span>
<span id="cb18-3"><a href="5-2-exploración-y-control-de-calidad.html#cb18-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plotPCA</span>(<span class="fu">exprs</span>(affyNorm), <span class="at">labels=</span><span class="fu">colnames</span>(<span class="fu">exprs</span>(affyNorm)), <span class="at">dataDesc=</span><span class="st">&quot;PCA for all arrays&quot;</span>)</span></code></pre></div>
<p><img src="Analisis_de_Datos_de_Microarrays_y_otras_Omicas_files/figure-html/plotPCA2D-1.png" width="672" /></p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="5-2-exploración-y-control-de-calidad.html#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(opt)</span></code></pre></div>
</div>
<div id="imagen-del-chip" class="section level4" number="5.2.1.4">
<h4><span class="header-section-number">5.2.1.4</span> Imagen del chip</h4>
<p>Otra forma de ver si las muestras se agrupan según los grupos experimentales, o mediante otros criterios es usando un cluster jerárquico que realiza una agrupación básica de las muestras por grado de similaridad según la distancia que se utilice.</p>
<p>Como en el caso de las componentes principales si las muestras se agrupan según las condiciones experimentales es una buena señal pero si no es así puede deberse a la presencia de otra fuente de variación o bien al hecho de que se trata de un gráfico basado en todo los datos y las condiciones experimentales pueden haber afectado un pequeño número de genes.</p>
<p>La figura <a href="5-2-exploración-y-control-de-calidad.html#fig:plotDendro">5.1</a> muestra como se agrupan los datos del conjunto  en base a un cluster jerárquico. Como en el caso de las componentes principales tras eliminar el array defectuoso las muestras se separan, primero por el tiempo de exposición y luego por niveles de estrógeno suministrado.</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="5-2-exploración-y-control-de-calidad.html#cb20-1" aria-hidden="true" tabindex="-1"></a>clust.euclid.average <span class="ot">&lt;-</span> <span class="fu">hclust</span>(<span class="fu">dist</span>(<span class="fu">t</span>(<span class="fu">exprs</span>(affyNorm))),<span class="at">method=</span><span class="st">&quot;average&quot;</span>)</span>
<span id="cb20-2"><a href="5-2-exploración-y-control-de-calidad.html#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(clust.euclid.average, <span class="at">labels=</span><span class="fu">colnames</span>(<span class="fu">exprs</span>(affyNorm)), <span class="at">main=</span><span class="st">&quot;Hierarchical clustering of samples&quot;</span>,  <span class="at">hang=</span><span class="sc">-</span><span class="dv">1</span>, <span class="at">cex=</span><span class="fl">0.7</span>)</span></code></pre></div>
<div class="figure"><span id="fig:plotDendro"></span>
<img src="Analisis_de_Datos_de_Microarrays_y_otras_Omicas_files/figure-html/plotDendro-1.png" alt="Un cluster jerárquico sirve para determinar si las muestras se agrupan de forma natural según los grupos experimentales o si lo hacen de otra forma" width="672" />
<p class="caption">
Figure 5.1: Un cluster jerárquico sirve para determinar si las muestras se agrupan de forma natural según los grupos experimentales o si lo hacen de otra forma
</p>
</div>
</div>
</div>
<div id="gráficos-de-diagnóstico-para-microarrays-de-dos-colores" class="section level3" number="5.2.2">
<h3><span class="header-section-number">5.2.2</span> Gráficos de diagnóstico para microarrays de dos colores</h3>
<p>El diagnóstico de arrays de dos canales se basa principalmente
en la imagen y en diferentes tipos de gráficos.</p>
<div id="diagramas-de-dispersión-y-ma-plots" class="section level4" number="5.2.2.1">
<h4><span class="header-section-number">5.2.2.1</span> Diagramas de dispersión y “MA-plots”</h4>
<p>La normalización discutida en este mismo capítulo es un punto
clave en el proceso de análisis de microarrays y se ha dedicado un
gran esfuerzo a desarrollar y probar diferentes métodos
(<span class="citation">Quackenbush (2002)</span>,<span class="citation">Yang et al. (2002)</span>). Una razón para ello es que
hay diferentes artefactos técnicos que deben ser corregidos para
poder ser utilizados, y no cualquier método puede funcionar con
todos ellos.</p>
<p>En general, los métodos de normalización se basan en el siguiente
principio: .</p>
<p>Esto da una idea de como debería ser un gráfico de
intensidades. Por ejemplo, si no hubiese artefactos técnicos, en
arrays de dos canales, una gráfica de dispersión de intensidad del
rojo frente al verde debería dejar la mayor parte de los puntos
alrededor de una diagonal. Cualquier desviación de esta situación
debería ser atribuible a razones técnicas, no biológicas, y por
tanto, debería ser eliminada. Esto ha conducido a un método de
normalización muy popular consistente en estimar la transformación
a aplicar, como una función de las intensidades utilizando el
método  en la representación transformada de la
gráfica de dispersión conocida como el .</p>
<p>La figura <a href="5-2-exploración-y-control-de-calidad.html#fig:c05normScatterMA">5.2</a> muestra, en su parte izquierda (a) un gráfico de dispersión del canal
rojo frente al verde en un array de dos colores. El hecho de que los
datos no estén centrados alrededor de la diagonal sugiere la necesidad de
normalización.</p>
<p>Una representación muy popular que ayuda a visualizar mejor esta
asimetría es lo que se conoce como “” que aparece en la parte derecha (b) de la figura<a href="5-2-exploración-y-control-de-calidad.html#fig:c05normScatterMA">5.2</a>. Geométricamente representa una rotación del gráfico de dispersión, en la que el significado de los nuevos ejes es:</p>
<ul>
<li><span class="math inline">\(A=\displaystyle \frac{1}{2}(\log_2 (R*G))\)</span>: El logaritmo de la
intensidad media de los dos canales,</li>
<li><span class="math inline">\(M=\log_2 \displaystyle \frac{R}{G}\)</span>: El logaritmo de la expresión relativa entre
ambos canales (normalmente conocido como “log–ratio”).</li>
</ul>
<div class="figure"><span id="fig:c05normScatterMA"></span>
<img src="figures/c05normScatterMA.png" alt="(a) Gráfico de  un canal frente al otro  (b) MA-plot (intensidad frente log-ratio)" width="1502" />
<p class="caption">
Figure 5.2: (a) Gráfico de un canal frente al otro (b) MA-plot (intensidad frente log-ratio)
</p>
</div>
</div>
<div id="imagen-del-array" class="section level4" number="5.2.2.2">
<h4><span class="header-section-number">5.2.2.2</span> Imagen del array</h4>
<p>La imagen del chip (véase la figura <a href="#c05signalNoise"><strong>??</strong></a>,
izquierda) ofrece una visión rápida de la calidad del array,
proporcionando información acerca del balance del color, la
uniformidad en la hibridación y en los , de si el
background es mayor del normal y dela existencia de artefactos como el
polvo o pequeñas marcas (rasguños).</p>
</div>
<div id="histogramas-de-señales-y-de-la-relación-señalruído" class="section level4" number="5.2.2.3">
<h4><span class="header-section-number">5.2.2.3</span> Histogramas de señales y de la relación señal–ruído</h4>
<p>Estos gráficos (véase la figura <a href="5-2-exploración-y-control-de-calidad.html#fig:c05signalNoise">5.3</a>, derecha) son útiles para detectar posibles anormalidades o un background excesivamente alto .</p>
<div class="figure"><span id="fig:c05signalNoise"></span>
<img src="figures/c05signalNoise.png" alt="La relación señal ruido sirve para detectar posibles anormalidades o un background excesivamente alto como medida de calidad" width="660" />
<p class="caption">
Figure 5.3: La relación señal ruido sirve para detectar posibles anormalidades o un background excesivamente alto como medida de calidad
</p>
</div>
</div>
<div id="boxplots" class="section level4" number="5.2.2.4">
<h4><span class="header-section-number">5.2.2.4</span> Boxplots</h4>
<p>Un gráfico muy utilizado es el diagrama de cajas o “boxplot”
múltiple con una caja por cada chip. Del alineamiento (o falta de
él) y la semejanza (o disparidad) entre las cajas, se deduce si hace
falta, o no, normalizar entre arrays.</p>
<p>En el caso de arrays de dos colores pueden utilizarse diagrams de
cajas “dentro de arrays” (entre distintos sectores del mismo chip) y
“entre arrays.”</p>
</div>
</div>
<div id="gráficos-de-diagnóstico-para-microarrays-de-un-color" class="section level3" number="5.2.3">
<h3><span class="header-section-number">5.2.3</span> Gráficos de diagnóstico para microarrays de un color</h3>
<div id="imagen-del-chip-1" class="section level4" number="5.2.3.1">
<h4><span class="header-section-number">5.2.3.1</span> Imagen del chip</h4>
<p>Los arrays de affymetrix contienen millones de sondas por lo que no pueden examinarse a simple vista. A pesar de ello hay diversas formas de obtener una imagen que, en caso de presentar irregularidades pueden indicar algún tipo de problemas como burbujas, arañazos, etc. La figura @ref(c06plotAffy} muestra algunas de las imágenes</p>
<p>La imagen del array de Affymetrix sólo es útil para evidenciar grandes problemas como burbujas, arañazos, etc. En este ejemplo los dos arrays de la izquierda se considerarían aceptables y los de la derecha defectuosos.</p>
<div class="figure"><span id="fig:c05plotAffy"></span>
<img src="figures/c05plotAffy.png" alt="Imágenes de cuatro microarrays de Affymetrix" width="819" />
<p class="caption">
Figure 5.4: Imágenes de cuatro microarrays de Affymetrix
</p>
</div>
</div>
<div id="gráfico-m-a" class="section level4" number="5.2.3.2">
<h4><span class="header-section-number">5.2.3.2</span> Gráfico “M-A”</h4>
<p>En los chips de dos colores el MA–plot se utliza para comparar los dos canales en cada array (rojo y verde). En cambio, en los chips de Affymetrics, en que sólo hay un canal en cada array, la única forma de definir M (el log ratio) es a partir de la comparación entre pares de de valores, ya sea los arrays dos a dos o bien cada array respecto un valor de referencia que puede ser la mediana, punto a punto, de todos los arrays (véase por ejemplo la figure ).</p>
<div class="figure"><span id="fig:c05MAPlotAffy"></span>
<img src="figures/c05MAPlotAffy.png" alt="En los chips de Affymetrix la única forma de definir M (el log ratio) es comparar entre diferentes arrays" width="774" />
<p class="caption">
Figure 5.5: En los chips de Affymetrix la única forma de definir M (el log ratio) es comparar entre diferentes arrays
</p>
</div>
<p><span class="math inline">\(M=\log_2(I_1) - \log_2(I_2)\)</span>: log ratio
<span class="math inline">\(A=\displaystyle \frac{1}{2}(\log_2 (I_1)+\log_2(I_2))\)</span>: log de intensidades
Donde <span class="math inline">\(I_1\)</span> es la intensidad del array de estudio, e <span class="math inline">\(I_2\)</span> es la intensidad media de arrays.
Por lo general, se espera que la distribución en el gráfico se concentre a lo largo del eje M = 0.</p>
</div>
<div id="modelos-de-bajo-nivel-probe-level-models-o-plm" class="section level4" number="5.2.3.3">
<h4><span class="header-section-number">5.2.3.3</span> Modelos de bajo nivel (“Probe-Level-Models” o PLM)</h4>
<p>Los modelos de bajo nivel (“Probe-Level-Models” o PLM) ajustan a los valores de intensidad –a nivel de sondas, no de valores totalizados de gen– un modelo explicativo. Los valores estimados por este modelo se comparan con los valores reales y se obtienen los errores o “residuos” del ajuste. El análisis de dichos residuos procede de forma similar a lo que se realiza al analizar un modelo de regresión:
Si los errores no presentan ningún patrón especial supondremos que el modelo se ajusta relativamente bien.
Si, en cambio, observamos desviaciones de esta presunta aleatoriedad querrá decir que el modelo no explica bien las observaciones, lo cual se atribuirá a la existencia de algún problema con los datos.</p>
<p>Con los valores ajustados del modelo se calculan dos medidas:</p>
<ul>
<li>La expresión relativa en escala logarítmica " Relative Log Expression" (RLE) es una medida estandarizada de la expresión.
No es de gran utilidad pero debería presentar una distribución similar en todos los arrays.</li>
<li>El error no estandarizado y normalizado o “NUSE” es el más informativo ya que representa la distribucián de los residuos a la que
hacíamos referencia más arriba.
Si un array es problemático la caja correspondiente en el boxplot aparece desplazada hacia arriba o abajo de las demás.</li>
</ul>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="5-2-exploración-y-control-de-calidad.html#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">stopifnot</span>(<span class="fu">require</span>(affyPLM))</span>
<span id="cb21-2"><a href="5-2-exploración-y-control-de-calidad.html#cb21-2" aria-hidden="true" tabindex="-1"></a>Pset<span class="ot">&lt;-</span> <span class="fu">fitPLM</span>(allAffyRaw)</span></code></pre></div>
<p>La figura <a href="#c06plotAffy5"><strong>??</strong></a> muestra los gráficos RLE y NUSE para el conjunto de datos estrogen. En ambos gráficos puede verse como el array defectuoso “” queda claramente diferenciado del resto.</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="5-2-exploración-y-control-de-calidad.html#cb22-1" aria-hidden="true" tabindex="-1"></a>opt<span class="ot">&lt;-</span> <span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">1</span>))</span>
<span id="cb22-2"><a href="5-2-exploración-y-control-de-calidad.html#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="fu">RLE</span>(Pset, <span class="at">main =</span> <span class="st">&quot;Relative Log Expression (RLE)&quot;</span>, </span>
<span id="cb22-3"><a href="5-2-exploración-y-control-de-calidad.html#cb22-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">names=</span><span class="fu">rownames</span>(<span class="fu">pData</span>(allAffyRaw)), <span class="at">las=</span><span class="dv">2</span>, <span class="at">cex.axis=</span><span class="fl">0.6</span>)</span>
<span id="cb22-4"><a href="5-2-exploración-y-control-de-calidad.html#cb22-4" aria-hidden="true" tabindex="-1"></a><span class="fu">NUSE</span>(Pset, <span class="at">main =</span> <span class="st">&quot;Normalized Unscaled Standard Errors (NUSE)&quot;</span>, <span class="at">las=</span><span class="dv">2</span>, </span>
<span id="cb22-5"><a href="5-2-exploración-y-control-de-calidad.html#cb22-5" aria-hidden="true" tabindex="-1"></a>     <span class="at">names=</span><span class="fu">rownames</span>(<span class="fu">pData</span>(allAffyRaw)), <span class="at">las=</span><span class="dv">2</span>, <span class="at">cex.axis=</span><span class="fl">0.6</span>)</span></code></pre></div>
<div class="figure">
<img src="Analisis_de_Datos_de_Microarrays_y_otras_Omicas_files/figure-html/plotPLM%20-1.png" alt="Graficos de diagnóstico calculados a nivel de sondas PLM" width="672" />
<p class="caption">
(#fig:plotPLM )Graficos de diagnóstico calculados a nivel de sondas PLM
</p>
</div>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="5-2-exploración-y-control-de-calidad.html#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(opt)</span></code></pre></div>
</div>
</div>
</div>
<p style="text-align: center;">
<a href="5-1-introducción.html"><button class="btn btn-default">Previous</button></a>
<a href="5-3-normalización-de-arrays-de-dos-colores.html"><button class="btn btn-default">Next</button></a>
</p>
</div>
</div>


</div>

<script>

// add bootstrap table styles to pandoc tables
$(document).ready(function () {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
});

</script>

</body>
</html>
