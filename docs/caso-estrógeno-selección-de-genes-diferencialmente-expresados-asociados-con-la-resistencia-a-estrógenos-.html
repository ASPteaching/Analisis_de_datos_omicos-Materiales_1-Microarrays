<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Capítulo 7 Caso “Estrógeno”: Selección de genes diferencialmente expresados asociados con la resistencia a estrógenos. | Analisis de datos omicos</title>
  <meta name="description" content="Capítulo 7 Caso “Estrógeno”: Selección de genes diferencialmente expresados asociados con la resistencia a estrógenos. | Analisis de datos omicos" />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="Capítulo 7 Caso “Estrógeno”: Selección de genes diferencialmente expresados asociados con la resistencia a estrógenos. | Analisis de datos omicos" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Capítulo 7 Caso “Estrógeno”: Selección de genes diferencialmente expresados asociados con la resistencia a estrógenos. | Analisis de datos omicos" />
  
  
  

<meta name="author" content="Alex Sánchez-Pla^{1,2} y Ricardo Gonzalo Sanz^2" />
<meta name="author" content="^1 Departament de Genètica, Microbiologia i Estadística. Universitat de Barcelona (UB)." />
<meta name="author" content="^2 Unitat d’Estadística i Bioinformàtica. Vall d’Hebron Institut de Recerca (VHIR)." />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="selección-de-genes-diferencialmente-expresados-chapdeg.html"/>
<link rel="next" href="después-de-la-selección-análisis-de-listas-de-genes.html"/>
<script src="libs/header-attrs-2.7/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Presentación</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#instalación-de-paquetes-de-r-y-código-de-los-capítulos"><i class="fa fa-check"></i><b>1.1</b> Instalación de paquetes de R y código de los capítulos</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="introduccion-a-los-microarrays-y-otras-tecnologías-omicas.html"><a href="introduccion-a-los-microarrays-y-otras-tecnologías-omicas.html"><i class="fa fa-check"></i><b>2</b> Introduccion a los microarrays y otras tecnologías omicas</a>
<ul>
<li class="chapter" data-level="2.1" data-path="introduccion-a-los-microarrays-y-otras-tecnologías-omicas.html"><a href="introduccion-a-los-microarrays-y-otras-tecnologías-omicas.html#antecedentes-históricos"><i class="fa fa-check"></i><b>2.1</b> Antecedentes históricos</a></li>
<li class="chapter" data-level="2.2" data-path="introduccion-a-los-microarrays-y-otras-tecnologías-omicas.html"><a href="introduccion-a-los-microarrays-y-otras-tecnologías-omicas.html#los-microarrays"><i class="fa fa-check"></i><b>2.2</b> Los microarrays</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="introduccion-a-los-microarrays-y-otras-tecnologías-omicas.html"><a href="introduccion-a-los-microarrays-y-otras-tecnologías-omicas.html#aplicaciones-de-los-microarrays"><i class="fa fa-check"></i><b>2.2.1</b> Aplicaciones de los microarrays</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="introduccion-a-los-microarrays-y-otras-tecnologías-omicas.html"><a href="introduccion-a-los-microarrays-y-otras-tecnologías-omicas.html#cómo-funcionan-los-microarrays"><i class="fa fa-check"></i><b>2.3</b> Cómo funcionan los microarrays</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="introduccion-a-los-microarrays-y-otras-tecnologías-omicas.html"><a href="introduccion-a-los-microarrays-y-otras-tecnologías-omicas.html#microarrays-de-dos-colores"><i class="fa fa-check"></i><b>2.3.1</b> Microarrays de dos colores</a></li>
<li class="chapter" data-level="2.3.2" data-path="introduccion-a-los-microarrays-y-otras-tecnologías-omicas.html"><a href="introduccion-a-los-microarrays-y-otras-tecnologías-omicas.html#microarrays-de-un-color"><i class="fa fa-check"></i><b>2.3.2</b> Microarrays de un color</a></li>
<li class="chapter" data-level="2.3.3" data-path="introduccion-a-los-microarrays-y-otras-tecnologías-omicas.html"><a href="introduccion-a-los-microarrays-y-otras-tecnologías-omicas.html#realización-de-un-experimento-de-microarrays"><i class="fa fa-check"></i><b>2.3.3</b> Realización de un experimento de microarrays</a></li>
<li class="chapter" data-level="2.3.4" data-path="introduccion-a-los-microarrays-y-otras-tecnologías-omicas.html"><a href="introduccion-a-los-microarrays-y-otras-tecnologías-omicas.html#como-se-mide-la-expresión"><i class="fa fa-check"></i><b>2.3.4</b> Como se mide la expresión</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="introduccion-a-los-microarrays-y-otras-tecnologías-omicas.html"><a href="introduccion-a-los-microarrays-y-otras-tecnologías-omicas.html#bioinformática-de-microarrays"><i class="fa fa-check"></i><b>2.4</b> Bioinformática de Microarrays<a name="Bioinformática"></a></a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="introduccion-a-los-microarrays-y-otras-tecnologías-omicas.html"><a href="introduccion-a-los-microarrays-y-otras-tecnologías-omicas.html#software-para-el-análisis-de-datos-de-microarrays"><i class="fa fa-check"></i><b>2.4.1</b> Software para el análisis de datos de microarrays</a></li>
<li class="chapter" data-level="2.4.2" data-path="introduccion-a-los-microarrays-y-otras-tecnologías-omicas.html"><a href="introduccion-a-los-microarrays-y-otras-tecnologías-omicas.html#bases-de-datos-de-microarrays"><i class="fa fa-check"></i><b>2.4.2</b> Bases de datos de Microarrays</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="introduccion-a-los-microarrays-y-otras-tecnologías-omicas.html"><a href="introduccion-a-los-microarrays-y-otras-tecnologías-omicas.html#extensiones-1-otros-tipos-de-microarrays"><i class="fa fa-check"></i><b>2.5</b> Extensiones (1): Otros tipos de microarrays<a name="extensions"></a></a>
<ul>
<li class="chapter" data-level="2.5.1" data-path="introduccion-a-los-microarrays-y-otras-tecnologías-omicas.html"><a href="introduccion-a-los-microarrays-y-otras-tecnologías-omicas.html#otros-microarrays-de-adn"><i class="fa fa-check"></i><b>2.5.1</b> Otros microarrays de ADN</a></li>
<li class="chapter" data-level="2.5.2" data-path="introduccion-a-los-microarrays-y-otras-tecnologías-omicas.html"><a href="introduccion-a-los-microarrays-y-otras-tecnologías-omicas.html#otros-tipos-de-microarrays-proteínas-o-carbohidratos"><i class="fa fa-check"></i><b>2.5.2</b> Otros tipos de microarrays: Proteínas o carbohidratos</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="introduccion-a-los-microarrays-y-otras-tecnologías-omicas.html"><a href="introduccion-a-los-microarrays-y-otras-tecnologías-omicas.html#extensiones-2-ngs-nextnow-generation-sequencing"><i class="fa fa-check"></i><b>2.6</b> Extensiones (2): <em>NGS: Next(Now) Generation Sequencing</em></a>
<ul>
<li class="chapter" data-level="2.6.1" data-path="introduccion-a-los-microarrays-y-otras-tecnologías-omicas.html"><a href="introduccion-a-los-microarrays-y-otras-tecnologías-omicas.html#visión-global-de-las-tecnologías-de-secuenciación"><i class="fa fa-check"></i><b>2.6.1</b> Visión global de las tecnologías de secuenciación</a></li>
<li class="chapter" data-level="2.6.2" data-path="introduccion-a-los-microarrays-y-otras-tecnologías-omicas.html"><a href="introduccion-a-los-microarrays-y-otras-tecnologías-omicas.html#de-la-secuenciación-sanger-a-la-ultrasecuenciación"><i class="fa fa-check"></i><b>2.6.2</b> De la secuenciación Sanger a la ultrasecuenciación</a></li>
<li class="chapter" data-level="2.6.3" data-path="introduccion-a-los-microarrays-y-otras-tecnologías-omicas.html"><a href="introduccion-a-los-microarrays-y-otras-tecnologías-omicas.html#tecnologías-de-ultrasecuenciación"><i class="fa fa-check"></i><b>2.6.3</b> Tecnologías de ultrasecuenciación</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="MDAProcess.html"><a href="MDAProcess.html"><i class="fa fa-check"></i><b>3</b> El proceso de análisis de microarrays</a>
<ul>
<li class="chapter" data-level="3.1" data-path="MDAProcess.html"><a href="MDAProcess.html#tipos-de-estudios"><i class="fa fa-check"></i><b>3.1</b> Tipos de estudios</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="MDAProcess.html"><a href="MDAProcess.html#comparación-de-grupos-o-class-comparison"><i class="fa fa-check"></i><b>3.1.1</b> Comparación de grupos o “Class comparison”</a></li>
<li class="chapter" data-level="3.1.2" data-path="MDAProcess.html"><a href="MDAProcess.html#predicción-de-clase-o-class-prediction"><i class="fa fa-check"></i><b>3.1.2</b> Predicción de clase o “Class prediction”</a></li>
<li class="chapter" data-level="3.1.3" data-path="MDAProcess.html"><a href="MDAProcess.html#descubrimiento-de-clases-o-class-discovery"><i class="fa fa-check"></i><b>3.1.3</b> Descubrimiento de clases o “Class discovery”</a></li>
<li class="chapter" data-level="3.1.4" data-path="MDAProcess.html"><a href="MDAProcess.html#otros-tipos-de-estudios"><i class="fa fa-check"></i><b>3.1.4</b> Otros tipos de estudios</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="MDAProcess.html"><a href="MDAProcess.html#c4examples"><i class="fa fa-check"></i><b>3.2</b> Algunos ejemplos concretos</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="MDAProcess.html"><a href="MDAProcess.html#celltypes"><i class="fa fa-check"></i><b>3.2.1</b> Estudio de procesos regulados por citoquinas</a></li>
<li class="chapter" data-level="3.2.2" data-path="MDAProcess.html"><a href="MDAProcess.html#golub"><i class="fa fa-check"></i><b>3.2.2</b> Clasificación molecular de la leucemia</a></li>
<li class="chapter" data-level="3.2.3" data-path="MDAProcess.html"><a href="MDAProcess.html#estrogen"><i class="fa fa-check"></i><b>3.2.3</b> Efecto del estrogeno y el tiempo de administración</a></li>
<li class="chapter" data-level="3.2.4" data-path="MDAProcess.html"><a href="MDAProcess.html#CCL4"><i class="fa fa-check"></i><b>3.2.4</b> Efecto del CCL4 en la expresión génica</a></li>
<li class="chapter" data-level="3.2.5" data-path="MDAProcess.html"><a href="MDAProcess.html#swirl"><i class="fa fa-check"></i><b>3.2.5</b> Estudio de la mutación “swirl” en el desarrollo del pez cebra</a></li>
<li class="chapter" data-level="3.2.6" data-path="MDAProcess.html"><a href="MDAProcess.html#yeast"><i class="fa fa-check"></i><b>3.2.6</b> Análisis de patrones en el ciclo celular</a></li>
<li class="chapter" data-level="3.2.7" data-path="MDAProcess.html"><a href="MDAProcess.html#recapitulación"><i class="fa fa-check"></i><b>3.2.7</b> Recapitulación</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="MDAProcess.html"><a href="MDAProcess.html#el-proceso-de-análisis-de-microarrays"><i class="fa fa-check"></i><b>3.3</b> El proceso de análisis de microarrays</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="MDAExpDesign.html"><a href="MDAExpDesign.html"><i class="fa fa-check"></i><b>4</b> Diseño de experimentos de microarrays</a>
<ul>
<li class="chapter" data-level="4.1" data-path="MDAExpDesign.html"><a href="MDAExpDesign.html#fuentes-de-variabilidad"><i class="fa fa-check"></i><b>4.1</b> Fuentes de variabilidad</a></li>
<li class="chapter" data-level="4.2" data-path="MDAExpDesign.html"><a href="MDAExpDesign.html#tipos-de-variabilidad"><i class="fa fa-check"></i><b>4.2</b> Tipos de variabilidad</a></li>
<li class="chapter" data-level="4.3" data-path="MDAExpDesign.html"><a href="MDAExpDesign.html#conceptos-básicos-de-diseño-de-experimentos"><i class="fa fa-check"></i><b>4.3</b> Conceptos básicos de diseño de Experimentos</a></li>
<li class="chapter" data-level="4.4" data-path="MDAExpDesign.html"><a href="MDAExpDesign.html#principios-de-diseño-de-experimentos"><i class="fa fa-check"></i><b>4.4</b> Principios de diseño de experimentos</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="MDAExpDesign.html"><a href="MDAExpDesign.html#replicación"><i class="fa fa-check"></i><b>4.4.1</b> Replicación</a></li>
<li class="chapter" data-level="4.4.2" data-path="MDAExpDesign.html"><a href="MDAExpDesign.html#aleatorización"><i class="fa fa-check"></i><b>4.4.2</b> Aleatorización</a></li>
<li class="chapter" data-level="4.4.3" data-path="MDAExpDesign.html"><a href="MDAExpDesign.html#bloqueo-o-control-local"><i class="fa fa-check"></i><b>4.4.3</b> Bloqueo o control local</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="MDAExpDesign.html"><a href="MDAExpDesign.html#diseños-experimentales-para-microarrays-de-dos-colores"><i class="fa fa-check"></i><b>4.5</b> Diseños experimentales para microarrays de dos colores</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="exploración-de-los-datos-control-de-calidad-y-preprocesado.html"><a href="exploración-de-los-datos-control-de-calidad-y-preprocesado.html"><i class="fa fa-check"></i><b>5</b> Exploración de los datos, control de calidad y preprocesado</a>
<ul>
<li class="chapter" data-level="5.1" data-path="exploración-de-los-datos-control-de-calidad-y-preprocesado.html"><a href="exploración-de-los-datos-control-de-calidad-y-preprocesado.html#introducción"><i class="fa fa-check"></i><b>5.1</b> Introducción</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="exploración-de-los-datos-control-de-calidad-y-preprocesado.html"><a href="exploración-de-los-datos-control-de-calidad-y-preprocesado.html#nivel-de-análisis-y-tipo-de-microarray"><i class="fa fa-check"></i><b>5.1.1</b> Nivel de análisis y tipo de microarray</a></li>
<li class="chapter" data-level="5.1.2" data-path="exploración-de-los-datos-control-de-calidad-y-preprocesado.html"><a href="exploración-de-los-datos-control-de-calidad-y-preprocesado.html#datos-de-partida"><i class="fa fa-check"></i><b>5.1.2</b> Datos de partida</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="exploración-de-los-datos-control-de-calidad-y-preprocesado.html"><a href="exploración-de-los-datos-control-de-calidad-y-preprocesado.html#exploración-y-control-de-calidad"><i class="fa fa-check"></i><b>5.2</b> Exploración y control de calidad</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="exploración-de-los-datos-control-de-calidad-y-preprocesado.html"><a href="exploración-de-los-datos-control-de-calidad-y-preprocesado.html#control-de-calidad-con-gráficos-estadísticos-generales"><i class="fa fa-check"></i><b>5.2.1</b> Control de calidad con gráficos estadísticos generales</a></li>
<li class="chapter" data-level="5.2.2" data-path="exploración-de-los-datos-control-de-calidad-y-preprocesado.html"><a href="exploración-de-los-datos-control-de-calidad-y-preprocesado.html#gráficos-de-diagnóstico-para-microarrays-de-dos-colores"><i class="fa fa-check"></i><b>5.2.2</b> Gráficos de diagnóstico para microarrays de dos colores</a></li>
<li class="chapter" data-level="5.2.3" data-path="exploración-de-los-datos-control-de-calidad-y-preprocesado.html"><a href="exploración-de-los-datos-control-de-calidad-y-preprocesado.html#gráficos-de-diagnóstico-para-microarrays-de-un-color"><i class="fa fa-check"></i><b>5.2.3</b> Gráficos de diagnóstico para microarrays de un color</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="exploración-de-los-datos-control-de-calidad-y-preprocesado.html"><a href="exploración-de-los-datos-control-de-calidad-y-preprocesado.html#normalización-de-arrays-de-dos-colores"><i class="fa fa-check"></i><b>5.3</b> Normalización de arrays de dos colores</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="exploración-de-los-datos-control-de-calidad-y-preprocesado.html"><a href="exploración-de-los-datos-control-de-calidad-y-preprocesado.html#normalización-global"><i class="fa fa-check"></i><b>5.3.1</b> Normalización global</a></li>
<li class="chapter" data-level="5.3.2" data-path="exploración-de-los-datos-control-de-calidad-y-preprocesado.html"><a href="exploración-de-los-datos-control-de-calidad-y-preprocesado.html#normalización-dependiente-de-la-intensidad"><i class="fa fa-check"></i><b>5.3.2</b> Normalización dependiente de la intensidad</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="exploración-de-los-datos-control-de-calidad-y-preprocesado.html"><a href="exploración-de-los-datos-control-de-calidad-y-preprocesado.html#resumen-y-normalización-de-microarrays-de-affymetrix"><i class="fa fa-check"></i><b>5.4</b> Resumen y normalización de microarrays de Affymetrix</a>
<ul>
<li class="chapter" data-level="5.4.1" data-path="exploración-de-los-datos-control-de-calidad-y-preprocesado.html"><a href="exploración-de-los-datos-control-de-calidad-y-preprocesado.html#el-método-rma-robust-multi-array-average"><i class="fa fa-check"></i><b>5.4.1</b> El método RMA (Robust Multi-Array Average)</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="exploración-de-los-datos-control-de-calidad-y-preprocesado.html"><a href="exploración-de-los-datos-control-de-calidad-y-preprocesado.html#filtraje-no-específico"><i class="fa fa-check"></i><b>5.5</b> Filtraje no específico</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="selección-de-genes-diferencialmente-expresados-chapdeg.html"><a href="selección-de-genes-diferencialmente-expresados-chapdeg.html"><i class="fa fa-check"></i><b>6</b> Selección de genes diferencialmente expresados {# chapDEG}</a>
<ul>
<li class="chapter" data-level="6.1" data-path="selección-de-genes-diferencialmente-expresados-chapdeg.html"><a href="selección-de-genes-diferencialmente-expresados-chapdeg.html#introducción-1"><i class="fa fa-check"></i><b>6.1</b> Introducción</a></li>
<li class="chapter" data-level="6.2" data-path="selección-de-genes-diferencialmente-expresados-chapdeg.html"><a href="selección-de-genes-diferencialmente-expresados-chapdeg.html#selección-de-genes-diferencialmente-expresados"><i class="fa fa-check"></i><b>6.2</b> Selección de genes diferencialmente expresados</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="selección-de-genes-diferencialmente-expresados-chapdeg.html"><a href="selección-de-genes-diferencialmente-expresados-chapdeg.html#medidas-naturales-para-comparar-dos-muestras"><i class="fa fa-check"></i><b>6.2.1</b> Medidas <em>naturales</em> para comparar dos muestras</a></li>
<li class="chapter" data-level="6.2.2" data-path="selección-de-genes-diferencialmente-expresados-chapdeg.html"><a href="selección-de-genes-diferencialmente-expresados-chapdeg.html#un-primer-ejemplo"><i class="fa fa-check"></i><b>6.2.2</b> Un primer ejemplo</a></li>
<li class="chapter" data-level="6.2.3" data-path="selección-de-genes-diferencialmente-expresados-chapdeg.html"><a href="selección-de-genes-diferencialmente-expresados-chapdeg.html#selección-de-genes-usando-tests-estadísticos"><i class="fa fa-check"></i><b>6.2.3</b> Selección de genes usando tests estadísticos</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="selección-de-genes-diferencialmente-expresados-chapdeg.html"><a href="selección-de-genes-diferencialmente-expresados-chapdeg.html#significación-estadística-y-expresión-diferencial"><i class="fa fa-check"></i><b>6.3</b> Significación estadística y expresión diferencial</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="selección-de-genes-diferencialmente-expresados-chapdeg.html"><a href="selección-de-genes-diferencialmente-expresados-chapdeg.html#volcano-plots"><i class="fa fa-check"></i><b>6.3.1</b> “Volcano plots”</a></li>
<li class="chapter" data-level="6.3.2" data-path="selección-de-genes-diferencialmente-expresados-chapdeg.html"><a href="selección-de-genes-diferencialmente-expresados-chapdeg.html#potencia-y-tamaño-muestral"><i class="fa fa-check"></i><b>6.3.2</b> Potencia y tamaño muestral</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="selección-de-genes-diferencialmente-expresados-chapdeg.html"><a href="selección-de-genes-diferencialmente-expresados-chapdeg.html#el-problema-de-la-múltiplicidad-de-tests-multiple-testing"><i class="fa fa-check"></i><b>6.4</b> El problema de la múltiplicidad de tests (“multiple testing”)</a></li>
<li class="chapter" data-level="6.5" data-path="selección-de-genes-diferencialmente-expresados-chapdeg.html"><a href="selección-de-genes-diferencialmente-expresados-chapdeg.html#modelos-lineales-para-la-selección-de-genes-limma"><i class="fa fa-check"></i><b>6.5</b> Modelos lineales para la selección de genes: <tt>limma </tt></a>
<ul>
<li class="chapter" data-level="6.5.1" data-path="selección-de-genes-diferencialmente-expresados-chapdeg.html"><a href="selección-de-genes-diferencialmente-expresados-chapdeg.html#el-modelo-lineal-general"><i class="fa fa-check"></i><b>6.5.1</b> El modelo lineal general</a></li>
<li class="chapter" data-level="6.5.2" data-path="selección-de-genes-diferencialmente-expresados-chapdeg.html"><a href="selección-de-genes-diferencialmente-expresados-chapdeg.html#ejemplos-de-situaciones-modelizables-linealmente"><i class="fa fa-check"></i><b>6.5.2</b> Ejemplos de situaciones <em>modelizables linealmente</em></a></li>
<li class="chapter" data-level="6.5.3" data-path="selección-de-genes-diferencialmente-expresados-chapdeg.html"><a href="selección-de-genes-diferencialmente-expresados-chapdeg.html#ejemplo-2-comparación-de-tres-grupos"><i class="fa fa-check"></i><b>6.5.3</b> Ejemplo 2: Comparación de tres grupos</a></li>
<li class="chapter" data-level="6.5.4" data-path="selección-de-genes-diferencialmente-expresados-chapdeg.html"><a href="selección-de-genes-diferencialmente-expresados-chapdeg.html#estimación-e-inferencia-con-el-modelo-lineal"><i class="fa fa-check"></i><b>6.5.4</b> Estimación e inferencia con el modelo lineal</a></li>
<li class="chapter" data-level="6.5.5" data-path="selección-de-genes-diferencialmente-expresados-chapdeg.html"><a href="selección-de-genes-diferencialmente-expresados-chapdeg.html#modelos-lineales-para-microarrays"><i class="fa fa-check"></i><b>6.5.5</b> Modelos lineales para Microarrays</a></li>
<li class="chapter" data-level="6.5.6" data-path="selección-de-genes-diferencialmente-expresados-chapdeg.html"><a href="selección-de-genes-diferencialmente-expresados-chapdeg.html#implementación-y-ejemplos"><i class="fa fa-check"></i><b>6.5.6</b> Implementación y ejemplos</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="caso-estrógeno-selección-de-genes-diferencialmente-expresados-asociados-con-la-resistencia-a-estrógenos-.html"><a href="caso-estrógeno-selección-de-genes-diferencialmente-expresados-asociados-con-la-resistencia-a-estrógenos-.html"><i class="fa fa-check"></i><b>7</b> Caso “Estrógeno”: Selección de genes diferencialmente expresados asociados con la resistencia a estrógenos.</a>
<ul>
<li class="chapter" data-level="7.1" data-path="caso-estrógeno-selección-de-genes-diferencialmente-expresados-asociados-con-la-resistencia-a-estrógenos-.html"><a href="caso-estrógeno-selección-de-genes-diferencialmente-expresados-asociados-con-la-resistencia-a-estrógenos-.html#introducción-2"><i class="fa fa-check"></i><b>7.1</b> Introducción</a></li>
<li class="chapter" data-level="7.2" data-path="caso-estrógeno-selección-de-genes-diferencialmente-expresados-asociados-con-la-resistencia-a-estrógenos-.html"><a href="caso-estrógeno-selección-de-genes-diferencialmente-expresados-asociados-con-la-resistencia-a-estrógenos-.html#el-estudio-estrógeno"><i class="fa fa-check"></i><b>7.2</b> El estudio “Estrógeno”</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="caso-estrógeno-selección-de-genes-diferencialmente-expresados-asociados-con-la-resistencia-a-estrógenos-.html"><a href="caso-estrógeno-selección-de-genes-diferencialmente-expresados-asociados-con-la-resistencia-a-estrógenos-.html#directorios-y-opciones-de-trabajo"><i class="fa fa-check"></i><b>7.2.1</b> Directorios y opciones de trabajo</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="caso-estrógeno-selección-de-genes-diferencialmente-expresados-asociados-con-la-resistencia-a-estrógenos-.html"><a href="caso-estrógeno-selección-de-genes-diferencialmente-expresados-asociados-con-la-resistencia-a-estrógenos-.html#obtención-y-lectura-de-los-datos"><i class="fa fa-check"></i><b>7.3</b> Obtención y lectura de los datos</a>
<ul>
<li class="chapter" data-level="7.3.1" data-path="caso-estrógeno-selección-de-genes-diferencialmente-expresados-asociados-con-la-resistencia-a-estrógenos-.html"><a href="caso-estrógeno-selección-de-genes-diferencialmente-expresados-asociados-con-la-resistencia-a-estrógenos-.html#los-datos"><i class="fa fa-check"></i><b>7.3.1</b> Los datos</a></li>
<li class="chapter" data-level="7.3.2" data-path="caso-estrógeno-selección-de-genes-diferencialmente-expresados-asociados-con-la-resistencia-a-estrógenos-.html"><a href="caso-estrógeno-selección-de-genes-diferencialmente-expresados-asociados-con-la-resistencia-a-estrógenos-.html#lectura-de-los-datos"><i class="fa fa-check"></i><b>7.3.2</b> Lectura de los datos</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="caso-estrógeno-selección-de-genes-diferencialmente-expresados-asociados-con-la-resistencia-a-estrógenos-.html"><a href="caso-estrógeno-selección-de-genes-diferencialmente-expresados-asociados-con-la-resistencia-a-estrógenos-.html#exploración-control-de-calidad-y-normalización"><i class="fa fa-check"></i><b>7.4</b> Exploración, Control de Calidad y Normalización</a>
<ul>
<li class="chapter" data-level="7.4.1" data-path="caso-estrógeno-selección-de-genes-diferencialmente-expresados-asociados-con-la-resistencia-a-estrógenos-.html"><a href="caso-estrógeno-selección-de-genes-diferencialmente-expresados-asociados-con-la-resistencia-a-estrógenos-.html#exploración-y-visualización"><i class="fa fa-check"></i><b>7.4.1</b> Exploración y visualización</a></li>
<li class="chapter" data-level="7.4.2" data-path="caso-estrógeno-selección-de-genes-diferencialmente-expresados-asociados-con-la-resistencia-a-estrógenos-.html"><a href="caso-estrógeno-selección-de-genes-diferencialmente-expresados-asociados-con-la-resistencia-a-estrógenos-.html#control-de-calidad"><i class="fa fa-check"></i><b>7.4.2</b> Control de calidad</a></li>
<li class="chapter" data-level="7.4.3" data-path="caso-estrógeno-selección-de-genes-diferencialmente-expresados-asociados-con-la-resistencia-a-estrógenos-.html"><a href="caso-estrógeno-selección-de-genes-diferencialmente-expresados-asociados-con-la-resistencia-a-estrógenos-.html#normalizacion-y-filtraje"><i class="fa fa-check"></i><b>7.4.3</b> Normalizacion y Filtraje</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="caso-estrógeno-selección-de-genes-diferencialmente-expresados-asociados-con-la-resistencia-a-estrógenos-.html"><a href="caso-estrógeno-selección-de-genes-diferencialmente-expresados-asociados-con-la-resistencia-a-estrógenos-.html#selección-de-genes-diferencialmente-expresados-1"><i class="fa fa-check"></i><b>7.5</b> Selección de genes diferencialmente expresados</a>
<ul>
<li class="chapter" data-level="7.5.1" data-path="caso-estrógeno-selección-de-genes-diferencialmente-expresados-asociados-con-la-resistencia-a-estrógenos-.html"><a href="caso-estrógeno-selección-de-genes-diferencialmente-expresados-asociados-con-la-resistencia-a-estrógenos-.html#análisis-basado-en-modelos-lineales"><i class="fa fa-check"></i><b>7.5.1</b> Análisis basado en modelos lineales</a></li>
<li class="chapter" data-level="7.5.2" data-path="caso-estrógeno-selección-de-genes-diferencialmente-expresados-asociados-con-la-resistencia-a-estrógenos-.html"><a href="caso-estrógeno-selección-de-genes-diferencialmente-expresados-asociados-con-la-resistencia-a-estrógenos-.html#comparaciones-múltiples"><i class="fa fa-check"></i><b>7.5.2</b> Comparaciones múltiples</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="después-de-la-selección-análisis-de-listas-de-genes.html"><a href="después-de-la-selección-análisis-de-listas-de-genes.html"><i class="fa fa-check"></i><b>8</b> Después de la selección: Análisis de listas de genes</a>
<ul>
<li class="chapter" data-level="8.1" data-path="después-de-la-selección-análisis-de-listas-de-genes.html"><a href="después-de-la-selección-análisis-de-listas-de-genes.html#introducción-3"><i class="fa fa-check"></i><b>8.1</b> Introducción</a></li>
<li class="chapter" data-level="8.2" data-path="después-de-la-selección-análisis-de-listas-de-genes.html"><a href="después-de-la-selección-análisis-de-listas-de-genes.html#análisis-comparativo-de-listas-de-genes"><i class="fa fa-check"></i><b>8.2</b> Análisis comparativo de listas de genes</a>
<ul>
<li class="chapter" data-level="8.2.1" data-path="después-de-la-selección-análisis-de-listas-de-genes.html"><a href="después-de-la-selección-análisis-de-listas-de-genes.html#ejemplo-comparación-de-listas-en-el-caso-celltypes"><i class="fa fa-check"></i><b>8.2.1</b> Ejemplo: comparación de listas en el caso <tt>celltypes</tt></a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="después-de-la-selección-análisis-de-listas-de-genes.html"><a href="después-de-la-selección-análisis-de-listas-de-genes.html#anotación-de-los-resultados"><i class="fa fa-check"></i><b>8.3</b> Anotación de los resultados</a></li>
<li class="chapter" data-level="8.4" data-path="después-de-la-selección-análisis-de-listas-de-genes.html"><a href="después-de-la-selección-análisis-de-listas-de-genes.html#visualización-de-los-perfiles-de-expresión"><i class="fa fa-check"></i><b>8.4</b> Visualización de los perfiles de expresión</a></li>
<li class="chapter" data-level="8.5" data-path="después-de-la-selección-análisis-de-listas-de-genes.html"><a href="después-de-la-selección-análisis-de-listas-de-genes.html#análisis-de-significación-biológica"><i class="fa fa-check"></i><b>8.5</b> Análisis de significación biológica</a>
<ul>
<li class="chapter" data-level="8.5.1" data-path="después-de-la-selección-análisis-de-listas-de-genes.html"><a href="después-de-la-selección-análisis-de-listas-de-genes.html#análisis-de-enriquecimiento"><i class="fa fa-check"></i><b>8.5.1</b> Análisis de enriquecimiento <a name="GEA"></a></a></li>
<li class="chapter" data-level="8.5.2" data-path="después-de-la-selección-análisis-de-listas-de-genes.html"><a href="después-de-la-selección-análisis-de-listas-de-genes.html#análisis-de-enriquecimiento-con-bioconductor"><i class="fa fa-check"></i><b>8.5.2</b> Análisis de enriquecimiento con Bioconductor</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="referencias.html"><a href="referencias.html"><i class="fa fa-check"></i><b>9</b> Referencias</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Analisis de datos omicos</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="caso-estrógeno-selección-de-genes-diferencialmente-expresados-asociados-con-la-resistencia-a-estrógenos." class="section level1" number="7">
<h1><span class="header-section-number">Capítulo 7</span> Caso “Estrógeno”: Selección de genes diferencialmente expresados asociados con la resistencia a estrógenos.</h1>
<div id="introducción-2" class="section level2" number="7.1">
<h2><span class="header-section-number">7.1</span> Introducción</h2>
<p>El análisis de datos de microarrays suele proceder, en general secuencialmente,
a través de una serie de etapas tal y como se comentado en capítulos anteriores.</p>
<p>En cada una de las etapas pueden llevarse a cabo diversos procesos, con diversas variantes de métodos parecidos.A lo largo de la primera década del 2000 se ha desarrollado el proyecto Bioconductor que ha impulsado la creación de cientos de paquetes de R que implementan casi todas las capacidades posibles de análisis de microarrays. Aunque nadie puede conocer todos los paquetes con tan sólo conocer algunos de ellos es posible llevar a cabo potentes análisis con relativa facilidad.</p>
<p>El objetivo de este capítulo es ilustrar de forma breve pero completa como se hace un análisis de microarrays usando las facilidades que ofrecen Bioconductor y R.</p>
<p>Como se ha dicho, uno de los problemas en este tipo de estudios es que
en cada etapa se puede proceder de varias formas lo que da lugar a un
asfixiante número de posibilidades especialmente para el neófito.
Con el fin de evitar este problema de momento se describe una sola de
las opciones posibles para cada paso, lo que constituye un proceso
“al estilo Bioconductor”</p>
</div>
<div id="el-estudio-estrógeno" class="section level2" number="7.2">
<h2><span class="header-section-number">7.2</span> El estudio “Estrógeno”</h2>
<p>El ejemplo analizado consiste en unos datos disponibles en forma de paquete (<tt>estrogen</tt>) en Bioconductor. Se trata de un estudio en el que se estudia la influencia del tratamiento con estrógeno y del tiempo transcurrido desde el tratamiento en la expresión de genes asociados con cancer de mama. En capítulos anteriores se han utilizado fragmentos de este ejemplo descrito en el capítulo <a href="`{r anchorLoc('MDAProcess')`">here</a> en el epígrafe corresponiente a los ejemplos (ejemplo <a href="`{r anchorLoc('estrogen')`">here</a>).</p>
<p>El diseño experimental para este estudio consiste en un diseño factorial de 2 factores “Estrogeno” (Presente o Ausente), “Tiempo” (10h o 48h).
La documentación del paquete <tt>estrogen</tt> ofrece más detalles acerca del diseño y las variables utilizadas.</p>
<p>Si el paquete no se encuentra instalado puede instalarse con la instrucción <tt>BiocManager::install</tt> que se descarga de la web de Bioconductor.</p>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="caso-estrógeno-selección-de-genes-diferencialmente-expresados-asociados-con-la-resistencia-a-estrógenos-.html#cb48-1"></a><span class="cf">if</span> (<span class="op">!</span>(<span class="kw">require</span>(<span class="st">&quot;estrogen&quot;</span>, <span class="dt">character.only=</span>T))){</span>
<span id="cb48-2"><a href="caso-estrógeno-selección-de-genes-diferencialmente-expresados-asociados-con-la-resistencia-a-estrógenos-.html#cb48-2"></a>    BiocManager<span class="op">::</span><span class="kw">install</span>(<span class="st">&quot;estrogen&quot;</span>)</span>
<span id="cb48-3"><a href="caso-estrógeno-selección-de-genes-diferencialmente-expresados-asociados-con-la-resistencia-a-estrógenos-.html#cb48-3"></a>    }</span></code></pre></div>
<p>En lo que sigue supondremos que se ha llevado a cabo una instalación estándar de Bioconductor es decir se han ejecutado las instrucciones:</p>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="caso-estrógeno-selección-de-genes-diferencialmente-expresados-asociados-con-la-resistencia-a-estrógenos-.html#cb49-1"></a>BiocManager<span class="op">::</span><span class="kw">install</span>()</span></code></pre></div>
<div id="directorios-y-opciones-de-trabajo" class="section level3" number="7.2.1">
<h3><span class="header-section-number">7.2.1</span> Directorios y opciones de trabajo</h3>
<p>Para facilitar supondremos que trabajamos en un directorio escogido por nosotros y cuya localización se asigna a la variable <tt>workingDir</tt>.
Los datos se copiaran en un subdirectorio del anterior denominado “data” que se almacenará en la variable
<tt>dataDir</tt> y los resultados se almacenarán en un directorio “results” cuyo nombre completo
se almacenará en la variable <tt>resultsDir</tt>.</p>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="caso-estrógeno-selección-de-genes-diferencialmente-expresados-asociados-con-la-resistencia-a-estrógenos-.html#cb50-1"></a>workingDir &lt;-<span class="kw">getwd</span>()</span>
<span id="cb50-2"><a href="caso-estrógeno-selección-de-genes-diferencialmente-expresados-asociados-con-la-resistencia-a-estrógenos-.html#cb50-2"></a><span class="cf">if</span> (<span class="op">!</span><span class="kw">file.exists</span>(<span class="st">&quot;datos&quot;</span>)) <span class="kw">system</span>(<span class="st">&quot;mkdir datos&quot;</span>)</span>
<span id="cb50-3"><a href="caso-estrógeno-selección-de-genes-diferencialmente-expresados-asociados-con-la-resistencia-a-estrógenos-.html#cb50-3"></a><span class="cf">if</span> (<span class="op">!</span><span class="kw">file.exists</span>(<span class="st">&quot;datos/estrogen&quot;</span>)) <span class="kw">system</span>(<span class="st">&quot;mkdir datos/estrogen&quot;</span>)</span>
<span id="cb50-4"><a href="caso-estrógeno-selección-de-genes-diferencialmente-expresados-asociados-con-la-resistencia-a-estrógenos-.html#cb50-4"></a><span class="cf">if</span> (<span class="op">!</span><span class="kw">file.exists</span>(<span class="st">&quot;results&quot;</span>)) <span class="kw">system</span>(<span class="st">&quot;mkdir results&quot;</span>)</span>
<span id="cb50-5"><a href="caso-estrógeno-selección-de-genes-diferencialmente-expresados-asociados-con-la-resistencia-a-estrógenos-.html#cb50-5"></a>dataDir &lt;-<span class="kw">file.path</span>(workingDir, <span class="st">&quot;datos/estrogen&quot;</span>)</span>
<span id="cb50-6"><a href="caso-estrógeno-selección-de-genes-diferencialmente-expresados-asociados-con-la-resistencia-a-estrógenos-.html#cb50-6"></a>resultsDir &lt;-<span class="st"> </span><span class="kw">file.path</span>(workingDir, <span class="st">&quot;results&quot;</span>)</span>
<span id="cb50-7"><a href="caso-estrógeno-selección-de-genes-diferencialmente-expresados-asociados-con-la-resistencia-a-estrógenos-.html#cb50-7"></a><span class="kw">setwd</span>(workingDir)</span></code></pre></div>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="caso-estrógeno-selección-de-genes-diferencialmente-expresados-asociados-con-la-resistencia-a-estrógenos-.html#cb51-1"></a><span class="kw">options</span>(<span class="dt">width=</span><span class="dv">80</span>)</span>
<span id="cb51-2"><a href="caso-estrógeno-selección-de-genes-diferencialmente-expresados-asociados-con-la-resistencia-a-estrógenos-.html#cb51-2"></a><span class="kw">options</span>(<span class="dt">digits=</span><span class="dv">5</span>)</span></code></pre></div>
</div>
</div>
<div id="obtención-y-lectura-de-los-datos" class="section level2" number="7.3">
<h2><span class="header-section-number">7.3</span> Obtención y lectura de los datos</h2>
<p>Para un análisis de datos de microarrays de Affymetrix se necesitan los archivos
de imágenes escaneadas (“.CEL”) y un archivo en el que se asigne una condición
experimental a cada archivo.</p>
<div id="los-datos" class="section level3" number="7.3.1">
<h3><span class="header-section-number">7.3.1</span> Los datos</h3>
<p>Una ventaja de este ejemplo es que los datos se encuentran disponibles tras instalar el paquete <tt>estrogen</tt> por lo que se pueden copiar un directorio de trabajo o simplemente trabajar con ellos en el directorio original.
El directorio en que se encuentran los archivos .CEL es:</p>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb52-1"><a href="caso-estrógeno-selección-de-genes-diferencialmente-expresados-asociados-con-la-resistencia-a-estrógenos-.html#cb52-1"></a><span class="kw">library</span>(estrogen)</span>
<span id="cb52-2"><a href="caso-estrógeno-selección-de-genes-diferencialmente-expresados-asociados-con-la-resistencia-a-estrógenos-.html#cb52-2"></a>estrogenDir &lt;-<span class="st"> </span><span class="kw">system.file</span>(<span class="st">&quot;extdata&quot;</span>, <span class="dt">package =</span> <span class="st">&quot;estrogen&quot;</span>)</span>
<span id="cb52-3"><a href="caso-estrógeno-selección-de-genes-diferencialmente-expresados-asociados-con-la-resistencia-a-estrógenos-.html#cb52-3"></a><span class="kw">print</span>(estrogenDir)</span></code></pre></div>
<pre><code>## [1] &quot;/home/alex/R/x86_64-pc-linux-gnu-library/4.0/estrogen/extdata&quot;</code></pre>
<p>Para realizar el análisis es preciso copiar todos los archivos del directorio “extdata”
a nuestro directorio de trabajo “data”.</p>
<p><strong>ATENCION: Esta operación que depende de la instalación y del sistema operativo</strong>. Por ejemplo para copiarlos desde R en linux se escribirá:</p>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb54-1"><a href="caso-estrógeno-selección-de-genes-diferencialmente-expresados-asociados-con-la-resistencia-a-estrógenos-.html#cb54-1"></a><span class="kw">system</span>(<span class="kw">paste</span> (<span class="st">&quot;cp &quot;</span>, estrogenDir,<span class="st">&quot;/* ./data&quot;</span>, <span class="dt">sep=</span><span class="st">&quot;&quot;</span>))</span></code></pre></div>
<p>Los archivos copiados son</p>
<ul>
<li>Los ocho archivos .CEL para el análisis</li>
<li>Un archivo defectuoso para que se vea como debe salir un “array malo” en el control de calidad.</li>
<li>Un archivo de covariables o “targets” que se usará al leer los archivos .CEL incorporar la información de las covariables en el objeto que se creará.</li>
</ul>
</div>
<div id="lectura-de-los-datos" class="section level3" number="7.3.2">
<h3><span class="header-section-number">7.3.2</span> Lectura de los datos</h3>
<p>El proceso de leer los datos puede parecer un poco extraño a primera vista
pero la idea es simple:</p>
En primer lugar creamos algunas estructuras de datos que
contienen la información sobre las variables y - opcionalmente - sobre
las anotaciones y el experimento y
<p>A continuación nos basamos en estas estructuras para leer los datos y crear
los objetos principales que se utilizarán para el análisis.</p>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="caso-estrógeno-selección-de-genes-diferencialmente-expresados-asociados-con-la-resistencia-a-estrógenos-.html#cb55-1"></a><span class="kw">library</span>(Biobase)</span>
<span id="cb55-2"><a href="caso-estrógeno-selección-de-genes-diferencialmente-expresados-asociados-con-la-resistencia-a-estrógenos-.html#cb55-2"></a><span class="kw">library</span>(affy)</span>
<span id="cb55-3"><a href="caso-estrógeno-selección-de-genes-diferencialmente-expresados-asociados-con-la-resistencia-a-estrógenos-.html#cb55-3"></a>sampleInfo &lt;-<span class="st"> </span><span class="kw">read.AnnotatedDataFrame</span>(<span class="kw">file.path</span>(estrogenDir,<span class="st">&quot;targLimma.txt&quot;</span>),</span>
<span id="cb55-4"><a href="caso-estrógeno-selección-de-genes-diferencialmente-expresados-asociados-con-la-resistencia-a-estrógenos-.html#cb55-4"></a>    <span class="dt">header =</span> <span class="ot">TRUE</span>, <span class="dt">row.names =</span> <span class="dv">1</span>, <span class="dt">sep=</span><span class="st">&quot;</span><span class="ch">\t</span><span class="st">&quot;</span>)</span>
<span id="cb55-5"><a href="caso-estrógeno-selección-de-genes-diferencialmente-expresados-asociados-con-la-resistencia-a-estrógenos-.html#cb55-5"></a>fileNames &lt;-<span class="st"> </span><span class="kw">pData</span>(sampleInfo)<span class="op">$</span>FileName</span>
<span id="cb55-6"><a href="caso-estrógeno-selección-de-genes-diferencialmente-expresados-asociados-con-la-resistencia-a-estrógenos-.html#cb55-6"></a>rawData &lt;-<span class="st"> </span><span class="kw">read.affybatch</span>(<span class="dt">filenames=</span><span class="kw">file.path</span>(estrogenDir,fileNames),</span>
<span id="cb55-7"><a href="caso-estrógeno-selección-de-genes-diferencialmente-expresados-asociados-con-la-resistencia-a-estrógenos-.html#cb55-7"></a>                          <span class="dt">phenoData=</span>sampleInfo)</span></code></pre></div>
<p>En este ejemplo se incluye un archivo defectuoso con fines didácticos, llamado “badcel”.
Para ilustrar las diferencias entre archivos correctos e incorrectos se puede leer en otro objeto.</p>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb56-1"><a href="caso-estrógeno-selección-de-genes-diferencialmente-expresados-asociados-con-la-resistencia-a-estrógenos-.html#cb56-1"></a><span class="kw">require</span>(affy)</span>
<span id="cb56-2"><a href="caso-estrógeno-selección-de-genes-diferencialmente-expresados-asociados-con-la-resistencia-a-estrógenos-.html#cb56-2"></a>sampleInfoWithBad &lt;-<span class="st"> </span><span class="kw">read.AnnotatedDataFrame</span>(<span class="kw">file.path</span>(dataDir,<span class="st">&quot;phenoDataWithBad.txt&quot;</span>),</span>
<span id="cb56-3"><a href="caso-estrógeno-selección-de-genes-diferencialmente-expresados-asociados-con-la-resistencia-a-estrógenos-.html#cb56-3"></a>    <span class="dt">header =</span> <span class="ot">TRUE</span>, <span class="dt">row.names =</span> <span class="ot">NULL</span>, <span class="dt">sep=</span><span class="st">&quot;</span><span class="ch">\t</span><span class="st">&quot;</span>)</span>
<span id="cb56-4"><a href="caso-estrógeno-selección-de-genes-diferencialmente-expresados-asociados-con-la-resistencia-a-estrógenos-.html#cb56-4"></a>fileNames &lt;-<span class="st"> </span><span class="kw">pData</span>(sampleInfoWithBad)<span class="op">$</span>FileName</span>
<span id="cb56-5"><a href="caso-estrógeno-selección-de-genes-diferencialmente-expresados-asociados-con-la-resistencia-a-estrógenos-.html#cb56-5"></a>rawData.wrong &lt;-<span class="st"> </span><span class="kw">read.affybatch</span>(<span class="dt">filenames=</span><span class="kw">file.path</span>(dataDir,fileNames),</span>
<span id="cb56-6"><a href="caso-estrógeno-selección-de-genes-diferencialmente-expresados-asociados-con-la-resistencia-a-estrógenos-.html#cb56-6"></a>                          <span class="dt">phenoData=</span>sampleInfoWithBad)</span></code></pre></div>
</div>
</div>
<div id="exploración-control-de-calidad-y-normalización" class="section level2" number="7.4">
<h2><span class="header-section-number">7.4</span> Exploración, Control de Calidad y Normalización</h2>
<p>Tras leer los datos pasamos al preprocesado.
Aunque puede interpretarse de distintas formas esta fase suele consistir en</p>
<ol style="list-style-type: decimal">
<li>Realizar algunos gráficos con los datos para hacerse una idea de como ha resultado el experimento.</li>
<li>Realizar un control de calidad más formal.</li>
<li>Normalizar y, en el caso de Affymetrix, resumir las expresiones</li>
</ol>
<div id="exploración-y-visualización" class="section level3" number="7.4.1">
<h3><span class="header-section-number">7.4.1</span> Exploración y visualización</h3>
<p>La exploración previa puede hacerse paso a paso o en bloque si se utiliza algún paquete como <tt>arratQualityMetrics</tt>. En la ayuda de este paquete se encuentra una descripción de los análisis básicos que permite realizar.</p>
<p>El primer gráfico que suele hacerse és algun tipo de “densidad” que muestre la distribución de las señales en los datos “crudos”, es decir sin normalizar.
Estos gráficos también permiten hacerse una idea de si las distribuciones de los distintos arrays son similares en forma y posición.</p>
<p><img src="Analisis_de_Datos_de_Microarrays_y_otras_Omicas_files/figure-html/plotHist-1.png" width="672" /></p>
<p>El gráfico de degradación –que no aparece en este caso, ya que daba problemeas al representarlo– permite hacerse una idea de como ha sido el proceso de hibridación de las muestras.
Lineas paralelas sugieren una calidad similar.</p>
<pre><code>##        low10A low10B  hi10A   hi10B   low48A   low48B   hi48A    hi48B
## slope  -0.103 -0.217 -0.129 -0.3810 -0.50400 -0.55300 -0.3510 -0.66700
## pvalue  0.550  0.194  0.394  0.0341  0.00482  0.00109  0.0464  0.00032</code></pre>
<p>EL código para el gráfico de degradación sería:</p>
<p>El diagrama de cajas muestra, como el histograma, una idea de la distribución de los datos.</p>
<p><img src="Analisis_de_Datos_de_Microarrays_y_otras_Omicas_files/figure-html/boxPlot-1.png" width="672" /></p>
<p>Finalmente un cluster jerárquico seguido de un dendrograma nos puede ayudar a hacernos una idea
de si las muestras se agrupan por condiciones experimentales.</p>
<p>Si lo hacen es bueno, pero si no, no es necesariamente indicador de problemas,
puesto que es un gráfico basado en todo los datos.</p>
<p><img src="Analisis_de_Datos_de_Microarrays_y_otras_Omicas_files/figure-html/plotDendro2-1.png" width="672" /></p>
</div>
<div id="control-de-calidad" class="section level3" number="7.4.2">
<h3><span class="header-section-number">7.4.2</span> Control de calidad</h3>
<p>Las exploraciones anteriores nos proporcionan una idea de como son los datos.</p>
<p>Se pueden realizar controles de calidad más estrictos como:</p>
<ul>
<li>Los controles de calidad estándar de Affymetrix, descritos en el paquete <tt>arrayQualityMetrics</tt>.</li>
</ul>
<p>El paquete <tt>arrayQualityMetrics</tt> encapsula unos cuantos análisis,
de forma que con una instrucción se pueden realizar todos los análisis y enviar la salida a un directorio.</p>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb58-1"><a href="caso-estrógeno-selección-de-genes-diferencialmente-expresados-asociados-con-la-resistencia-a-estrógenos-.html#cb58-1"></a><span class="cf">if</span>(<span class="op">!</span><span class="kw">require</span>(arrayQualityMetrics)) BiocManager<span class="op">::</span><span class="kw">install</span>(<span class="st">&quot;arrayQualityMetrics&quot;</span>)</span>
<span id="cb58-2"><a href="caso-estrógeno-selección-de-genes-diferencialmente-expresados-asociados-con-la-resistencia-a-estrógenos-.html#cb58-2"></a><span class="kw">library</span>(arrayQualityMetrics)</span>
<span id="cb58-3"><a href="caso-estrógeno-selección-de-genes-diferencialmente-expresados-asociados-con-la-resistencia-a-estrógenos-.html#cb58-3"></a><span class="kw">arrayQualityMetrics</span>(rawData, <span class="dt">outdir =</span> <span class="st">&quot;Informe_de_calidad_para_los_datos_del_caso_ESTROGENO&quot;</span>)</span>
<span id="cb58-4"><a href="caso-estrógeno-selección-de-genes-diferencialmente-expresados-asociados-con-la-resistencia-a-estrógenos-.html#cb58-4"></a><span class="kw">arrayQualityMetrics</span>(rawDataBad, <span class="dt">outdir =</span> <span class="st">&quot;Informe_de_calidad_(2)_para_los_datos_del_caso_ESTROGENO&quot;</span>)</span></code></pre></div>
<p>Estos informes contienen gráficos, y explicaciones de como interpretarlos. Los gráficos llevan también indicadores para determinar si una muestra determinada puede tener algún tipo de problema.</p>
<p>En el código de ejemplo hemos realizado dos veces el análisis, una con los datos “buenos” y otra incluyendo el array defectuoso (“bad.cel”). Como puede verse en las tablas resumen, y en los directorios de resultados el array defectuoso es detectado por la mayoría de pruebas.</p>
<p>La figuras <a href="#fig:arrayQuality1"><strong>??</strong></a> y <a href="#fig:arrayQuality2"><strong>??</strong></a> presenta una tabla que resumen algunas de las pruebas (no todas) realizadas e indica si, para cada criterio, puede considerarse que un array dado es un outlier.</p>
<p>Para concluir con esta seccion merece la pena recordar que
todos estos graficos son exploratorios. Raramente se descarta un array si solo un grafico lo sugiere.</p>
</div>
<div id="normalizacion-y-filtraje" class="section level3" number="7.4.3">
<h3><span class="header-section-number">7.4.3</span> Normalizacion y Filtraje</h3>
<p>Una vez realizado el control de calidad se procede a normalizar los datos y sumarizarlos.</p>
<p>Hecho esto puede realizarse un filtraje no específico con el fin de eliminar genes que constituyen básicamente “ruído”,
bien porque sus señales son muy bajas o bien porque apenas varían entre condiciones,
por lo que no aportan nada a la selección de genes diferencialmente expresados.</p>
<p>La normalización puiede hacerse por distintos métodos (MAS5, VSN, RMA, GCRMA, …)
En este ejemplo se utilizará el método RMA pero no se realizará filtraje alguno.
Esto puede implicar quizás que para seleccionar genes diferencialmente expresados basándose en el ajuste de p-valores
debamos utilizar criterios menos restrictivos que si hubiéramos filtrado, pero tiene la ventaja de eliminar un paso que,
en el mejor de los casos, resulta controvertido.</p>
<p>El procesado mediante RMA implica un proceso en tres etapas:</p>
<ul>
<li>Corrección de fondo (el RMA hace precisamente esto).</li>
<li>Normalización para hacer los valores de los arrays comparables.</li>
<li>Summarización de las diversas sondas asociadas a cada grupo de sondas para dar un único valor.</li>
</ul>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb59-1"><a href="caso-estrógeno-selección-de-genes-diferencialmente-expresados-asociados-con-la-resistencia-a-estrógenos-.html#cb59-1"></a><span class="kw">require</span>(affy)</span>
<span id="cb59-2"><a href="caso-estrógeno-selección-de-genes-diferencialmente-expresados-asociados-con-la-resistencia-a-estrógenos-.html#cb59-2"></a>eset_rma &lt;-<span class="st"> </span><span class="kw">rma</span>(rawData)</span></code></pre></div>
<pre><code>## Background correcting
## Normalizing
## Calculating Expression</code></pre>
<p>Si se desea normalizar <em>únicamente si los datos normalizados no estan disponibles</em> puede utilizarse el código siguiente:</p>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb61-1"><a href="caso-estrógeno-selección-de-genes-diferencialmente-expresados-asociados-con-la-resistencia-a-estrógenos-.html#cb61-1"></a><span class="kw">require</span>(affy)</span>
<span id="cb61-2"><a href="caso-estrógeno-selección-de-genes-diferencialmente-expresados-asociados-con-la-resistencia-a-estrógenos-.html#cb61-2"></a>normalize &lt;-<span class="st"> </span>T</span>
<span id="cb61-3"><a href="caso-estrógeno-selección-de-genes-diferencialmente-expresados-asociados-con-la-resistencia-a-estrógenos-.html#cb61-3"></a><span class="cf">if</span>(normalize){</span>
<span id="cb61-4"><a href="caso-estrógeno-selección-de-genes-diferencialmente-expresados-asociados-con-la-resistencia-a-estrógenos-.html#cb61-4"></a>  eset_rma &lt;-<span class="st"> </span><span class="kw">rma</span>(rawData)</span>
<span id="cb61-5"><a href="caso-estrógeno-selección-de-genes-diferencialmente-expresados-asociados-con-la-resistencia-a-estrógenos-.html#cb61-5"></a>  <span class="kw">save</span>(eset_rma, <span class="dt">file=</span><span class="kw">file.path</span>(dataDir,<span class="st">&quot;estrogen-normalized.Rda&quot;</span>))</span>
<span id="cb61-6"><a href="caso-estrógeno-selección-de-genes-diferencialmente-expresados-asociados-con-la-resistencia-a-estrógenos-.html#cb61-6"></a>}<span class="cf">else</span>{</span>
<span id="cb61-7"><a href="caso-estrógeno-selección-de-genes-diferencialmente-expresados-asociados-con-la-resistencia-a-estrógenos-.html#cb61-7"></a>  <span class="kw">load</span> (<span class="dt">file=</span><span class="kw">file.path</span>(dataDir,<span class="st">&quot;estrogen-normalized.Rda&quot;</span>))</span>
<span id="cb61-8"><a href="caso-estrógeno-selección-de-genes-diferencialmente-expresados-asociados-con-la-resistencia-a-estrógenos-.html#cb61-8"></a>}</span></code></pre></div>
<p>La normalización hace que los valores de los arrays sean
comparables entre ellos, aunque los distintos métodos situan los valores en escalas distintas,
por lo que lo que no resulta directamente comparable son los valores normalizados por distintos métodos.</p>
<p>Un boxplot de los valores normalizados muestra que los valores ya están en una escala en donde se pueden comparar.</p>
<p>Ahora bien, <strong>esto no debe considerarse sinónimo de buena calidad</strong> porque si se aplica la normalización por cuantiles el gráfico aparecerá así independientemente de otros factores que puedan afectar la calidad.</p>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb62-1"><a href="caso-estrógeno-selección-de-genes-diferencialmente-expresados-asociados-con-la-resistencia-a-estrógenos-.html#cb62-1"></a><span class="kw">boxplot</span>(eset_rma,<span class="dt">main=</span><span class="st">&quot;Boxplot for RMA-normalized expression values &quot;</span>,</span>
<span id="cb62-2"><a href="caso-estrógeno-selección-de-genes-diferencialmente-expresados-asociados-con-la-resistencia-a-estrógenos-.html#cb62-2"></a>        <span class="dt">names=</span>sampleNames, <span class="dt">cex.axis=</span><span class="fl">0.7</span>, <span class="dt">col=</span>info<span class="op">$</span>grupo<span class="op">+</span><span class="dv">1</span>,<span class="dt">las=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="Analisis_de_Datos_de_Microarrays_y_otras_Omicas_files/figure-html/normBoxPlot-1.png" width="672" /></p>
<p>El código siguiente, que no se ejecuta muestra como se podrían aplicar distintos métodos para lego compararlos entre ellos.</p>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb63-1"><a href="caso-estrógeno-selección-de-genes-diferencialmente-expresados-asociados-con-la-resistencia-a-estrógenos-.html#cb63-1"></a>eset_mas5 &lt;-<span class="st"> </span><span class="kw">mas5</span>(rawData)  <span class="co"># Uses expresso (MAS 5.0 method) much slower than RMA!</span></span>
<span id="cb63-2"><a href="caso-estrógeno-selección-de-genes-diferencialmente-expresados-asociados-con-la-resistencia-a-estrógenos-.html#cb63-2"></a><span class="kw">stopifnot</span>(<span class="kw">require</span>(gcrma))</span>
<span id="cb63-3"><a href="caso-estrógeno-selección-de-genes-diferencialmente-expresados-asociados-con-la-resistencia-a-estrógenos-.html#cb63-3"></a>eset_gcrma &lt;-<span class="st"> </span><span class="kw">gcrma</span>(rawData) <span class="co"># The &#39;library(gcrma)&#39; needs to be loaded first.</span></span>
<span id="cb63-4"><a href="caso-estrógeno-selección-de-genes-diferencialmente-expresados-asociados-con-la-resistencia-a-estrógenos-.html#cb63-4"></a><span class="kw">stopifnot</span>(<span class="kw">require</span>(plier))</span>
<span id="cb63-5"><a href="caso-estrógeno-selección-de-genes-diferencialmente-expresados-asociados-con-la-resistencia-a-estrógenos-.html#cb63-5"></a>eset_plier &lt;-<span class="st"> </span><span class="kw">justPlier</span>(rawData, <span class="dt">normalize=</span>T) <span class="co"># The &#39;library(plier)&#39; needs to be loaded first.</span></span>
<span id="cb63-6"><a href="caso-estrógeno-selección-de-genes-diferencialmente-expresados-asociados-con-la-resistencia-a-estrógenos-.html#cb63-6"></a>compara &lt;-<span class="kw">data.frame</span>(<span class="dt">RMA=</span><span class="kw">exprs</span>(eset_rma)[,<span class="dv">1</span>], <span class="dt">MAS5 =</span><span class="kw">exprs</span>(eset_mas5)[,<span class="dv">1</span>],</span>
<span id="cb63-7"><a href="caso-estrógeno-selección-de-genes-diferencialmente-expresados-asociados-con-la-resistencia-a-estrógenos-.html#cb63-7"></a>                    <span class="dt">GCRMA=</span><span class="kw">exprs</span>(eset_gcrma)[,<span class="dv">1</span>], <span class="dt">PLIER =</span><span class="kw">exprs</span>(eset_plier)[,<span class="dv">1</span>])</span>
<span id="cb63-8"><a href="caso-estrógeno-selección-de-genes-diferencialmente-expresados-asociados-con-la-resistencia-a-estrógenos-.html#cb63-8"></a><span class="kw">pairs</span>(compara)</span></code></pre></div>
<div id="filtraje" class="section level4" number="7.4.3.1">
<h4><span class="header-section-number">7.4.3.1</span> Filtraje</h4>
<p>El filtraje <em>no específico</em> permite eliminar los genes que
varían poco entre condiciones o que deseamos quitar por otras
razones como por ejemplo que no disponemos de anotación para
ellos. La función <tt>nsFilter</tt> permite eliminar los genes que,
o bien varían poco, o bien no se dispone de anotación para ellos.</p>
<p>Si al filtrar deseamos usar las anotaciones, o la falta de ellas, como
criterio de filtraje debemos disponer del correspondiente paquete de
anotaciones.</p>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb64-1"><a href="caso-estrógeno-selección-de-genes-diferencialmente-expresados-asociados-con-la-resistencia-a-estrógenos-.html#cb64-1"></a><span class="kw">require</span>(genefilter)</span>
<span id="cb64-2"><a href="caso-estrógeno-selección-de-genes-diferencialmente-expresados-asociados-con-la-resistencia-a-estrógenos-.html#cb64-2"></a>filtered &lt;-<span class="st"> </span><span class="kw">nsFilter</span>(eset_rma, <span class="dt">require.entrez=</span><span class="ot">TRUE</span>,</span>
<span id="cb64-3"><a href="caso-estrógeno-selección-de-genes-diferencialmente-expresados-asociados-con-la-resistencia-a-estrógenos-.html#cb64-3"></a>         <span class="dt">remove.dupEntrez=</span><span class="ot">TRUE</span>, <span class="dt">var.func=</span>IQR,</span>
<span id="cb64-4"><a href="caso-estrógeno-selección-de-genes-diferencialmente-expresados-asociados-con-la-resistencia-a-estrógenos-.html#cb64-4"></a>         <span class="dt">var.cutoff=</span><span class="fl">0.5</span>, <span class="dt">var.filter=</span><span class="ot">TRUE</span>,</span>
<span id="cb64-5"><a href="caso-estrógeno-selección-de-genes-diferencialmente-expresados-asociados-con-la-resistencia-a-estrógenos-.html#cb64-5"></a>         <span class="dt">filterByQuantile=</span><span class="ot">TRUE</span>, <span class="dt">feature.exclude=</span><span class="st">&quot;^AFFX&quot;</span>)</span></code></pre></div>
<p>La función <tt>nsFilter</tt> devuelve los valores filtrados en un objeto <tt>expressionSet</tt> y un informe de los resultados del filtraje.</p>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb65-1"><a href="caso-estrógeno-selección-de-genes-diferencialmente-expresados-asociados-con-la-resistencia-a-estrógenos-.html#cb65-1"></a><span class="kw">names</span>(filtered)</span></code></pre></div>
<pre><code>## [1] &quot;eset&quot;       &quot;filter.log&quot;</code></pre>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb67-1"><a href="caso-estrógeno-selección-de-genes-diferencialmente-expresados-asociados-con-la-resistencia-a-estrógenos-.html#cb67-1"></a><span class="kw">class</span>(filtered<span class="op">$</span>eset)</span></code></pre></div>
<pre><code>## [1] &quot;ExpressionSet&quot;
## attr(,&quot;package&quot;)
## [1] &quot;Biobase&quot;</code></pre>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb69-1"><a href="caso-estrógeno-selección-de-genes-diferencialmente-expresados-asociados-con-la-resistencia-a-estrógenos-.html#cb69-1"></a><span class="kw">print</span>(filtered<span class="op">$</span>filter.log)</span></code></pre></div>
<pre><code>## $numDupsRemoved
## [1] 2856
## 
## $numLowVar
## [1] 4292
## 
## $numRemoved.ENTREZID
## [1] 1166
## 
## $feature.exclude
## [1] 19</code></pre>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb71-1"><a href="caso-estrógeno-selección-de-genes-diferencialmente-expresados-asociados-con-la-resistencia-a-estrógenos-.html#cb71-1"></a>eset_filtered &lt;-filtered<span class="op">$</span>eset</span></code></pre></div>
<p>Podemos grabar el objeto <tt>eset_rma</tt> y los datos filtrados para su posterior uso.</p>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb72-1"><a href="caso-estrógeno-selección-de-genes-diferencialmente-expresados-asociados-con-la-resistencia-a-estrógenos-.html#cb72-1"></a><span class="kw">save</span>(eset_rma, eset_filtered, <span class="dt">file=</span><span class="kw">file.path</span>(resultsDir, <span class="st">&quot;estrogen-normalized.Rda&quot;</span>))</span></code></pre></div>
<p>Despues del filtraje han quedado 4409 genes disponibles para analizar.</p>
</div>
</div>
</div>
<div id="selección-de-genes-diferencialmente-expresados-1" class="section level2" number="7.5">
<h2><span class="header-section-number">7.5</span> Selección de genes diferencialmente expresados</h2>
<p>Como en las etapas anteriores la selección de genes diferencialmente expresados (GDE)
puede basarse en distintas aproximaciones, desde la <span class="math inline">\(t\)</span> de Student al programa SAM pasando por multitud de variantes.</p>
<p>En este ejemplo se aplicará la aproximación presentada por Smyth
<em>et al.</em> (2004) basado en la utilización del <em>modelo
lineal general</em> combinada con un método para obtener una
estimación mejorada de la varianza.</p>
<div id="análisis-basado-en-modelos-lineales" class="section level3" number="7.5.1">
<h3><span class="header-section-number">7.5.1</span> Análisis basado en modelos lineales</h3>
<p>El capítulo 6 de tse manual o el manual del programa
<tt>limma</tt> contienen explicaciones detalladas sobre construir un modelo lineal para este problema y como utilizarlo para seleccionar
genes diferencialmente expresados.</p>
<div id="matriz-de-diseño" class="section level4" number="7.5.1.1">
<h4><span class="header-section-number">7.5.1.1</span> Matriz de diseño</h4>
<p>El primer paso para el análisis es crear la matriz de diseño.</p>
<p>La situación discutida en este ejemplo se puede modelizar de dos formas,
tal como se discute en la presentación citada más arriba:</p>
<ul>
<li>Como un modelo de dos factores Estrogeno(Pres/Aus) Tiempo (10h/48h) con interacción.</li>
<li>Como un modelo de un factor con cuatro niveles (Pres.10h/Pres.48h/Aus.10h/Aus.48h).</li>
</ul>
<p>Tal como se describe en el manual de <tt>limma</tt> la segunda parametrización resulta
a menudo más comoda, a pesar de parecer menos intuitiva, porque permite formular con más facilidad que la de dos factores
las preguntas que típicamente interesan a los investigadores.</p>
<p>El modelo lineal para este estudio será:</p>
<p><span class="math display">\[
\left(
\begin{array}{r}
y_1 \\
y_2 \\
y_3 \\
y_4 \\
y_5 \\
y_6 \\
y_7 \\
y_8
\end{array}
\right) = \underbrace{\left(
\begin{array}{rrrr}
1 &amp; 0 &amp; 0 &amp; 0\\
1 &amp; 0 &amp; 0 &amp; 0\\
0 &amp; 1 &amp; 0 &amp; 0 \\
0 &amp; 1 &amp; 0 &amp; 0 \\
0 &amp; 0 &amp; 1 &amp; 0 \\
0 &amp; 0 &amp; 1 &amp; 0 \\
0 &amp; 0 &amp; 0 &amp; 1 \\
0 &amp; 0 &amp; 0 &amp; 1
\end{array}
\right)}_{\mbox{Design Matrix}, \mathbf{X}} \left(
\begin{array}{c}
\alpha_1 \\
\alpha_2 \\
\alpha_3 \\
\alpha_4
\end{array}
\right)
 + \left(
\begin{array}{r}
\varepsilon_1 \\
\varepsilon_2 \\
\varepsilon_3\\
\varepsilon_4 \\
\varepsilon_5\\
\varepsilon_6\\
\varepsilon_7\\
\varepsilon_8
\end{array}
\right) \]</span></p>
<p>Los parámetros del modelos representan las cuatro combinaciones tiempo/estrogeno.</p>
<p><span class="math display">\[\begin{array}{ccc}
\alpha_1&amp;=&amp; \mathbf{E} (log{Abs.10h} ),\\
\alpha_2&amp;=&amp; \mathbf{E} (log{Pres.10h} ),\\
\alpha_3&amp;=&amp; \mathbf{E} (log{Abs.48h} ),\\
\alpha_4&amp;=&amp; \mathbf{E} (log{Pres.48h} ).
\end{array}\]</span></p>
<p>La matriz de diseño puede definirse manualmente o a partir de un factor
creado específicamente para ello.</p>
<p>Manualmente, seria:</p>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb73-1"><a href="caso-estrógeno-selección-de-genes-diferencialmente-expresados-asociados-con-la-resistencia-a-estrógenos-.html#cb73-1"></a>design<span class="fl">.1</span>&lt;-<span class="kw">matrix</span>(</span>
<span id="cb73-2"><a href="caso-estrógeno-selección-de-genes-diferencialmente-expresados-asociados-con-la-resistencia-a-estrógenos-.html#cb73-2"></a><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,</span>
<span id="cb73-3"><a href="caso-estrógeno-selección-de-genes-diferencialmente-expresados-asociados-con-la-resistencia-a-estrógenos-.html#cb73-3"></a>  <span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,</span>
<span id="cb73-4"><a href="caso-estrógeno-selección-de-genes-diferencialmente-expresados-asociados-con-la-resistencia-a-estrógenos-.html#cb73-4"></a>  <span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,</span>
<span id="cb73-5"><a href="caso-estrógeno-selección-de-genes-diferencialmente-expresados-asociados-con-la-resistencia-a-estrógenos-.html#cb73-5"></a>  <span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>),</span>
<span id="cb73-6"><a href="caso-estrógeno-selección-de-genes-diferencialmente-expresados-asociados-con-la-resistencia-a-estrógenos-.html#cb73-6"></a><span class="dt">nrow=</span><span class="dv">8</span>,</span>
<span id="cb73-7"><a href="caso-estrógeno-selección-de-genes-diferencialmente-expresados-asociados-con-la-resistencia-a-estrógenos-.html#cb73-7"></a><span class="dt">byrow=</span>F)</span>
<span id="cb73-8"><a href="caso-estrógeno-selección-de-genes-diferencialmente-expresados-asociados-con-la-resistencia-a-estrógenos-.html#cb73-8"></a><span class="kw">colnames</span>(design<span class="fl">.1</span>)&lt;-<span class="kw">c</span>(<span class="st">&quot;neg10h&quot;</span>, <span class="st">&quot;est10h&quot;</span>, <span class="st">&quot;neg48h&quot;</span>, <span class="st">&quot;est48h&quot;</span>)</span>
<span id="cb73-9"><a href="caso-estrógeno-selección-de-genes-diferencialmente-expresados-asociados-con-la-resistencia-a-estrógenos-.html#cb73-9"></a><span class="kw">rownames</span>(design<span class="fl">.1</span>) &lt;-<span class="st">  </span><span class="kw">c</span>(<span class="st">&quot;low10A&quot;</span>, <span class="st">&quot;low10B&quot;</span>, <span class="st">&quot;hi10A&quot;</span> , <span class="st">&quot;hi10B&quot;</span>,  <span class="st">&quot;low48A&quot;</span>, <span class="st">&quot;low48B&quot;</span>, <span class="st">&quot;hi48A&quot;</span> , <span class="st">&quot;hi48B&quot;</span>)</span>
<span id="cb73-10"><a href="caso-estrógeno-selección-de-genes-diferencialmente-expresados-asociados-con-la-resistencia-a-estrógenos-.html#cb73-10"></a><span class="kw">print</span>(design<span class="fl">.1</span>)</span></code></pre></div>
<pre><code>##        neg10h est10h neg48h est48h
## low10A      1      0      0      0
## low10B      1      0      0      0
## hi10A       0      1      0      0
## hi10B       0      1      0      0
## low48A      0      0      1      0
## low48B      0      0      1      0
## hi48A       0      0      0      1
## hi48B       0      0      0      1</code></pre>
<p>Alternativamente puede crearse la matriz de diseño a partir de la información
sobre las condiciones contenida en el <tt>phenoData</tt>, <em>siempre que exista un campo adecuado para ello</em>.</p>
<p>En este caso la columna <tt>Target</tt> se ha creado para utilizarla con esta finalidad.
El objeto <tt>phenoData</tt> puede recrearse a partir del archivo original o extrayéndolo del objeto
<tt>ExpresionSet</tt> que contiene los datos y las covariables.</p>
<pre><code>##        neg10h est10h neg48h est48h
## low10A      1      0      0      0
## low10B      1      0      0      0
## hi10A       0      1      0      0
## hi10B       0      1      0      0
## low48A      0      0      1      0
## low48B      0      0      1      0
## hi48A       0      0      0      1
## hi48B       0      0      0      1
## attr(,&quot;assign&quot;)
## [1] 1 1 1 1
## attr(,&quot;contrasts&quot;)
## attr(,&quot;contrasts&quot;)$lev
## [1] &quot;contr.treatment&quot;</code></pre>
<p>Ambas matrices, <tt>design, design.1</tt> resultan iguales.</p>
</div>
<div id="contrastes" class="section level4" number="7.5.1.2">
<h4><span class="header-section-number">7.5.1.2</span> Contrastes</h4>
<p>Dado un modelo lineal definido a traves de una matriz de diseño pueden formularse
las preguntas de interes como <em>contrastes</em> es decir comparaciones entre los
parametros del modelo.</p>
<p>Cada parametrizacion distinta requerira de unos contrastes diferentes para las
mismas preguntas, por lo que habitualmente se utilizara la parametrizacion que permita
formular de forma mas clara las comparaciones de interes.</p>
<p>En este caso interesa estudiar</p>
<ul>
<li>Efecto del estrogeno al inicio del tratamiento</li>
<li>Efecto del estrogeno al cabo de un tiempo del tratamiento</li>
<li>Efecto del tiempo en ausencia de estrogeno</li>
</ul>
<p>Esto se puede formular facilmente con la parametrizacion adoptada.
<span class="math display">\[\begin{array}{ccc}
\beta_1^1 &amp;=&amp; \alpha_2-\alpha_1,\quad \mbox{Efecto del estrogeno pasadas 10 horas} \\
\beta_2^1 &amp;=&amp; \alpha_4-\alpha_3,\quad \mbox{Efecto del estrogeno pasadas 48 horas} \\
\beta_3^1 &amp;=&amp; \alpha_3-\alpha_1,\quad \mbox{Efecto del tiempo en ausencia de Estrogeno}
\end{array}\]</span></p>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb76-1"><a href="caso-estrógeno-selección-de-genes-diferencialmente-expresados-asociados-con-la-resistencia-a-estrógenos-.html#cb76-1"></a>cont.matrix &lt;-<span class="st"> </span><span class="kw">makeContrasts</span> (</span>
<span id="cb76-2"><a href="caso-estrógeno-selección-de-genes-diferencialmente-expresados-asociados-con-la-resistencia-a-estrógenos-.html#cb76-2"></a>      <span class="dt">Estro10=</span>(est10h<span class="op">-</span>neg10h),</span>
<span id="cb76-3"><a href="caso-estrógeno-selección-de-genes-diferencialmente-expresados-asociados-con-la-resistencia-a-estrógenos-.html#cb76-3"></a>      <span class="dt">Estro48=</span>(est48h<span class="op">-</span>neg48h),</span>
<span id="cb76-4"><a href="caso-estrógeno-selección-de-genes-diferencialmente-expresados-asociados-con-la-resistencia-a-estrógenos-.html#cb76-4"></a>      <span class="dt">Tiempo=</span>(neg48h<span class="op">-</span>neg10h),</span>
<span id="cb76-5"><a href="caso-estrógeno-selección-de-genes-diferencialmente-expresados-asociados-con-la-resistencia-a-estrógenos-.html#cb76-5"></a>      <span class="dt">levels=</span>design)</span>
<span id="cb76-6"><a href="caso-estrógeno-selección-de-genes-diferencialmente-expresados-asociados-con-la-resistencia-a-estrógenos-.html#cb76-6"></a>cont.matrix</span></code></pre></div>
<pre><code>##         Contrasts
## Levels   Estro10 Estro48 Tiempo
##   neg10h      -1       0     -1
##   est10h       1       0      0
##   neg48h       0      -1      1
##   est48h       0       1      0</code></pre>
</div>
<div id="estimación-del-modelo-y-selección-de-genes" class="section level4" number="7.5.1.3">
<h4><span class="header-section-number">7.5.1.3</span> Estimación del modelo y selección de genes</h4>
<p>Una vez definida la matriz de diseño y los contrastes podemos pasar a estimar
el modelo, estimar los contrastes y realizar las pruebas de significación
que nos indiquen, para cada gen y cada comparación,
si puede considerarse diferencialmente expresado.</p>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb78-1"><a href="caso-estrógeno-selección-de-genes-diferencialmente-expresados-asociados-con-la-resistencia-a-estrógenos-.html#cb78-1"></a><span class="kw">require</span>(limma)</span>
<span id="cb78-2"><a href="caso-estrógeno-selección-de-genes-diferencialmente-expresados-asociados-con-la-resistencia-a-estrógenos-.html#cb78-2"></a>fit&lt;-<span class="kw">lmFit</span>(eset_rma, design)</span>
<span id="cb78-3"><a href="caso-estrógeno-selección-de-genes-diferencialmente-expresados-asociados-con-la-resistencia-a-estrógenos-.html#cb78-3"></a>fit.main&lt;-<span class="kw">contrasts.fit</span>(fit, cont.matrix)</span>
<span id="cb78-4"><a href="caso-estrógeno-selección-de-genes-diferencialmente-expresados-asociados-con-la-resistencia-a-estrógenos-.html#cb78-4"></a>fit.main&lt;-<span class="kw">eBayes</span>(fit.main)</span></code></pre></div>
<p>El método implementado en  amplía el análisis tradicional
utilizando modelos de Bayes empíricos para combinar la información de toda la matriz de datos
y de cada gen individual y obtener estimaciones de error mejoradas.</p>
<p>El análisis proporciona los estadísticos de test habituales como <tt>Fold–change</tt>
<span class="math inline">\(t\)</span>-moderados o <span class="math inline">\(p\)</span>-valores ajustados que se utilizan para ordenar los genes de mas a menos diferencialmente expresados.</p>
<p>A fin de controlar el porcentaje de falsos positivos que puedan resultar del alto numero de contrastes realizados simultaneamente
los p–valores se ajustan de forma que tengamos control sobre la tasa de falsos positivos utilizando el metodo
de Benjamini y Hochberg (<span class="citation">Benjamini and Hochberg (1995)</span>).</p>
<p>La funcion <tt>topTable</tt> genera para cada contraste una lista de genes
ordenados de mas a menos diferencialmente expresados.</p>
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb79-1"><a href="caso-estrógeno-selección-de-genes-diferencialmente-expresados-asociados-con-la-resistencia-a-estrógenos-.html#cb79-1"></a>topTabEstro10 &lt;-<span class="st"> </span><span class="kw">topTable</span> (fit.main, <span class="dt">number=</span><span class="kw">nrow</span>(fit.main), <span class="dt">coef=</span><span class="st">&quot;Estro10&quot;</span>, <span class="dt">adjust=</span><span class="st">&quot;fdr&quot;</span>)</span>
<span id="cb79-2"><a href="caso-estrógeno-selección-de-genes-diferencialmente-expresados-asociados-con-la-resistencia-a-estrógenos-.html#cb79-2"></a>topTabEstro48 &lt;-<span class="st"> </span><span class="kw">topTable</span> (fit.main, <span class="dt">number=</span><span class="kw">nrow</span>(fit.main), <span class="dt">coef=</span><span class="st">&quot;Estro48&quot;</span>, <span class="dt">adjust=</span><span class="st">&quot;fdr&quot;</span>)</span>
<span id="cb79-3"><a href="caso-estrógeno-selección-de-genes-diferencialmente-expresados-asociados-con-la-resistencia-a-estrógenos-.html#cb79-3"></a>topTabTiempo  &lt;-<span class="st"> </span><span class="kw">topTable</span> (fit.main, <span class="dt">number=</span><span class="kw">nrow</span>(fit.main) , <span class="dt">coef=</span><span class="st">&quot;Tiempo&quot;</span>, <span class="dt">adjust=</span><span class="st">&quot;fdr&quot;</span>)</span></code></pre></div>
<p>Una forma de visualizar los resultados es mediante un <tt>volcano plot</tt> que representa en abscisas los cambios de expresión en escala logarítmica
y en ordenadas el “menos logaritmo” del p-valor o alternativamente el estadístico <span class="math inline">\(B\)</span>.</p>
<p><img src="Analisis_de_Datos_de_Microarrays_y_otras_Omicas_files/figure-html/volcano2-1.png" width="672" /></p>
</div>
</div>
<div id="comparaciones-múltiples" class="section level3" number="7.5.2">
<h3><span class="header-section-number">7.5.2</span> Comparaciones múltiples</h3>
<p>Cuando se realizan varias comparaciones a la vez puede resultar importante ver
que genes cambian simultáneamente en más de una comparación.
Si el número de comparaciones es alto también puede ser necesario realizar un
ajuste de p-valores entre las comparaciones, distinto del realizado entre genes.</p>
<p>La función <tt>decidetests</tt> permite realizar ambas cosas.
En este ejemplo no se ajustaran los p–valores entre comparaciones. Tan solo se seleccionaran los genes que cambian en una o más condiciones.</p>
<p>EL resultado del análisis es una tabla <tt>res</tt> que para cada gen y cada comparación
contiene un 1 (si el gen esta sobre-expresado o “up” en esta condicion),
un 0 (si no hay cambio significativo) o un -1
(si esta “down”-regulado).</p>
<p>Para resumir dicho análisis podemos contar qué filas tienen como mínimo una celda distinta de cero:</p>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb80-1"><a href="caso-estrógeno-selección-de-genes-diferencialmente-expresados-asociados-con-la-resistencia-a-estrógenos-.html#cb80-1"></a>sum.res.rows&lt;-<span class="kw">apply</span>(<span class="kw">abs</span>(res),<span class="dv">1</span>,sum)</span>
<span id="cb80-2"><a href="caso-estrógeno-selección-de-genes-diferencialmente-expresados-asociados-con-la-resistencia-a-estrógenos-.html#cb80-2"></a>res.selected&lt;-res[sum.res.rows<span class="op">!=</span><span class="dv">0</span>,]</span>
<span id="cb80-3"><a href="caso-estrógeno-selección-de-genes-diferencialmente-expresados-asociados-con-la-resistencia-a-estrógenos-.html#cb80-3"></a><span class="kw">print</span>(<span class="kw">summary</span>(res))</span></code></pre></div>
<pre><code>##        Estro10 Estro48 Tiempo
## Down        23      99     27
## NotSig   12512   12375  12591
## Up          90     151      7</code></pre>
<p>Un diagrama de Venn permite visualizar la tabla anterior sin diferenciar entre genes “up” o “down” regulados.</p>
<p>\begin{figure} <!-- ?---></p>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb82-1"><a href="caso-estrógeno-selección-de-genes-diferencialmente-expresados-asociados-con-la-resistencia-a-estrógenos-.html#cb82-1"></a><span class="kw">vennDiagram</span> (res.selected[,<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>], <span class="dt">main=</span><span class="st">&quot;Genes in common #1&quot;</span>, <span class="dt">cex=</span><span class="fl">0.9</span>)</span></code></pre></div>
<img src="Analisis_de_Datos_de_Microarrays_y_otras_Omicas_files/figure-html/venn1-1.png" width="672" />
<p>\end{figure} <!-- ?---></p>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="selección-de-genes-diferencialmente-expresados-chapdeg.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="después-de-la-selección-análisis-de-listas-de-genes.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
