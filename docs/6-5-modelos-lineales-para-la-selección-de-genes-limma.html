<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<meta property="og:title" content="6.5 Modelos lineales para la selección de genes: limma  | Analisis de datos omicos" />
<meta property="og:type" content="book" />





<meta name="author" content="Alex Sánchez-Pla^{1,2} y Ricardo Gonzalo Sanz^2" />
<meta name="author" content="^1 Departament de Genètica, Microbiologia i Estadística. Universitat de Barcelona (UB)." />
<meta name="author" content="^2 Unitat d’Estadística i Bioinformàtica. Vall d’Hebron Institut de Recerca (VHIR)." />


<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  TeX: { equationNumbers: { autoNumber: "AMS" } }
});
</script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<meta name="description" content="6.5 Modelos lineales para la selección de genes: limma  | Analisis de datos omicos">

<title>6.5 Modelos lineales para la selección de genes: limma  | Analisis de datos omicos</title>

<script src="libs/header-attrs-2.7/header-attrs.js"></script>
<script src="libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="libs/bootstrap-3.3.5/css/bootstrap.min.css" rel="stylesheet" />
<script src="libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="libs/navigation-1.1/tabsets.js"></script>


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>


<link rel="stylesheet" href="style.css" type="text/css" />

<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
  height: auto;
}
</style>
</head>

<body>

<div class="container-fluid main-container">


<div class="row">
<div class="col-sm-12">
<div id="TOC">
<ul>
<li><a href="index.html#presentación"><span class="toc-section-number">1</span> Presentación</a>
<ul>
<li><a href="1-1-instalación-de-paquetes-de-r-y-código-de-los-capítulos.html#instalación-de-paquetes-de-r-y-código-de-los-capítulos"><span class="toc-section-number">1.1</span> Instalación de paquetes de R y código de los capítulos</a></li>
</ul></li>
<li><a href="2-introduccion-a-los-microarrays-y-otras-tecnologías-omicas.html#introduccion-a-los-microarrays-y-otras-tecnologías-omicas"><span class="toc-section-number">2</span> Introduccion a los microarrays y otras tecnologías omicas</a>
<ul>
<li><a href="2-1-antecedentes-históricos.html#antecedentes-históricos"><span class="toc-section-number">2.1</span> Antecedentes históricos</a></li>
<li><a href="2-2-los-microarrays.html#los-microarrays"><span class="toc-section-number">2.2</span> Los microarrays</a>
<ul>
<li><a href="2-2-los-microarrays.html#aplicaciones-de-los-microarrays"><span class="toc-section-number">2.2.1</span> Aplicaciones de los microarrays</a></li>
</ul></li>
<li><a href="2-3-cómo-funcionan-los-microarrays.html#cómo-funcionan-los-microarrays"><span class="toc-section-number">2.3</span> Cómo funcionan los microarrays</a>
<ul>
<li><a href="2-3-cómo-funcionan-los-microarrays.html#microarrays-de-dos-colores"><span class="toc-section-number">2.3.1</span> Microarrays de dos colores</a></li>
<li><a href="2-3-cómo-funcionan-los-microarrays.html#microarrays-de-un-color"><span class="toc-section-number">2.3.2</span> Microarrays de un color</a></li>
<li><a href="2-3-cómo-funcionan-los-microarrays.html#realización-de-un-experimento-de-microarrays"><span class="toc-section-number">2.3.3</span> Realización de un experimento de microarrays</a></li>
<li><a href="2-3-cómo-funcionan-los-microarrays.html#como-se-mide-la-expresión"><span class="toc-section-number">2.3.4</span> Como se mide la expresión</a></li>
</ul></li>
<li><a href="2-4-bioinformática-de-microarrays.html#bioinformática-de-microarrays"><span class="toc-section-number">2.4</span> Bioinformática de Microarrays<a name="Bioinformática"></a></a>
<ul>
<li><a href="2-4-bioinformática-de-microarrays.html#software-para-el-análisis-de-datos-de-microarrays"><span class="toc-section-number">2.4.1</span> Software para el análisis de datos de microarrays</a></li>
<li><a href="2-4-bioinformática-de-microarrays.html#bases-de-datos-de-microarrays"><span class="toc-section-number">2.4.2</span> Bases de datos de Microarrays</a></li>
</ul></li>
<li><a href="2-5-extensiones-1-otros-tipos-de-microarrays.html#extensiones-1-otros-tipos-de-microarrays"><span class="toc-section-number">2.5</span> Extensiones (1): Otros tipos de microarrays<a name="extensions"></a></a>
<ul>
<li><a href="2-5-extensiones-1-otros-tipos-de-microarrays.html#otros-microarrays-de-adn"><span class="toc-section-number">2.5.1</span> Otros microarrays de ADN</a></li>
<li><a href="2-5-extensiones-1-otros-tipos-de-microarrays.html#otros-tipos-de-microarrays-proteínas-o-carbohidratos"><span class="toc-section-number">2.5.2</span> Otros tipos de microarrays: Proteínas o carbohidratos</a></li>
</ul></li>
<li><a href="2-6-extensiones-2-ngs-nextnow-generation-sequencing.html#extensiones-2-ngs-nextnow-generation-sequencing"><span class="toc-section-number">2.6</span> Extensiones (2): <em>NGS: Next(Now) Generation Sequencing</em></a>
<ul>
<li><a href="2-6-extensiones-2-ngs-nextnow-generation-sequencing.html#visión-global-de-las-tecnologías-de-secuenciación"><span class="toc-section-number">2.6.1</span> Visión global de las tecnologías de secuenciación</a></li>
<li><a href="2-6-extensiones-2-ngs-nextnow-generation-sequencing.html#de-la-secuenciación-sanger-a-la-ultrasecuenciación"><span class="toc-section-number">2.6.2</span> De la secuenciación Sanger a la ultrasecuenciación</a></li>
<li><a href="2-6-extensiones-2-ngs-nextnow-generation-sequencing.html#tecnologías-de-ultrasecuenciación"><span class="toc-section-number">2.6.3</span> Tecnologías de ultrasecuenciación</a></li>
</ul></li>
</ul></li>
<li><a href="3-MDAProcess.html#MDAProcess"><span class="toc-section-number">3</span> El proceso de análisis de microarrays</a>
<ul>
<li><a href="3-1-tipos-de-estudios.html#tipos-de-estudios"><span class="toc-section-number">3.1</span> Tipos de estudios</a>
<ul>
<li><a href="3-1-tipos-de-estudios.html#comparación-de-grupos-o-class-comparison"><span class="toc-section-number">3.1.1</span> Comparación de grupos o “Class comparison”</a></li>
<li><a href="3-1-tipos-de-estudios.html#predicción-de-clase-o-class-prediction"><span class="toc-section-number">3.1.2</span> Predicción de clase o “Class prediction”</a></li>
<li><a href="3-1-tipos-de-estudios.html#descubrimiento-de-clases-o-class-discovery"><span class="toc-section-number">3.1.3</span> Descubrimiento de clases o “Class discovery”</a></li>
<li><a href="3-1-tipos-de-estudios.html#otros-tipos-de-estudios"><span class="toc-section-number">3.1.4</span> Otros tipos de estudios</a></li>
</ul></li>
<li><a href="3-2-c4examples.html#c4examples"><span class="toc-section-number">3.2</span> Algunos ejemplos concretos</a>
<ul>
<li><a href="3-2-c4examples.html#celltypes"><span class="toc-section-number">3.2.1</span> Estudio de procesos regulados por citoquinas</a></li>
<li><a href="3-2-c4examples.html#golub"><span class="toc-section-number">3.2.2</span> Clasificación molecular de la leucemia</a></li>
<li><a href="3-2-c4examples.html#efecto-del-estrogeno-y-el-tiempo-de-administración-estrogen"><span class="toc-section-number">3.2.3</span> Efecto del estrogeno y el tiempo de administración {#estrogen]</a></li>
<li><a href="3-2-c4examples.html#CCL4"><span class="toc-section-number">3.2.4</span> Efecto del CCL4 en la expresión génica</a></li>
<li><a href="3-2-c4examples.html#yeast"><span class="toc-section-number">3.2.5</span> Análisis de patrones en el ciclo celular</a></li>
<li><a href="3-2-c4examples.html#recapitulación"><span class="toc-section-number">3.2.6</span> Recapitulación</a></li>
</ul></li>
<li><a href="3-3-el-proceso-de-análisis-de-microarrays.html#el-proceso-de-análisis-de-microarrays"><span class="toc-section-number">3.3</span> El proceso de análisis de microarrays</a></li>
</ul></li>
<li><a href="4-MDAExpDesign.html#MDAExpDesign"><span class="toc-section-number">4</span> Diseño de experimentos de microarrays</a>
<ul>
<li><a href="4-1-fuentes-de-variabilidad.html#fuentes-de-variabilidad"><span class="toc-section-number">4.1</span> Fuentes de variabilidad</a></li>
<li><a href="4-2-tipos-de-variabilidad.html#tipos-de-variabilidad"><span class="toc-section-number">4.2</span> Tipos de variabilidad</a></li>
<li><a href="4-3-conceptos-básicos-de-diseño-de-experimentos.html#conceptos-básicos-de-diseño-de-experimentos"><span class="toc-section-number">4.3</span> Conceptos básicos de diseño de Experimentos</a></li>
<li><a href="4-4-principios-de-diseño-de-experimentos.html#principios-de-diseño-de-experimentos"><span class="toc-section-number">4.4</span> Principios de diseño de experimentos</a>
<ul>
<li><a href="4-4-principios-de-diseño-de-experimentos.html#replicación"><span class="toc-section-number">4.4.1</span> Replicación</a></li>
<li><a href="4-4-principios-de-diseño-de-experimentos.html#aleatorización"><span class="toc-section-number">4.4.2</span> Aleatorización</a></li>
<li><a href="4-4-principios-de-diseño-de-experimentos.html#bloqueo-o-control-local"><span class="toc-section-number">4.4.3</span> Bloqueo o control local</a></li>
</ul></li>
<li><a href="4-5-diseños-experimentales-para-microarrays-de-dos-colores.html#diseños-experimentales-para-microarrays-de-dos-colores"><span class="toc-section-number">4.5</span> Diseños experimentales para microarrays de dos colores</a></li>
</ul></li>
<li><a href="5-exploración-de-los-datos-control-de-calidad-y-preprocesado.html#exploración-de-los-datos-control-de-calidad-y-preprocesado"><span class="toc-section-number">5</span> Exploración de los datos, control de calidad y preprocesado</a>
<ul>
<li><a href="5-1-introducción.html#introducción"><span class="toc-section-number">5.1</span> Introducción</a>
<ul>
<li><a href="5-1-introducción.html#nivel-de-análisis-y-tipo-de-microarray"><span class="toc-section-number">5.1.1</span> Nivel de análisis y tipo de microarray</a></li>
<li><a href="5-1-introducción.html#datos-de-partida"><span class="toc-section-number">5.1.2</span> Datos de partida</a></li>
</ul></li>
<li><a href="5-2-exploración-y-control-de-calidad.html#exploración-y-control-de-calidad"><span class="toc-section-number">5.2</span> Exploración y control de calidad</a>
<ul>
<li><a href="5-2-exploración-y-control-de-calidad.html#control-de-calidad-con-gráficos-estadísticos-generales"><span class="toc-section-number">5.2.1</span> Control de calidad con gráficos estadísticos generales</a></li>
<li><a href="5-2-exploración-y-control-de-calidad.html#gráficos-de-diagnóstico-para-microarrays-de-dos-colores"><span class="toc-section-number">5.2.2</span> Gráficos de diagnóstico para microarrays de dos colores</a></li>
<li><a href="5-2-exploración-y-control-de-calidad.html#gráficos-de-diagnóstico-para-microarrays-de-un-color"><span class="toc-section-number">5.2.3</span> Gráficos de diagnóstico para microarrays de un color</a></li>
</ul></li>
<li><a href="5-3-normalización-de-arrays-de-dos-colores.html#normalización-de-arrays-de-dos-colores"><span class="toc-section-number">5.3</span> Normalización de arrays de dos colores</a>
<ul>
<li><a href="5-3-normalización-de-arrays-de-dos-colores.html#normalización-global"><span class="toc-section-number">5.3.1</span> Normalización global</a></li>
<li><a href="5-3-normalización-de-arrays-de-dos-colores.html#normalización-dependiente-de-la-intensidad"><span class="toc-section-number">5.3.2</span> Normalización dependiente de la intensidad</a></li>
</ul></li>
<li><a href="5-4-resumen-y-normalización-de-microarrays-de-affymetrix.html#resumen-y-normalización-de-microarrays-de-affymetrix"><span class="toc-section-number">5.4</span> Resumen y normalización de microarrays de Affymetrix</a>
<ul>
<li><a href="5-4-resumen-y-normalización-de-microarrays-de-affymetrix.html#métodos-originales-de-affymetrix"><span class="toc-section-number">5.4.1</span> Métodos originales de Affymetrix</a></li>
<li><a href="5-4-resumen-y-normalización-de-microarrays-de-affymetrix.html#el-método-rma-robust-multi-array-average"><span class="toc-section-number">5.4.2</span> El método RMA (Robust Multi-Array Average)</a></li>
</ul></li>
<li><a href="5-5-filtraje-no-específico.html#filtraje-no-específico"><span class="toc-section-number">5.5</span> Filtraje no específico</a></li>
</ul></li>
<li><a href="6-selección-de-genes-diferencialmente-expresados-chapdeg.html#selección-de-genes-diferencialmente-expresados-chapdeg"><span class="toc-section-number">6</span> Selección de genes diferencialmente expresados {# chapDEG}</a>
<ul>
<li><a href="6-1-introducción-1.html#introducción-1"><span class="toc-section-number">6.1</span> Introducción</a></li>
<li><a href="6-2-selección-de-genes-diferencialmente-expresados.html#selección-de-genes-diferencialmente-expresados"><span class="toc-section-number">6.2</span> Selección de genes diferencialmente expresados</a>
<ul>
<li><a href="6-2-selección-de-genes-diferencialmente-expresados.html#medidas-naturales-para-comparar-dos-muestras"><span class="toc-section-number">6.2.1</span> Medidas <em>naturales</em> para comparar dos muestras</a></li>
<li><a href="6-2-selección-de-genes-diferencialmente-expresados.html#un-primer-ejemplo"><span class="toc-section-number">6.2.2</span> Un primer ejemplo</a></li>
<li><a href="6-2-selección-de-genes-diferencialmente-expresados.html#selección-de-genes-usando-tests-estadísticos"><span class="toc-section-number">6.2.3</span> Selección de genes usando tests estadísticos</a></li>
</ul></li>
<li><a href="6-3-significación-estadística-y-expresión-diferencial.html#significación-estadística-y-expresión-diferencial"><span class="toc-section-number">6.3</span> Significación estadística y expresión diferencial</a>
<ul>
<li><a href="6-3-significación-estadística-y-expresión-diferencial.html#volcano-plots"><span class="toc-section-number">6.3.1</span> “Volcano plots”</a></li>
<li><a href="6-3-significación-estadística-y-expresión-diferencial.html#potencia-y-tamaño-muestral"><span class="toc-section-number">6.3.2</span> Potencia y tamaño muestral</a></li>
</ul></li>
<li><a href="6-4-el-problema-de-la-múltiplicidad-de-tests-multiple-testing.html#el-problema-de-la-múltiplicidad-de-tests-multiple-testing"><span class="toc-section-number">6.4</span> El problema de la múltiplicidad de tests (“multiple testing”)</a></li>
<li><a href="6-5-modelos-lineales-para-la-selección-de-genes-limma.html#modelos-lineales-para-la-selección-de-genes-limma"><span class="toc-section-number">6.5</span> Modelos lineales para la selección de genes: <tt>limma </tt></a>
<ul>
<li><a href="6-5-modelos-lineales-para-la-selección-de-genes-limma.html#el-modelo-lineal-general"><span class="toc-section-number">6.5.1</span> El modelo lineal general</a></li>
<li><a href="6-5-modelos-lineales-para-la-selección-de-genes-limma.html#ejemplos-de-situaciones-modelizables-linealmente"><span class="toc-section-number">6.5.2</span> Ejemplos de situaciones <em>modelizables linealmente</em></a></li>
<li><a href="6-5-modelos-lineales-para-la-selección-de-genes-limma.html#ejemplo-2-comparación-de-tres-grupos"><span class="toc-section-number">6.5.3</span> Ejemplo 2: Comparación de tres grupos</a></li>
<li><a href="6-5-modelos-lineales-para-la-selección-de-genes-limma.html#estimación-e-inferencia-con-el-modelo-lineal"><span class="toc-section-number">6.5.4</span> Estimación e inferencia con el modelo lineal</a></li>
<li><a href="6-5-modelos-lineales-para-la-selección-de-genes-limma.html#modelos-lineales-para-microarrays"><span class="toc-section-number">6.5.5</span> Modelos lineales para Microarrays</a></li>
<li><a href="6-5-modelos-lineales-para-la-selección-de-genes-limma.html#implementación-y-ejemplos"><span class="toc-section-number">6.5.6</span> Implementación y ejemplos</a></li>
</ul></li>
</ul></li>
<li><a href="7-caso-estrógeno-selección-de-genes-diferencialmente-expresados-asociados-con-la-resistencia-a-estrógenos-.html#caso-estrógeno-selección-de-genes-diferencialmente-expresados-asociados-con-la-resistencia-a-estrógenos."><span class="toc-section-number">7</span> Caso “Estrógeno”: Selección de genes diferencialmente expresados asociados con la resistencia a estrógenos.</a>
<ul>
<li><a href="7-1-introducción-2.html#introducción-2"><span class="toc-section-number">7.1</span> Introducción</a></li>
<li><a href="7-2-el-estudio-estrógeno.html#el-estudio-estrógeno"><span class="toc-section-number">7.2</span> El estudio “Estrógeno”</a>
<ul>
<li><a href="7-2-el-estudio-estrógeno.html#directorios-y-opciones-de-trabajo"><span class="toc-section-number">7.2.1</span> Directorios y opciones de trabajo</a></li>
</ul></li>
<li><a href="7-3-obtención-y-lectura-de-los-datos.html#obtención-y-lectura-de-los-datos"><span class="toc-section-number">7.3</span> Obtención y lectura de los datos</a>
<ul>
<li><a href="7-3-obtención-y-lectura-de-los-datos.html#los-datos"><span class="toc-section-number">7.3.1</span> Los datos</a></li>
<li><a href="7-3-obtención-y-lectura-de-los-datos.html#lectura-de-los-datos"><span class="toc-section-number">7.3.2</span> Lectura de los datos</a></li>
</ul></li>
<li><a href="7-4-exploración-control-de-calidad-y-normalización.html#exploración-control-de-calidad-y-normalización"><span class="toc-section-number">7.4</span> Exploración, Control de Calidad y Normalización</a>
<ul>
<li><a href="7-4-exploración-control-de-calidad-y-normalización.html#exploración-y-visualización"><span class="toc-section-number">7.4.1</span> Exploración y visualización</a></li>
<li><a href="7-4-exploración-control-de-calidad-y-normalización.html#control-de-calidad"><span class="toc-section-number">7.4.2</span> Control de calidad</a></li>
<li><a href="7-4-exploración-control-de-calidad-y-normalización.html#normalizacion-y-filtraje"><span class="toc-section-number">7.4.3</span> Normalizacion y Filtraje</a></li>
</ul></li>
<li><a href="7-5-selección-de-genes-diferencialmente-expresados-1.html#selección-de-genes-diferencialmente-expresados-1"><span class="toc-section-number">7.5</span> Selección de genes diferencialmente expresados</a>
<ul>
<li><a href="7-5-selección-de-genes-diferencialmente-expresados-1.html#análisis-basado-en-modelos-lineales"><span class="toc-section-number">7.5.1</span> Análisis basado en modelos lineales</a></li>
<li><a href="7-5-selección-de-genes-diferencialmente-expresados-1.html#comparaciones-múltiples"><span class="toc-section-number">7.5.2</span> Comparaciones múltiples</a></li>
</ul></li>
</ul></li>
<li><a href="8-después-de-la-selección-análisis-de-listas-de-genes.html#después-de-la-selección-análisis-de-listas-de-genes"><span class="toc-section-number">8</span> Después de la selección: Análisis de listas de genes</a>
<ul>
<li><a href="8-1-introducción-3.html#introducción-3"><span class="toc-section-number">8.1</span> Introducción</a></li>
<li><a href="8-2-análisis-comparativo-de-listas-de-genes.html#análisis-comparativo-de-listas-de-genes"><span class="toc-section-number">8.2</span> Análisis comparativo de listas de genes</a>
<ul>
<li><a href="8-2-análisis-comparativo-de-listas-de-genes.html#ejemplo-comparación-de-listas-en-el-caso-celltypes"><span class="toc-section-number">8.2.1</span> Ejemplo: comparación de listas en el caso <tt>celltypes</tt></a></li>
</ul></li>
<li><a href="8-3-anotación-de-los-resultados.html#anotación-de-los-resultados"><span class="toc-section-number">8.3</span> Anotación de los resultados</a></li>
<li><a href="8-4-visualización-de-los-perfiles-de-expresión.html#visualización-de-los-perfiles-de-expresión"><span class="toc-section-number">8.4</span> Visualización de los perfiles de expresión</a></li>
<li><a href="8-5-análisis-de-significación-biológica.html#análisis-de-significación-biológica"><span class="toc-section-number">8.5</span> Análisis de significación biológica</a>
<ul>
<li><a href="8-5-análisis-de-significación-biológica.html#análisis-de-enriquecimiento"><span class="toc-section-number">8.5.1</span> Análisis de enriquecimiento <a name="GEA"></a></a></li>
<li><a href="8-5-análisis-de-significación-biológica.html#análisis-de-enriquecimiento-con-bioconductor"><span class="toc-section-number">8.5.2</span> Análisis de enriquecimiento con Bioconductor</a></li>
</ul></li>
</ul></li>
<li><a href="9-referencias.html#referencias"><span class="toc-section-number">9</span> Referencias</a></li>
</ul>
</div>
</div>
</div>
<div class="row">
<div class="col-sm-12">
<div id="modelos-lineales-para-la-selección-de-genes-limma" class="section level2" number="6.5">
<h2><span class="header-section-number">6.5</span> Modelos lineales para la selección de genes: <tt>limma </tt></h2>
<p>En la sección anterior se ha discutido el uso del test <span class="math inline">\(t\)</span> y sus extensiones para la selección de genes diferencialmente expresados
en situaciones relativamente sencillas, es decir cuando sólo hay dos grupos.</p>
<p>En muchos estudios el número de grupos a considerar es más de dos y las fuentes de variabilidad pueden ser más de una, por
ejemplo una puede ser el tratamiento pero otra puede ser la edad de los individuos o cualquier otra condición fijada por el
investigador o derivadad de la heterogeneidad de las muestras.</p>
<p>En estas situaciones una aproximación razonable en problemas con <em>una variable respuesta</em> es el análisis de la varianza,
discutido en el capítulo <a href="`{r anchorLoc('chap:03')`">here</a>. En esta sección se presenta una aproximación equivalente que de forma general se
denomina <em>el modelo lineal</em>. Este método -que engloba el análisis d la varianza y la regresión- es uno de los más
usados en estadística y ha sido popularizado en el campo de microarrays gracias a los trabajos de Gordon Smyth quien ha creado
el paquete <tt>limma</tt> que se ha convertido en la herramiente más utilizada para el análisis de microarrays.</p>
<div id="el-modelo-lineal-general" class="section level3" number="6.5.1">
<h3><span class="header-section-number">6.5.1</span> El modelo lineal general</h3>
<p>El modelo lineal (ver por ejemplo Faraway, <span class="citation">(<strong>Faraway:2004?</strong>)</span>) es un marco general para la modelización y el análisis de
datos estadística.</p>
<p>EL método consiste en asumir una relación lineal entre los valores observados de una variable <em>respuesta</em> y las
condiciones experimentales. A partir de aquí se obtienen estimadores para los parámetros del modelo y de sus errores
estándar, y (con algunas condiciones extra) es posible hacer inferencia acerca del experimento.</p>
<p>La aplicación de modelos lineales puede ser visto como un proceso secuencial, con los siguientes pasos:</p>
<ol style="list-style-type: decimal">
<li>Especificar el diseño del experimento: qué muestras se asignan a qué condiciones.</li>
<li>(Re-)Escribir un modelo lineal para este diseño en forma de <span class="math inline">\(\mathbf{Y=X\beta+\varepsilon}\)</span>, donde <span class="math inline">\(\mathbf{X}\)</span> se
denomina <em>la matriz de diseño</em>.</li>
<li>Una vez que el modelo se ha especificado aplicar la teoría general de estimar los parámetros y los contrastes
(comparaciones entre los valores de los parámetros).</li>
<li>Si se cumplen ciertas condiciones de validez para el modelo es posible realizar inferencia sobre los parámetros del
modelo, es decir se pueden contrastar hipótesis sobre dichos parámetros.</li>
</ol>
<p>El esquema anterior se puede aplicar a casi cualquier tipo de situación experimental. En la sección siguiente se presentan
un par de ellas.</p>
</div>
<div id="ejemplos-de-situaciones-modelizables-linealmente" class="section level3" number="6.5.2">
<h3><span class="header-section-number">6.5.2</span> Ejemplos de situaciones <em>modelizables linealmente</em></h3>
<div id="ejemplo-1-experimento-swirlzebrafish" class="section level4" number="6.5.2.1">
<h4><span class="header-section-number">6.5.2.1</span> Ejemplo 1: Experimento “Swirl–Zebrafish”</h4>
<p>Swirl es una mutación puntual que provoca defectos en la organización del embrión en desarrollo a lo largo de su eje
dorsal-ventral. Como resultado, algunos tipos celulares se reducen y otros se expanden. Un objetivo de este trabajo fue
identificar los genes con expresión alterada en el mutante Swirl en comparación con “wild zebrafish.”</p>
<ol style="list-style-type: decimal">
<li>El diseño experimental para este estudio fue el siguiente:
\begin{center} <!-- ?---></li>
</ol>
<table>
<tbody>
<tr class="odd">
<td></td>
</tr>
<tr class="even">
<td></td>
</tr>
<tr class="odd">
<td></td>
</tr>
<tr class="even">
<td>1</td>
</tr>
<tr class="odd">
<td>2</td>
</tr>
<tr class="even">
<td>3</td>
</tr>
<tr class="odd">
<td>4</td>
</tr>
<tr class="even">
<td></td>
</tr>
</tbody>
</table>
<p>\end{center} <!-- ?---></p>
<ul>
<li>Cada microarray contenía 8848 sondas de cDNA (genes o sequencias EST).</li>
<li>Cuatro réplicas por array (slide): 2 juegos de pares de intercambio de color</li>
<li>El cDNA del mutante swirl (<span class="math inline">\(S\)</span>) se marca con Cy5 o Cy3 y el cDNA del “wild type” se marca con el otro</li>
</ul>
<ol style="list-style-type: decimal">
<li>El modelo lineal derivado del diseño anterior fue:</li>
</ol>
<ul>
<li>El parámetro de interés es: <span class="math inline">\(\alpha= \mathbf{E}\left (log\frac{S}{W}\right )\)</span> .</li>
<li>Las muestras 1 y 3 estan marcadas con : S (Verde=“Green”) y W (Rojo=“Red”), y las muestras 2 y 4 son “dye-swapped.”</li>
<li>El modelo, <span class="math inline">\(\mathbf{y=X\alpha+\varepsilon}\)</span>, es:
<span class="math display">\[
\begin{array}{ccccc}
y_1 &amp;=&amp;\alpha&amp;+&amp;\varepsilon _1 \\
y_2 &amp;=&amp;-\alpha&amp;+&amp;\varepsilon _2 \\
y_3 &amp;=&amp;\alpha&amp;+&amp;\varepsilon _3 \\
y_4 &amp;=&amp;-\alpha&amp;+&amp;\varepsilon _4\\
\end{array}
&lt;!-- \right.---&gt;
\Longrightarrow
&lt;!-- \left.---&gt;
\left(
\begin{array}{r}
y_1 \\
y_2 \\
y_3\\
y_4
\end{array}
\right) = \underbrace{\left(
\begin{array}{r}
1 \\
-1 \\
1\\
-1
\end{array}
\right)}_{\text{Matriz de Diseño}, \mathbf{X}} \alpha + \left(
\begin{array}{r}
\varepsilon_1 \\
\varepsilon_2 \\
\varepsilon_3\\
\varepsilon_4
\end{array}
\right)
\]</span></li>
</ul>
</div>
</div>
<div id="ejemplo-2-comparación-de-tres-grupos" class="section level3" number="6.5.3">
<h3><span class="header-section-number">6.5.3</span> Ejemplo 2: Comparación de tres grupos</h3>
<p>Los plásmidos IncHI codifican genes de resistencia múltiple a los antibióticos en <em>S. enterica</em>.</p>
<p>El plásmido R27 de la cepa salvaje es termosensible al transferirse.</p>
<p>Algunos fenotipos mutantes relacionados con <em>hha</em> y <em>hns</em> cromosómicos participan en diferentes
procesos metabólicos de interés en la conjugación termoregulada.</p>
<p>El objetivo del experimento es encontrar qué genes se expresean diferencialmente en tres tipos de
mutantes diferentes, <span class="math inline">\(M_1\)</span>, <span class="math inline">\(M_2\)</span> y <span class="math inline">\(M_3\)</span>.</p>
<p>Este experimento debe ser planteado de forma diferente según el tipo de arrays (uno o dos colores) y qué
comparaciones son las de mayor interés.</p>
<ul>
<li>Array de dos colores
<ul>
<li>A <em>diseño de referencia</em>: Hibridar cada Mutante (<span class="math inline">\(M_i\)</span>) vs. Salvaje (“Wild type”) (<span class="math inline">\(W\)</span>).</li>
<li>A <em>diseño loop</em>: Hibridar cada mutante el uno al otro en un doble “loop” que incluye (“dye-swapping”).</li>
</ul></li>
<li>Array de un color: hibridar mutantes y “wild types” separadamente.</li>
</ul>
<p>" width=“50%”&gt;</p>
<ul>
<li>Permite la comparación directa de Mutantes vs “Wild.”</li>
<li>Número de parámetros a estimar es 3, relación intuitiva
entre el número de parámetros y mutantes.</li>
<li>Las comparaciones de Mutante vs Mutante son menos eficientes.</li>
</ul>
<!-- <img src="images/EColiLoop" width="50%">--->
<p>" width=“50%”&gt;</p>
<ul>
<li>Permite la comparación directa de Mutantes vs Mutantes.</li>
<li>El número de parámetros a estimar es 2. Menos intuitivo.</li>
<li>Las comparaciones Mutante vs Mutante son más eficientes.</li>
</ul>
<!-- <img src="images/EColiAffy" width="50%">--->
<p>" width=“50%”&gt;</p>
<ul>
<li>Permite la comparación directa de
<ul>
<li>Mutante vs “Wild”</li>
<li>Mutante vs Mutante</li>
</ul></li>
<li>El número de parámetros a estimar es 4.</li>
<li>Todas las comparaciones se pueden hacer de forma eficiente.</li>
</ul>
<p>Modelo, <span class="math inline">\(\mathbf{y=X\alpha+\varepsilon}\)</span>,
y contrastes <span class="math inline">\(\mathbf{C&#39;\beta}\)</span></p>
<ul>
<li>Parámetros del modelo:
<span class="math display">\[\alpha_1= \mathbf{E}\left (log\frac{M_1}{W}\right ),\
\alpha_2= \mathbf{E}\left (log\frac{M_2}{W}\right ),\
\alpha_3=\mathbf{E}\left (log\frac{M_3}{W}\right ).\]</span></li>
<li><em>Contrastes</em>: Comparaciones interesantes.
<span class="math display">\[\begin{array}{ccc}
\beta_1 &amp;=&amp; \alpha_1-\alpha_2,\\
\beta_2 &amp;=&amp; \alpha_1-\alpha_3,\\
\beta_3 &amp;=&amp; \alpha_2-\alpha_3.
\end{array}\]</span></li>
</ul>
<p><span class="math display">\[
\left(
\begin{array}{r}
y_1 \\
y_2 \\
y_3 \\
y_4 \\
y_5 \\
y_6
\end{array}
\right) = \underbrace{\left(
\begin{array}{rrr}
1 &amp; 0 &amp; 0 \\
0 &amp; 1 &amp; 0 \\
0 &amp; 0 &amp; 1 \\
-1 &amp; 0 &amp; 0 \\
0 &amp; -1 &amp; 0 \\
0 &amp; 0 &amp; -1
\end{array}
\right)}_{\text{Matriz de Diseño}, \mathbf{X}} \left(
\begin{array}{c}
\alpha_1 \\
\alpha_2 \\
\alpha_3
\end{array}
\right)
 + \left(
\begin{array}{r}
\varepsilon_1 \\
\varepsilon_2 \\
\varepsilon_3\\
\varepsilon_4 \\
\varepsilon_5\\
\varepsilon_6
\end{array}
\right)
\]</span>
<span class="math display">\[
\left(
\begin{array}{r}
\beta_1 \\
\beta_2 \\
\beta_3
\end{array}
\right) = \underbrace{\left(
\begin{array}{rrr}
1 &amp; -1 &amp; 0 \\
1 &amp; 0 &amp; -1 \\
0 &amp; 1 &amp; -1
\end{array}
\right)}_{\text{Matriz de Contraste}, \mathbf{C}} \left(
\begin{array}{c}
\alpha_1 \\
\alpha_2 \\
\alpha_3
\end{array}
\right).
\]</span></p>
<p>Modelo,
<span class="math inline">\(\mathbf{y=X\alpha+\varepsilon}\)</span>, y contrastes <span class="math inline">\(\mathbf{C&#39;\beta}\)</span></p>
<ul>
<li><p>Parámetros del modelo:
<span class="math display">\[
\alpha_1= \mathbf{E}\left (log\frac{M_1}{M_2}\right ),\
\alpha_2= \mathbf{E}\left (log\frac{M_2}{M_3}\right ).
\]</span>
<span class="math inline">\(\alpha_3\)</span> no es necesaria: <span class="math inline">\(\log \left( \frac{M_1}{M_3}\right )=\log\left(\frac{M_1}{M_2}\right )-\log\left(\frac{M_2}{M_3}\right)\)</span>.</p></li>
<li><p><em>Contrastes</em>: Algunas de las comparaciones deseadas son precisamente los parámetros.
<span class="math display">\[\begin{array}{ccc}
\beta_1 &amp;=&amp; \alpha_1,\\
\beta_2 &amp;=&amp; \alpha_2,\\
\beta_3 &amp; =&amp; \alpha_1+\alpha_2.
\end{array}\]</span></p></li>
</ul>
<p><span class="math display">\[
\left(
\begin{array}{r}
y_1 \\
y_2 \\
y_3 \\
y_4 \\
y_5 \\
y_6
\end{array}
\right) = \underbrace{\left(
\begin{array}{rr}
1 &amp; 0  \\
0 &amp; 1  \\
1 &amp; -1  \\
-1 &amp; 0 \\
0 &amp; -1 \\
-1 &amp; 1
\end{array}
\right)}_{\text{Matriz de Diseño}, \mathbf{X}} \left(
\begin{array}{c}
\alpha_1 \\
\alpha_2 \\
\end{array}
\right)
 + \left(
\begin{array}{r}
\varepsilon_1 \\
\varepsilon_2 \\
\varepsilon_3\\
\varepsilon_4 \\
\varepsilon_5\\
\varepsilon_6
\end{array}
\right)
\]</span></p>
<p><span class="math display">\[
\left(
\begin{array}{r}
\beta_1 \\
\beta_2 \\
\beta_3
\end{array}
\right) = \underbrace{\left(
\begin{array}{rrr}
1 &amp; 0 \\
0 &amp; 1 \\
1 &amp; +1
\end{array}
\right)}_{\text{Matriz de Contraste}, \mathbf{C}} \left(
\begin{array}{c}
\alpha_1 \\
\alpha_2
\end{array}
\right).
\]</span></p>
<p>Modelo,
<span class="math inline">\(\mathbf{y=X\alpha+\varepsilon}\)</span>, y contrastes
<span class="math inline">\(\mathbf{C^{1&#39;}\beta}\)</span>, <span class="math inline">\(\mathbf{C^{2&#39;}\beta}\)</span></p>
<ul>
<li>Parámetros del modelo:
<span class="math display">\[\alpha_1= \mathbf{E} (log{M_1} ),\
\alpha_2= \mathbf{E} (log{M_2} ),\ \alpha_3=\mathbf{E} (log{M_3} ),
\alpha_4=\mathbf{E} (log{W} ).
\]</span></li>
<li><em>Contrastes</em>: Dos posibles conjuntos de comparaciones interesantes.</li>
</ul>
<ol style="list-style-type: decimal">
<li><p>Comparación entre tipo de mutantes <span class="math inline">\((\mathbf{C^{1&#39;}\beta})\)</span>
<span class="math display">\[\begin{array}{ccc}
\beta_1^1 &amp;=&amp; \alpha_1-\alpha_2,\\
\beta_2^1 &amp;=&amp; \alpha_3-\alpha_2,\\
\beta_3^1 &amp;=&amp; \alpha_2-\alpha_3.
\end{array}\]</span></p></li>
<li><p>Comparación entre cada mutantes y el wild type <span class="math inline">\((\mathbf{C^{2&#39;}\beta})\)</span>
<span class="math display">\[\begin{array}{ccc}
\beta_1^2 &amp;=&amp; \alpha_4-\alpha_1,\\
\beta_2^2 &amp;=&amp; \alpha_3-\alpha_1,\\
\beta_3^2 &amp;=&amp; \alpha_2-\alpha_1.
\end{array}\]</span></p></li>
</ol>
<p><span class="math display">\[
\left(
\begin{array}{r}
y_1 \\
y_2 \\
y_3 \\
y_4 \\
y_5 \\
y_6 \\
y_7 \\
y_8
\end{array}
\right) = \underbrace{\left(
\begin{array}{rrrr}
1 &amp; 0 &amp; 0 &amp; 0\\
1 &amp; 0 &amp; 0 &amp; 0\\
0 &amp; 1 &amp; 0 &amp; 0 \\
0 &amp; 1 &amp; 0 &amp; 0 \\
0 &amp; 0 &amp; 1 &amp; 0 \\
0 &amp; 0 &amp; 1 &amp; 0 \\
0 &amp; 0 &amp; 0 &amp; 1 \\
0 &amp; 0 &amp; 0 &amp; 1
\end{array}
\right)}_{\text{Matriz de Diseño}, \mathbf{X}} \left(
\begin{array}{c}
\alpha_1 \\
\alpha_2 \\
\alpha_3 \\
\alpha_4
\end{array}
\right)
 + \left(
\begin{array}{r}
\varepsilon_1 \\
\varepsilon_2 \\
\varepsilon_3\\
\varepsilon_4 \\
\varepsilon_5\\
\varepsilon_6\\
\varepsilon_7\\
\varepsilon_8
\end{array}
\right)
\]</span></p>
<p><span class="math display">\[
\left(
\begin{array}{r}
\beta_1^1 \\
\beta_2^1 \\
\beta_3^1
\end{array}
\right) = \underbrace{\left(
\begin{array}{rrrr}
1 &amp; -1 &amp; 0 &amp; 0\\
1 &amp; 0 &amp; -1 &amp; 0\\
0 &amp; 1 &amp; -1&amp; 0
\end{array}
\right)}_{\text{Matriz de Contraste}, \mathbf{C^1}} \left(
\begin{array}{c}
\alpha_1 \\
\alpha_2 \\
\alpha_3 \\
\alpha_4
\end{array}
\right).
\]</span></p>
<p><span class="math display">\[
\left(
\begin{array}{r}
\beta_1^2 \\
\beta_2^2 \\
\beta_3^2
\end{array}
\right) = \underbrace{\left(
\begin{array}{rrrr}
1 &amp; 0 &amp; 0 &amp; -1\\
0 &amp; 1 &amp; 0 &amp; -1\\
0 &amp; 0 &amp; 1 &amp; -1
\end{array}
\right)}_{\text{Matriz de Contraste}, \mathbf{C^2}} \left(
\begin{array}{c}
\alpha_1 \\
\alpha_2 \\
\alpha_3 \\
\alpha_4
\end{array}
\right).
\]</span></p>
<div id="ejemplo-3-estudio-de-la-influencia-de-las-citoquinas-en-ratones-viejos" class="section level4" number="6.5.3.1">
<h4><span class="header-section-number">6.5.3.1</span> Ejemplo 3: Estudio de la influencia de las citoquinas en ratones <em>viejos</em></h4>
<p>El objetivo de este experimento es estudiar el efecto de las citoquinas sobre la estimulación de una sustancia (LPS) y ver como esta relación se ve afectada por la edad.</p>
<p>Se trata de un modelo de un un factor (tratamiento, asignable por el individuo) y un
bloque (edad, no asignable, prefijada en cada ratón). En la práctica el modelo equivale al del análisis de la varianza de dos factores.</p>
<ol style="list-style-type: decimal">
<li>El diseño experimental para este estudio fue el siguiente:
\begin{center} <!-- ?---></li>
</ol>
<table>
<tbody>
<tr class="odd">
<td>% after : or   …</td>
</tr>
<tr class="even">
<td></td>
</tr>
<tr class="odd">
<td></td>
</tr>
<tr class="even">
<td>1</td>
</tr>
<tr class="odd">
<td>2</td>
</tr>
<tr class="even">
<td>3</td>
</tr>
<tr class="odd">
<td>4</td>
</tr>
<tr class="even">
<td>5</td>
</tr>
<tr class="odd">
<td>6</td>
</tr>
<tr class="even">
<td>7</td>
</tr>
<tr class="odd">
<td>8</td>
</tr>
<tr class="even">
<td>9</td>
</tr>
<tr class="odd">
<td>10</td>
</tr>
<tr class="even">
<td>11</td>
</tr>
<tr class="odd">
<td>12</td>
</tr>
<tr class="even">
<td></td>
</tr>
</tbody>
</table>
<p>\end{center} <!-- ?---></p>
<ul>
<li>Se utilizáron microarrays de un color (Affymetrix).</li>
<li>Cada condición se replicó tres veces.</li>
<li>Las preguntas específicas a responder:
<ul>
<li>?`Cual es el efecto del tratamiento en ratones viejos?</li>
<li>?`Cual es el efecto del tratamiento en ratones jovenes?</li>
<li>?`En que genes el efecto es diferente?.</li>
</ul></li>
</ul>
<ol style="list-style-type: decimal">
<li>En este caso se pueden considerar distintos modelo lineales derivados del hecho de que este experimento admite diferente parametrizaciones:</li>
</ol>
<ul>
<li>Factores separados con 2 niveles cada uno para tratamiento (LPS/Med), Edad (Joven/Viejo) y su interacción:
<span class="math display">\[Y_{ijk}=\underbrace{\alpha_{i}}_{\text{Trat}}+\underbrace{\beta_{j}}_{\text{Edad}}+\underbrace{\gamma_{ij}}_{\text{Interacción}}+\varepsilon_{ijk},\,
i=1,2,\, j=1,2,\, k=1,2,3\]</span>
Esta primera parametrización parece natural pero es más complicado confiar en ella para responder las preguntas propuestas.</li>
<li>Un factor combinado con 4 niveles <br>
(<em>LPS.Aged, Med.Aged, LPS.Young, Med.Young</em>)
<span class="math display">\[
Y_{ij}=\alpha{i} +\varepsilon_{ij}, \quad i=1,...,4,\, j=1,2,3 .
\]</span>
Esta parametrización parece más rígida pero se adapta mejor para responder a las preguntas planteadas.</li>
</ul>
<p>Aquí se adopta la segunda parametrización.</p>
<ul>
<li><p>Parámetros del modelo:
<span class="math display">\[\begin{array}{ccc}
\alpha_1&amp;=&amp;  \mathbf{E} (log{LPS.Aged} ),\
\alpha_2= \mathbf{E} (log{Med.Aged} ),\\
\alpha_3&amp;=&amp;\mathbf{E} (log{LPS.Young} ),\,
\alpha_4=\mathbf{E} (log{Med.Young} ).
\end{array}\]</span></p></li>
<li><p><em>Contrastes</em>: Preguntas que interesa responder:
<span class="math display">\[\begin{array}{ccc}
\beta_1^1 &amp;=&amp; \alpha_3-\alpha_1,\quad \mbox{Efecto del tratamiento en ratones viejos} \\
\beta_2^1 &amp;=&amp; \alpha_4-\alpha_2,\quad \mbox{Efecto del tratamiento en ratones jóvenes} \\
\beta_3^1 &amp;=&amp; (\alpha_3-\alpha_1)- (\alpha_2-\alpha_4),\quad \mbox{Interacción: diferencia entre efectos}
\end{array}\]</span></p></li>
<li><p>Modelo lineal:</p></li>
</ul>
<p>Modelo, <span class="math inline">\(\mathbf{y=X\alpha+\varepsilon}\)</span>, y
contrastes <span class="math inline">\(\mathbf{C&#39;\beta}\)</span></p>
$$
(
<span class="math display">\[\begin{array}{r}
y_1 \\
y_2 \\
y_3 \\
y_4 \\
y_5 \\
y_6 \\
y_7 \\
y_8 \\
y_9 \\
y_{10} \\
y_{11} \\
y_{12}


\end{array}\]</span>
) = _{, } (
<span class="math display">\[\begin{array}{c}
\alpha_1 \\
\alpha_2 \\
\alpha_3 \\
\alpha_4
\end{array}\]</span>
)
+ (
<span class="math display">\[\begin{array}{r}
\varepsilon_1 \\
\varepsilon_2 \\
\varepsilon_3\\
\varepsilon_4 \\
\varepsilon_5\\
\varepsilon_6\\
\varepsilon_7\\
\varepsilon_8
\end{array}\]</span>
<p>)
$$</p>
<p><span class="math display">\[
 \left(
\begin{array}{r}
\beta_1^1 \\
\beta_2^1 \\
\beta_3^1
\end{array}
\right) = \underbrace{\left(
\begin{array}{rrrr}
-1 &amp; 0 &amp; 1 &amp; 0\\
0 &amp; -1 &amp; 0 &amp; 1\\
-1 &amp; 1 &amp; 1 &amp; -1
\end{array}
\right)}_{\text{Matriz de Contraste}, \mathbf{C}} \left(
\begin{array}{c}
\alpha_1 \\
\alpha_2 \\
\alpha_3 \\
\alpha_4
\end{array}
\right)
\]</span></p>
</div>
</div>
<div id="estimación-e-inferencia-con-el-modelo-lineal" class="section level3" number="6.5.4">
<h3><span class="header-section-number">6.5.4</span> Estimación e inferencia con el modelo lineal</h3>
<p>Una vez se ha expresado el experimento como un modelo lineal:
<span class="math display">\[
\mathbf{E(y_g)=X\alpha_g},\quad \text{var}(y_g)=W_g\sigma_g,
\]</span>
es posible usar <em>la teoría estándar del modelo lineal</em> (ver <span class="citation">(<strong>Faraway:2004?</strong>)</span>)
para obtener:</p>
<ul>
<li>Estimación de los parámetros: <span class="math inline">\(\hat \alpha_g( \approx \mathbf{\alpha})\)</span>.</li>
<li>Desviación estándar de las estimaciones: <span class="math inline">\(\hat \sigma_g=s_g( \approx \sigma)\)</span>.</li>
<li>Error estándar de las estimaciones:<span class="math inline">\(\widehat {\text{var}\hat \alpha_g}=V_g\,s_g^2\)</span>.
Estas estimaciones son la base para realizar inferencia sobre <span class="math inline">\(\alpha\)</span> i.e. test <span class="math inline">\(H_0:\ \alpha =0?\)</span>, basado en el hecho que:
<span class="math display">\[
t_{gj}=\frac{\alpha_{gj}}{s_g\sqrt{v_{gj}}}\sim \text{Distribución de Student}.
\]</span>
De forma análoga pueden derivarse fórmulas para <span class="math inline">\(\alpha_1-\alpha_2\)</span>, es decir para decidir acerca de las comparaciones.</li>
</ul>
<p>Los procedimientos de estimación y de inferencia no dependen de qué
parametrización se ha adoptado, a pesar de que distintas parametrizaciones piedan dar lugar a distintos valores numéricos..</p>
<div id="fortaleza-y-debilidades-del-modelo-lineal" class="section level4" number="6.5.4.1">
<h4><span class="header-section-number">6.5.4.1</span> Fortaleza y debilidades del modelo lineal</h4>
<p>El enfoque del modelo lineal es flexible y potente:</p>
<ul>
<li>Se puede adaptar a situaciones diferentes y complejas.</li>
<li>Siempre produce buenas estimaciones (“BLUE”).</li>
<li>Si las suposiciones son ciertas proporciona una base para la inferencia.</li>
</ul>
<p>Por otro lado hay que tener en cuenta que, si las suposiciones no se cumplen, entonces las conclusiones deben tomarse con precaución.</p>
<p>Y lo que es peor, aún siendo válidas las suposiciones del modelo los resultados pueden verse afectados por el tamaño de la muestra de forma que, en muestras pequeñas donde pueden haber variaciones más grandes es fácil que se obtengan valores <span class="math inline">\(t\)</span> no significativos o, por el contrario, excesivamente significativos (si la variación es muy reducida).</p>
<p>La metodología desarrollada por Smyth (<span class="citation">Smyth, Michaud, and Scott (2005)</span>) basada en los resultados de L"onsted &amp; Speed (<span class="citation">Speed (2003)</span>) está dirigida a abordar cómo hacer frente a estas debilidades.</p>
</div>
</div>
<div id="modelos-lineales-para-microarrays" class="section level3" number="6.5.5">
<h3><span class="header-section-number">6.5.5</span> Modelos lineales para Microarrays</h3>
<p>Smyth (<span class="citation">Smyth, Michaud, and Scott (2005)</span>) considera el problema de la identificación de genes que se expresan diferencialmente en las condiciones
especificadas en el diseño de experimentos de microarrays. Como hemos dicho repetídamente la variabilidad de los valores
de expresión difiere entre genes, pero la naturaleza paralela de la inferencia en microarrays sugiere la posibilidad de usar
la información <em>de todos los genes a la vez</em> para mejorar la estimación de los parámetros, lo que puede llevar a
una inferencia más fiable.</p>
<p>Básicamente lo que propone Smyth (<span class="citation">Smyth, Michaud, and Scott (2005)</span>) es una solución en tres pasos:</p>
<ul>
<li>Se plantea el problema como un model lineal con una componente bayesiana ya que se supone que los mismos parámetros a
estimar son variables (no constantes) con distribuciones <em>prior</em> que se estimaran a partir de la información de todos los
genes.</li>
<li>A continuación se obtienen las estimaciones de los parámetros del modelo. La aproximación utilizada garantiza que
estos estimadores tienen un comportamiento robusto incluso para pequeño número de arrays.</li>
<li>Finalmente se calcula un “odd-ratio” que viene a ser la probabilidad de que un gen esté diferencialmente expresado
frente a la de que no lo esté y se asocia este valor denominado estadístico <span class="math inline">\(B\)</span> con un estadístico <span class="math inline">\(t\)</span> moderado y su
p–valor.
<span class="math display">\[
 B=\log \frac{P[\text{Afectado}|M_{ij}]}{P[\text{No
 Afectado}|M_{ij}]},
\]</span>
gen=i <span class="math inline">\((i=1...N)\)</span>, réplica=j <span class="math inline">\((j=1,...,n)\)</span>.</li>
</ul>
<p>El hecho de trabajar con logaritmos permite poner el punto de corte en el cero: A mayor valor positivo más probable es que el
gen esté diferencialmente expresado. A mayor valor negativo, más probable es que no lo esté</p>
</div>
<div id="implementación-y-ejemplos" class="section level3" number="6.5.6">
<h3><span class="header-section-number">6.5.6</span> Implementación y ejemplos</h3>
<p>El paquete de <em>Bioconductor</em> <tt>limma</tt> al que hemos hecho referencia en los párrafos anteriores implementa el método de Smyth para la regularización de la varianza lo que lo ha convertido en muy popular entre los usuarios de microarrays</p>
<p>El código siguiente muestra como se crea la matriz del diseño y los contrastes para realizar el análisis mediante modelos lineales;</p>
<p>Empezamos por la matriz de diseño.</p>
<pre><code>##                      Aged.LPS Aged.MED Young.LPS Young.MED
## Aged LPS 80L.CEL            1        0         0         0
## Aged LPS 86L.CEL            1        0         0         0
## Aged LPS 88L.CEL            1        0         0         0
## Aged Medium 81m.CEL         0        1         0         0
## Aged Medium 82m.CEL         0        1         0         0
## Aged Medium 84m.CEL         0        1         0         0
## Young LPS 75L.CEL           0        0         1         0
## Young LPS 76L.CEL           0        0         1         0
## Young LPS 77L.CEL           0        0         1         0
## Young Medium 71m.CEL        0        0         0         1
## Young Medium 72m.CEL        0        0         0         1
## Young Medium 73m.CEL        0        0         0         1
## attr(,&quot;assign&quot;)
## [1] 1 1 1 1
## attr(,&quot;contrasts&quot;)
## attr(,&quot;contrasts&quot;)$lev
## [1] &quot;contr.treatment&quot;</code></pre>
<p>Usando los nombres de las columnas de la matriz de diseño creamos los contrastes</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="6-5-modelos-lineales-para-la-selección-de-genes-limma.html#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="fu">require</span>(limma)</span>
<span id="cb39-2"><a href="6-5-modelos-lineales-para-la-selección-de-genes-limma.html#cb39-2" aria-hidden="true" tabindex="-1"></a>cont.matrix <span class="ot">&lt;-</span> <span class="fu">makeContrasts</span> (</span>
<span id="cb39-3"><a href="6-5-modelos-lineales-para-la-selección-de-genes-limma.html#cb39-3" aria-hidden="true" tabindex="-1"></a>      <span class="at">LPS.in.AGED=</span>(Aged.LPS<span class="sc">-</span>Aged.MED),</span>
<span id="cb39-4"><a href="6-5-modelos-lineales-para-la-selección-de-genes-limma.html#cb39-4" aria-hidden="true" tabindex="-1"></a>      <span class="at">LPS.in.YOUNG=</span>(Young.LPS<span class="sc">-</span>Young.MED),</span>
<span id="cb39-5"><a href="6-5-modelos-lineales-para-la-selección-de-genes-limma.html#cb39-5" aria-hidden="true" tabindex="-1"></a>      <span class="at">AGE=</span>(Aged.MED<span class="sc">-</span>Young.MED),</span>
<span id="cb39-6"><a href="6-5-modelos-lineales-para-la-selección-de-genes-limma.html#cb39-6" aria-hidden="true" tabindex="-1"></a>      <span class="at">levels=</span>design)</span>
<span id="cb39-7"><a href="6-5-modelos-lineales-para-la-selección-de-genes-limma.html#cb39-7" aria-hidden="true" tabindex="-1"></a>cont.matrix</span></code></pre></div>
<pre><code>##            Contrasts
## Levels      LPS.in.AGED LPS.in.YOUNG AGE
##   Aged.LPS            1            0   0
##   Aged.MED           -1            0   1
##   Young.LPS           0            1   0
##   Young.MED           0           -1  -1</code></pre>
<p>Una vez definida la matriz de diseño y los contrastes podemos pasar a
estimar el modelo, estimar los contrastes y realizar las pruebas de
significación que nos indiquen, para cada gen y cada comparación, si
puede considerarse diferencialmente expresado.</p>
<p>La penúltima instrucción ejecuta el proceso de regularización de
la varianza utilizando modelos de Bayes empíricos para combinar la
información de toda la matriz de datos y de cada gen individual y
obtener estimaciones de error mejoradas.</p>
<p>El análisis proporciona los estadísticos de test habituales como
<tt>Fold–change</tt> <span class="math inline">\(t\)</span>-moderados o <span class="math inline">\(p\)</span>-valores ajustados que se
utilizan para ordenar los genes de mas a menos diferencialmente
expresados.</p>
<p>A fin de controlar el porcentaje de falsos positivos que puedan resultar del alto numero de contrastes realizados simultaneamente
los p–valores se ajustan de forma que tengamos control sobre la tasa de falsos positivos utilizando el metodo
de Benjamini y Hochberg (<span class="citation">Benjamini and Hochberg (1995)</span>).</p>
<p>La funcion <tt>topTable</tt> genera para cada contraste una lista de genes
ordenados de mas a menos diferencialmente expresados.</p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="6-5-modelos-lineales-para-la-selección-de-genes-limma.html#cb41-1" aria-hidden="true" tabindex="-1"></a>topTab_LPS.in.AGED <span class="ot">&lt;-</span> <span class="fu">topTable</span> (fit.main, <span class="at">number=</span><span class="fu">nrow</span>(fit.main), <span class="at">coef=</span><span class="st">&quot;LPS.in.AGED&quot;</span>, <span class="at">adjust=</span><span class="st">&quot;fdr&quot;</span>)</span>
<span id="cb41-2"><a href="6-5-modelos-lineales-para-la-selección-de-genes-limma.html#cb41-2" aria-hidden="true" tabindex="-1"></a>topTab_LPS.in.YOUNG <span class="ot">&lt;-</span> <span class="fu">topTable</span> (fit.main, <span class="at">number=</span><span class="fu">nrow</span>(fit.main), <span class="at">coef=</span><span class="st">&quot;LPS.in.YOUNG&quot;</span>, <span class="at">adjust=</span><span class="st">&quot;fdr&quot;</span>)</span>
<span id="cb41-3"><a href="6-5-modelos-lineales-para-la-selección-de-genes-limma.html#cb41-3" aria-hidden="true" tabindex="-1"></a>topTab_AGE  <span class="ot">&lt;-</span> <span class="fu">topTable</span> (fit.main, <span class="at">number=</span><span class="fu">nrow</span>(fit.main) , <span class="at">coef=</span><span class="st">&quot;AGE&quot;</span>, <span class="at">adjust=</span><span class="st">&quot;fdr&quot;</span>)</span></code></pre></div>
<p>Se puede visualizar los resultados mediante un <tt>volcano plot</tt> que, en este caso, representa en abscisas los cambios de expresión en escala logarítmica
y en ordenadas el estadístico <span class="math inline">\(B\)</span> en vez de el “menos logaritmo” del p-valor.</p>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="6-5-modelos-lineales-para-la-selección-de-genes-limma.html#cb42-1" aria-hidden="true" tabindex="-1"></a>coefnum <span class="ot">=</span> <span class="dv">1</span></span>
<span id="cb42-2"><a href="6-5-modelos-lineales-para-la-selección-de-genes-limma.html#cb42-2" aria-hidden="true" tabindex="-1"></a>opt <span class="ot">&lt;-</span> <span class="fu">par</span>(<span class="at">cex.lab =</span> <span class="fl">0.7</span>)</span>
<span id="cb42-3"><a href="6-5-modelos-lineales-para-la-selección-de-genes-limma.html#cb42-3" aria-hidden="true" tabindex="-1"></a><span class="fu">volcanoplot</span>(fit.main, <span class="at">coef=</span>coefnum, <span class="at">highlight=</span><span class="dv">10</span>, <span class="at">names=</span>fit.main<span class="sc">$</span>ID,</span>
<span id="cb42-4"><a href="6-5-modelos-lineales-para-la-selección-de-genes-limma.html#cb42-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">main=</span><span class="fu">paste</span>(<span class="st">&quot;Differentially expressed genes&quot;</span>,<span class="fu">colnames</span>(cont.matrix)[coefnum], <span class="at">sep=</span><span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>))</span>
<span id="cb42-5"><a href="6-5-modelos-lineales-para-la-selección-de-genes-limma.html#cb42-5" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v=</span><span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="dv">1</span>))</span></code></pre></div>
<p><img src="Analisis_de_Datos_de_Microarrays_y_otras_Omicas_files/figure-html/volcano1-1.png" width="672" /></p>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="6-5-modelos-lineales-para-la-selección-de-genes-limma.html#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(opt)</span></code></pre></div>

</div>
</div>
<!-- </div> -->
<p style="text-align: center;">
<a href="6-4-el-problema-de-la-múltiplicidad-de-tests-multiple-testing.html"><button class="btn btn-default">Previous</button></a>
<a href="7-caso-estrógeno-selección-de-genes-diferencialmente-expresados-asociados-con-la-resistencia-a-estrógenos-.html"><button class="btn btn-default">Next</button></a>
</p>
</div>
</div>


</div>

<script>

// add bootstrap table styles to pandoc tables
$(document).ready(function () {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
});

</script>

</body>
</html>
